/**
 * style.css - 100% Fiel al Original, Reorganizado Sem√°nticamente
 *
 * ESTRUCTURA:
 * 1.  ESTILOS GENERALES Y GLOBALES (body, helpers)
 * 2.  CONTENEDORES PRINCIPALES (game-container, gameBoard)
 * 3.  COMPONENTES DEL TABLERO (hex, niebla, sprites)
 * 4.  COMPONENTES DE UNIDADES (unit, estados)
 * 5.  PANELES DE UI (contextual, predicci√≥n, flotantes)
 * 6.  BOTONES FLOTANTES
 * 7.  MODALES (base y espec√≠ficos)
 *       - Modal Base
 *       - Men√∫ Principal
 *       - Configuraci√≥n y Campa√±a
 *       - Briefing de Escenario
 *       - √Årbol de Tecnolog√≠a
 *       - Gesti√≥n de Unidades (varios modales)
 *       - Wiki y Ayuda
 *       - Lobby Multijugador
 * 8.  ANIMACIONES (@keyframes)
 * 9.  ESTILOS DE DEPURACI√ìN Y TUTORIAL
 * 10. MEDIA QUERIES (Dise√±o Adaptable)
 * 11. RECOMPENSAS VISUALES
 * 12. ESTILOS ANTIGUOS O DESHABILITADOS
 */

/* ========================================================================== */
/* 1. ESTILOS GENERALES Y GLOBALES
/* ========================================================================== */

body {
    margin: 0;
    overflow: hidden;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-image: url('images/IIBERION.png');
    background-size: cover;
    background-position: center center;
    background-repeat: no-repeat;
    background-attachment: fixed;
    min-height: 100vh;
}

#game-wrapper {
    /* ESTA REGLA SOLO SE ENCARGA DE CENTRAR EL JUEGO Y NADA M√ÅS */
    width: 100vw;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    padding: 10px;
    box-sizing: border-box;
}

.button-danger {
    background-color: #dc3545;
    color: white;
    padding: 8px 16px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    font-size: 0.9em;
    transition: background-color 0.2s ease-in-out;
}
.button-danger:hover {
    background-color: #c82333;
}
.button-danger:disabled {
    background-color: #fadadd;
    color: #a3a3a3;
    cursor: not-allowed;
}

.button-secondary {
    background-color: #6c757d;
    color: white;
}

/* ========================================================================== */
/* 2. CONTENEDORES PRINCIPALES
/* ========================================================================== */

.game-container {
    display: flex;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    position: relative;
    justify-content: flex-start;
    align-items: flex-start;
   /* padding-bottom: 80px;*/
    box-sizing: border-box;
    z-index: 1200;
}

#gameBoard {
    display: grid;
    border: 2px solid #6c757d;
    /* background-color: #c2b280; */ /* <-- Comentamos o eliminamos el color s√≥lido */
    background-color: rgba(194, 178, 128, 0.2); /* <-- Mismo color pero con 40% de opacidad */
    position: relative;
    align-self: flex-start;
    cursor: grab;
    transform-origin: 0 0;
    touch-action: none;
    flex-shrink: 0;
}
#gameBoard.grabbing {
    cursor: grabbing;
}


/* ========================================================================== */
/* 3. COMPONENTES DEL TABLERO (hex, niebla, sprites)
/* ========================================================================== */

.hex {
    /*position: relative;*/
    width: 50px;
    height: 57.73px;
    background-color: #90ee90;
    clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
    position: absolute;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 9px;
    box-sizing: border-box;
    border: 1px solid transparent;
    transition: background-color 0.2s;
    background-size: cover;
    background-position: center center;
    background-repeat: no-repeat;
}
.hex:hover {
    border-color: #ffc107;
}

/* Plantilla base para la capa de color de territorio (EXCLUYENDO CAPITALES) */
.hex.player1-owner:not(.capital-city)::before,
.hex.player2-owner:not(.capital-city)::before,
.hex.player3-owner:not(.capital-city)::before,
.hex.player4-owner:not(.capital-city)::before,
.hex.player5-owner:not(.capital-city)::before,
.hex.player6-owner:not(.capital-city)::before,
.hex.player7-owner:not(.capital-city)::before,
.hex.player8-owner:not(.capital-city)::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
    z-index: -1;
    opacity: 0.35;
}

/* Asignaci√≥n de colores por jugador */
.hex.player1-owner::before { background-color: #007bff; } /* Azul */
.hex.player2-owner::before { background-color: #dc3545; } /* Rojo */
.hex.player3-owner::before { background-color: #28a745; } /* Verde */
.hex.player4-owner::before { background-color: #ffc107; } /* Amarillo */
.hex.player5-owner::before { background-color: #6f42c1; } /* P√∫rpura */
.hex.player6-owner::before { background-color: #fd7e14; } /* Naranja */
.hex.player7-owner::before { background-color: #20c997; } /* Cian */
.hex.player8-owner::before { background-color: #e83e8c; } /* Rosa */

/* --- Tipos de Terreno --- */
/*.hex.plains { background-color:#90EE90; }
.hex.forest { background-color: #6B8E23; }
.hex.hills { background-color: #A9A9A9; }
.hex.water { background-color: #87CEEB; }
*/

/*.hex.plains { background-color: #a08d75; } /* Tono Tierra Seca */*/
.hex.plains { background-color:#cbefcb; }
.hex.forest { background-color: #556b2f; } /* Verde Oliva Oscuro */
.hex.hills { background-color: #A9A9A9; } /* Tono Roca/Tierra */
.hex.water { background-color: #4682b4; } /* Azul Acero (SteelBlue) */

/* --- Resaltados de Acci√≥n (Highlights) --- */
.hex.highlight-move { background-color: rgba(0, 255, 0, 0.4); }
.hex.highlight-attack { background-color: rgba(255, 0, 0, 0.4); }
.hex.highlight-build { background-color: rgba(255, 165, 0, 0.4); }

/** DUPLICADO: Estas reglas de highlight son m√°s espec√≠ficas y probablemente las que se usan. */
.hex.highlight-move { background-color: rgba(0, 255, 0, 0.4) !important; border: 2px solid #00FF00; }
.hex.highlight-attack { background-color: rgba(255, 0, 0, 0.4) !important; border: 2px solid #FF0000; }
.hex.highlight-build { background-color: rgba(255, 165, 0, 0.4) !important; border: 2px solid #FFA500; }
.hex.highlight-place { background-color: rgba(0, 162, 255, 0.4) !important; border: 2px solid #00A2FF; }

.hex.highlight-move:hover,
.hex.highlight-attack:hover,
.hex.highlight-build:hover,
.hex.highlight-place:hover {
    border-color: yellow;
}

/* --- Propiedad y Estructuras --- */
.hex.player1-owner {
    box-shadow: inset 0 0 0 3px rgba(0, 0, 255, 0.6);
    --owner-color: rgba(0, 0, 255, 0.6);
}
.hex.player2-owner {
    box-shadow: inset 0 0 0 3px rgba(255, 0, 0, 0.6);
    --owner-color: rgba(255, 0, 0, 0.6);
}

.hex.player3-owner { box-shadow: inset 0 0 0 3px rgba(0, 0128, 0, 0.6); --owner-color: rgba(0, 128, 0, 0.6); } /* Verde */
.hex.player4-owner { box-shadow: inset 0 0 0 3px rgba(255, 255, 0, 0.6); --owner-color: rgba(255, 255, 0, 0.6); } /* Amarillo */
.hex.player5-owner { box-shadow: inset 0 0 0 3px rgba(128, 0, 0, 0.6); --owner-color: rgba(128, 0, 128, 0.6); } /* P√∫rpura */
.hex.player6-owner { box-shadow: inset 0 0 0 3px rgba(255, 165, 0, 0.6); --owner-color: rgba(255, 165, 0, 0.6); } /* Naranja */
.hex.player7-owner { box-shadow: inset 0 0 0 3px rgba(0, 255, 255, 0.6); --owner-color: rgba(0, 255, 255, 0.6); } /* Cian */
.hex.player8-owner { box-shadow: inset 0 0 0 3px rgba(255, 192, 203, 0.6); --owner-color: rgba(255, 192, 203, 0.6); } /* Rosa */

.hex.city::before { content: 'üè†'; font-size: 18px; opacity: 0.7; }
.hex.capital-city::before { content: 'üëë'; font-size: 20px; opacity: 0.7; }

/** DUPLICADO: Regla m√°s detallada para capital-city */
.hex.capital-city::before {
    content: 'üëë';
    position: absolute;

    /* --- CAMBIOS PRINCIPALES AQU√ç --- */

    /* 1. Posicionamiento: Lo movemos a la esquina superior */
   /* Posicionamiento en el centro exacto */
    top: 0;
    left: 0;
    width: 100%; /* El pseudo-elemento ocupa todo el ancho del hex */
    height: 100%; /* y todo el alto */

    /* Estas 3 l√≠neas son la clave para centrar el CONTENIDO (la corona) dentro del pseudo-elemento */
    display: flex;
    justify-content: center;
    align-items: center;
    

    /* 2. Tama√±o: Hacemos el icono mucho m√°s peque√±o */
    font-size: 16px; 

    /* 3. Limpieza: Quitamos la transformaci√≥n que lo centraba */
    transform: none; /* Antes era translate(-50%, -50%) */
    
    /* 4. Estilo: Sombra de texto muy sutil para que resalte un poco */
    text-shadow: 1px 1px 2px rgba(0,0,0,0.6);

    /* --- PROPIEDADES QUE SE MANTIENEN --- */
    opacity: 0.5; /* Podemos mantener una opacidad alta, ya que no estorba */
    pointer-events: none;
    z-index: 10;
}
.hex.capital-city .structure-sprite { z-index: 5; }

.hex .bonus-sprite {
    position: absolute;
    font-size: 16px;
    top: 2px;
    left: 2px;
    opacity: 0.8;
    z-index: 6; /* Un poco por encima del sprite de estructura */
    text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
}

/* --- Sprites de Recursos --- */
.hex.resource-hierro::after { content: 'Fe'; font-size: 10px; color: #663300; position: absolute; top: 2px; right: 2px;}
.hex.resource-madera::after { content: 'Wd'; font-size: 10px; color: #228B22; position: absolute; top: 2px; right: 2px;}

/** DUPLICADO: Reglas m√°s completas y con emojis para recursos */
.hex.resource-hierro::after,
.hex.resource-oro::after,
.hex.resource-piedra::after,
.hex.resource-madera::after,
.hex.resource-comida::after {
    content: "";
    position: absolute;
    top: 3px; right: 3px;
    font-size: 14px;
    opacity: 0.7;
    pointer-events: none;
}
.hex.resource-hierro::after { content: "‚õèÔ∏è"; color: #8B4513; }
.hex.resource-oro::after { content: "üí∞"; }
.hex.resource-piedra::after { content: "‚õ∞Ô∏è"; color: #708090; }
.hex.resource-madera::after { content: "üå≤"; color: #228B22; }
.hex.resource-comida::after { content: "üåæ"; color: #DAA520; }

.hex .structure-sprite {
    position: absolute;
    font-size: 18px;
    bottom: 1px;
    right: 1px;
    opacity: 0.9;
    z-index: 5;
}
/** DUPLICADO: Ajuste para que los sprites de estructura no se solapen con los de recursos */
.hex .structure-sprite {
    bottom: 3px;
    left: 3px;
    right: auto;
}

/* --- Niebla de Guerra --- */
.hex.fog-hidden { background-color: #777 !important; background-image: none !important; }
.hex.fog-hidden::before, .hex.fog-hidden::after, .hex.fog-hidden .structure-sprite { display: none; }
.hex.fog-partial { filter: grayscale(70%) brightness(0.8); }
.hex.fog-partial .unit:not(.player-controlled-visible) { display: none !important; }

/* --- Efectos de Estado --- */
.hex.owner-change-effect { animation: ownerChangeFlash 0.5s forwards; }
.hex.hit-effect { animation: hexHitFlash 0.3s ease-out; }

/* ========================================================================== */
/* 4. COMPONENTES DE UNIDADES
/* ========================================================================== */

.unit {
    position: absolute;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    cursor: pointer;
    transition: transform 0.2s, left 0.3s ease-out, top 0.3s ease-out;
    border: 2px solid black; /* Borde exterior, siempre visible */
    box-sizing: border-box;
    z-index: 10;
    pointer-events: none;

    /* 1. Forzamos el color de fondo a ser transparente SIEMPRE.
          Esto anula los colores de .player1 y .player2. */
    background-color: transparent !important;
    
    /* 2. Propiedades expl√≠citas para la imagen de fondo (tu sprite). */
    background-size: 85%; /* Hacemos la imagen un poco m√°s peque√±a que el c√≠rculo para que respire */
    background-repeat: no-repeat;
    background-position: center center; /* ¬°Esto la centra perfectamente! */

    /* 3. La sombra ahora se aplica a la imagen, no al c√≠rculo. */
    filter: drop-shadow(2px 2px 2px rgba(0, 0, 0, 0.6));
}

/* Esta regla se mantiene igual, es para la barra de vida */
.unit-strength {
    position: absolute;
    bottom: -16px;
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(255, 255, 255, 0.9);
    padding: 1px 4px;
    border-radius: 3px;
    font-size: 0.7em;
    white-space: nowrap;
    border: 1px solid #aaa;
}

.player1 { background-color: #add8e6; border-color: #0000ff; }
.player2 { background-color: #f08080; border-color: #ff0000; }

.unit.player-controlled-visible { display: flex !important; }

.selected-unit {
    box-shadow: 0 0 12px 4px gold;
    transform: scale(1.1);
}

.unit-damaged { animation: shake 0.5s; }
.unit-destroyed { animation: explode 0.5s forwards; }
.unit-retreat { opacity: 0.7; }
.unit.hit { animation: unitHit 0.3s ease-out; }
.unit.attacking { animation: unitAttacking 0.2s ease-out; }
/** DUPLICADO: Esta regla hace que la unidad desaparezca suavemente, complementando la animaci√≥n de explosi√≥n. */
.unit.unit-destroyed {
    opacity: 0;
    transition: opacity 0.5s ease-out;
    pointer-events: none;
}

.damage-dealt-text {
    position: absolute;
    font-size: 20px;
    font-weight: bold;
    color: #e74c3c;
    text-shadow: 1px 1px 2px black;
    z-index: 110;
    pointer-events: none;
    animation: floatAndFade 1.2s ease-out forwards;
}

.commander-banner {
    position: absolute;
    bottom: -5px;
    right: -8px;
    font-size: 14px;
    background-color: rgba(0, 0, 0, 0.7);
    border-radius: 50%;
    width: 18px;
    height: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    line-height: 1;
    border: 1px solid gold;
    text-shadow: none;
}
/* --- Modal: Cuartel de H√©roes --- */
.hero-collection-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 15px;
    margin-top: 20px;
    max-height: 60vh;
    overflow-y: auto;
    padding: 10px;
    background-color: #34495e;
    border-radius: 5px;
}

.hero-card {
    border: 2px solid #adb5bd;
    border-radius: 8px;
    padding: 10px;
    text-align: center;
    background-color: #2c3e50; /* Fondo de carta oscuro global */
    color: #ecf0f1;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
}
.hero-card:hover {
    background-color: #3d566e;
    transform: translateY(-5px);
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}
.hero-card .hero-sprite { font-size: 48px; }
.hero-card .hero-name { font-weight: bold; margin: 5px 0; }
.hero-card .hero-level { font-size: 0.9em; color: #6c757d; }
.hero-card .hero-stars { color: #ffc107; }

/* Estilos de Borde por Rareza */
.hero-card.Com√∫n { border-color: #adb5bd; }
.hero-card.Raro { border-color: #007bff; }
.hero-card.√âpico { border-color: #8a2be2; }
.hero-card.Legendario { border-color: #ffc107; }

/* ========================================== */
/* ==       IMAGEN DEL H√âROE         == */
/* ========================================== */
.hero-card-image {
    width: 80px;  /* Ajusta el tama√±o a tu gusto */
    height: 80px;
    border-radius: 8px; /* Un poco de borde redondeado */
    object-fit: cover;  /* Asegura que la imagen cubra el espacio sin deformarse */
    margin-bottom: 10px;
}

/* ======================================================== */
/* ==       MODAL DE DETALLES DE H√âROE (ESTILO ROK)       == */
/* ======================================================== */

#heroDetailModal .modal-content.hero-detail-content-rok {
    max-width: 750px; /* M√°s ancho para las 3 columnas */
    width: 90%;
    background-color: #2c3e50; /* Fondo principal azul oscuro */
    color: #ecf0f1;
    border-color: #95a5a6;
    padding: 10px;
}


#heroDetailModal .hero-column {
    background-color: #34495e; /* Fondo de las columnas un poco m√°s claro */
    border: 1px solid #7f8c8d;
    box-shadow: none; /* Quitamos sombras blancas del dise√±o viejo */
}

#heroDetailModal .column-title {
    color: #f1c40f; /* T√≠tulos dorados */
    border-bottom-color: #7f8c8d;
}

.hero-main-layout {
    display: grid;
    grid-template-columns: 200px 1fr 200px; /* Habilidades | Centro | Talentos */
    gap: 15px;
    align-items: flex-start;
}

.hero-column {
    background-color: #fff;
    border-radius: 8px;
    padding: 15px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

.column-title {
    text-align: center;
    margin-top: 0;
    margin-bottom: 15px;
    color: #343a40;
    border-bottom: 1px solid #dee2e6;
    padding-bottom: 10px;
}

/* --- Columna Izquierda: Habilidades --- */
.skills-list .skill-item-rok {
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    gap: 15px;
}
.skill-item-rok .skill-icon {
    width: 45px;
    height: 45px;
    font-size: 24px;
    background-color: #2c3e50;
    border-color: #7f8c8d;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    position: relative;
}
.skill-item-rok .skill-icon.active { border-color: #8d827f; }
.skill-item-rok .skill-level {
    position: absolute;
    bottom: -5px;
    right: -5px;
    background-color: #2c3e50;
    border-color: #7f8c8d;
    color: white;
    font-size: 0.75em;
    font-weight: bold;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    line-height: 20px;
    text-align: center;
    border: 2px solid #fff;
}
.skill-item-rok .skill-info h5 { margin: 0 0 5px 0; color: #f1c40f;}
.skill-item-rok .skill-info p { margin: 0; font-size: 0.85em; color: #bdc3c7;  }
.skill-item-rok .skill-upgrade-btn { /* Tu bot√≥n '+' se mantiene igual */ }

/* --- Columna Central: Retrato y Progresi√≥n --- */
.hero-center-column {
    display: flex;
    flex-direction: column;
    align-items: center;
}
#hero-portrait-container {
    width: 150px;
    height: 150px;
    border: 4px solid #adb5bd;
    border-radius: 12px;
    margin-bottom: 10px;
    overflow: hidden; /* Para contener la imagen */
}
#hero-portrait-container img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}
.hero-name-title { text-align: center; margin-bottom: 20px; }
.hero-name-title h2 { margin: 0; color: #ffffff;}
.hero-name-title p { margin: 3px 0 0 0; color: #bdc3c7; font-style: italic; }

#hero-progression-bars { width: 100%; }
#hero-progression-bars .progress-item { /* Tus estilos de progress-item se mantienen */ }
#hero-progression-bars .xp-bar-container { /* Tus estilos de xp-bar-container se mantienen */ }
#hero-progression-bars .xp-bar { /* Tus estilos de xp-bar se mantienen */ }

.hero-action-buttons {
    display: flex;
    justify-content: space-around;
    width: 100%;
    margin-top: 20px;
    padding-top: 15px;
    border-top: 1px solid #dee2e6;
}

/* --- Columna Derecha: Talentos y Equipo --- */
.hero-talents-column .tabs {
    display: flex;
    margin-bottom: 15px;
    border-bottom-color: #7f8c8d;
}
.tab-button {
    flex: 1;
    padding: 10px;
    border: none;
    background-color: transparent;
    cursor: pointer;
    font-size: 1em;
    font-weight: 500;
    color: #6c757d;
}
.tab-button.active {
    color: #f1c40f;
    border-bottom-color: #f1c40f;
}
.tab-content { display: none; }
.tab-content.active { display: block; }

/* --- Pop-up de Detalles de Habilidad --- */
.skill-detail-content {
    max-width: 450px;
    background-color: #fff;
    border: 2px solid #343a40;
    border-radius: 10px;
}

.skill-detail-header {
    display: flex;
    align-items: center;
    gap: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid #dee2e6;
}
.skill-detail-header .skill-icon {
    width: 60px;
    height: 60px;
    font-size: 32px;
}
.skill-detail-header h3, .skill-detail-header p {
    margin: 0;
}

.skill-detail-body {
    padding: 15px 0;
}
.skill-detail-body h4 {
    margin-top: 10px;
    margin-bottom: 10px;
}
#skillLevelPreview .level-row {
    font-size: 0.9em;
    padding: 4px 8px;
    border-radius: 4px;
    margin-bottom: 3px;
}
#skillLevelPreview .level-row.current {
    background-color: #d4edda; /* Verde claro para el nivel actual */
    font-weight: bold;
}

.skill-detail-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 15px;
    padding-top: 10px;
    border-top: 1px solid #dee2e6;
}
#skillUpgradeCost {
    font-size: 0.9em;
    color: #6c757d;
}
#upgradeSkillBtn {
    background-color: #28a745;
    color: white;
    padding: 8px 16px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}
#upgradeSkillBtn:disabled {
    background-color: #6c757d;
    cursor: not-allowed;
}

/* ========================================== */
/* ==       BOTONES DE HABILIDAD     == */
/* ========================================== */
.skill-upgrade-btn {
    margin-left: 10px;
    padding: 0px 8px;
    font-size: 1.2em;
    line-height: 1.2;
    font-weight: bold;
    color: white;
    background-color: #28a745;
    border: 1px solid #1e7e34;
    border-radius: 50%;
    cursor: pointer;
    transition: transform 0.1s;
}
.skill-upgrade-btn:hover {
    transform: scale(1.1);
    background-color: #218838;
}
.skill-unlock-req {
    font-size: 0.8em;
    font-style: italic;
    color: #6c757d;
}

/* ========================================== */
/* ==       NUEVO: H√âROES BLOQUEADOS        == */
/* ========================================== */
.hero-card.is-locked {
    background-color: #e9ecef;
    opacity: 0.75;
    filter: grayscale(90%);
    position: relative;
    border-color: #6c757d;
}

.hero-card.is-locked::after {
    content: 'üîí';
    position: absolute;
    top: 5px;
    right: 5px;
    font-size: 24px;
    background-color: rgba(0,0,0,0.5);
    border-radius: 50%;
    width: 30px;
    height: 30px;
    line-height: 30px;
    text-align: center;
    color: white;
}

.hero-fragments-progress {
    font-size: 0.9em;
    font-weight: bold;
    color: #0056b3; /* Un color que resalte incluso en la tarjeta gris */
    margin-top: 5px;
}

/* ========================================================================== */
/* 9. ESTILOS DE TUTORIAL (VERSI√ìN FINAL, ROBUSTA Y CORRECTA)
/* ========================================================================== */

/* --- RESALTADO PARA BOTONES Y ELEMENTOS DE UI (SIN CAMBIOS, PERO INCLUIDO) --- */
.tutorial-highlight {
    box-shadow: 0 0 0 4px gold, 0 0 0 8px rgba(0, 255, 255, 0.7) !important;
    animation: pulseHighlight 1.5s infinite alternate ease-in-out;
    z-index: 2002 !important;
    position: relative; /* Mantiene el z-index funcionando */
}

/* --- RESALTADO PARA HEX√ÅGONOS (APLICADO DIRECTAMENTE AL HEX, SIN ::BEFORE) --- */
.hex.tutorial-highlight-hex {
    /* box-shadow: inset dibuja el brillo DENTRO de la forma del clip-path */
    box-shadow: inset 0 0 4px 3px gold, inset 0 0 8px 6px cyan;
    
    /* Le damos un z-index para asegurar que se vea por encima de otros hex√°gonos */
    z-index: 5;
    
    /* La animaci√≥n se aplica sobre la opacidad para un pulso suave */
    animation: pulseHighlightOpacity 1.5s infinite alternate ease-in-out;
}

/* --- ANIMACIONES PARA EL RESALTADO --- */
@keyframes pulseHighlight { 
    from { transform: scale(1); }
    to { transform: scale(1.03); }
}

@keyframes pulseHighlightOpacity {
    from {
        opacity: 0.7;
    }
    to {
        opacity: 1;
    }
}

/* ========================================================================== */
/* --- Panel de Predicci√≥n de Combate --- */
/* ========================================================================== */
#combat-prediction-panel {
    background-color: rgba(0, 0, 0, 0.85);
    color: white;
    padding: 8px 12px;
    border-radius: 5px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-size: 0.9em;
    z-index: 10001;
    pointer-events: none;
    white-space: nowrap;
    box-shadow: 0 2px 10px rgba(0,0,0,0.5);
    display: none;
}
#combat-prediction-panel p { margin: 3px 0; }
#combat-prediction-panel p span { font-weight: bold; }
/** DUPLICADO: Regla con ID diferente y m√°s detallada */
#combatPredictionPanel {
    position: fixed;
    background-color: rgba(20, 20, 20, 0.9);
    color: #f0f0f0;
    padding: 10px 15px;
    border: 1px solid #555;
    border-radius: 8px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-size: 0.9em;
    z-index: 10001;
    pointer-events: none;
    white-space: nowrap;
    box-shadow: 0 4px 8px rgba(0,0,0,0.4);
    transition: opacity 0.1s linear;
    opacity: 0;
}
#combatPredictionPanel.visible { opacity: 1; }
#combatPredictionPanel h4 {
    margin: 0 0 8px 0;
    color: #f39c12;
    font-size: 1.1em;
    text-align: center;
    border-bottom: 1px solid #444;
    padding-bottom: 5px;
}
#combatPredictionPanel p { margin: 5px 0; line-height: 1.4; }
#combatPredictionPanel span.attacker-damage { color: #e74c3c; font-weight: bold; }
#combatPredictionPanel span.defender-damage { color: #3498db; font-weight: bold; }
#combatPredictionPanel span.critical-info { color: #f1c40f; font-weight: bold; display: block; text-align: center; margin-top: 8px; }

/* --- Panel de Men√∫ Flotante --- */
.floating-panel {
    position: fixed; z-index: 90;
    background-color: rgba(245, 245, 245, 0.95);
    border: 1px solid #ccc;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    padding: 15px;
    transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    display: none;
}
#floatingMenuPanel { top: 70px; left: 10px; width: 260px; }
#floatingMenuPanel h4 { text-align: center; margin-top: 0; margin-bottom: 10px; font-size: 1em; color: #333; }
#floatingMenuPanel #playerResourcesGrid_float { font-size: 0.85em; padding: 8px; margin-bottom: 10px; }
#floatingMenuPanel button, #floatingMenuPanel .button-like-label {
    width: 100%; display: block; margin-bottom: 8px; padding: 10px;
    text-align: left; background-color: #e9ecef; color: #333; border: 1px solid #ddd;
}
#floatingMenuPanel button:hover, #floatingMenuPanel .button-like-label:hover { background-color: #dee2e6; }
#floatingMenuPanel .resource-labels, #floatingMenuPanel .resource-values { grid-template-columns: repeat(7, 1fr); display: grid; }
#floatingMenuPanel #playerResourcesGrid_float {
    display: grid; grid-template-columns: repeat(7, 1fr); grid-template-rows: auto auto;
    gap: 4px 2px; padding: 8px; margin-bottom: 10px; background-color: #f8f9fa;
    border: 1px solid #e0e0e0; border-radius: 4px; text-align: center;
}
#floatingMenuPanel .resource-labels { grid-row: 1; grid-column: 1 / -1; display: contents; }
#floatingMenuPanel .resource-values { grid-row: 2; grid-column: 1 / -1; display: contents; }
#floatingMenuPanel .resource-labels span { font-size: 0.8em; font-weight: 500; color: #6c757d; }
#floatingMenuPanel .resource-values span { font-size: 0.9em; font-weight: bold; color: #212529; }

/* --- Panel de Turno del Oponente --- */
.turn-blocker {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 5000;
    display: flex; justify-content: center; align-items: center;
    font-size: 2.5em; color: white; text-shadow: 2px 2px 4px black;
    text-align: center; cursor: not-allowed;
}

/* ========================================================================== */
/* 6. BOTONES FLOTANTES
/* ========================================================================== */

.floating-btn {
    position: fixed; z-index: 100;
    background-color: rgba(0, 0, 0, 0.6); color: white;
    border: none; border-radius: 50%; width: 35px; height: 35px;
    font-size: 24px; display: flex; justify-content: center; align-items: center;
    box-shadow: 0 2px 5px rgba(0,0,0,0.3); cursor: pointer;
    transition: background-color 0.2s, transform 0.1s ease;
}
.floating-btn:hover { background-color: rgba(0, 0, 0, 0.8); transform: scale(1.05); }
.floating-btn.top-left { top: 15px; left: 15px; }
.floating-btn.top-right { top: 15px; right: 15px; }
.floating-btn.bottom-right { bottom: 20px; right: 20px; }

#floatingUndoMoveBtn, #floatingReinforceBtn, #floatingSplitBtn, #floatingBuildBtn {
    width: 35px; height: 35px; border-radius: 50%; padding: 0;
    display: flex; justify-content: center; align-items: center;
    font-size: 1.5em; display: none;
}
#floatingMenuBtn:hover, #floatingTechTreeBtn:hover, #floatingEndTurnBtn:hover,
#floatingCreateDivisionBtn:hover, #floatingConsoleBtn:hover, #floatingUndoMoveBtn:hover,
#floatingReinforceBtn:hover, #floatingSplitBtn:hover, #floatingBuildBtn:hover {
    background-color: #555; transform: scale(1.05);
}

#floatingEndTurnBtn:hover { background-color: transparent !important; transform: scale(1.1); }
#floatingEndTurnBtn:active { background-color: transparent !important; transform: translateY(1px) scale(1.05); box-shadow: none !important; }

/* --- Posicionamiento espec√≠fico --- */
/*#floatingEndTurnBtn        { bottom: 20px;  right: 20px; }
/*#floatingCreateDivisionBtn { bottom: 100px;  right: 20px; }
/*#floatingTechTreeBtn       { bottom: 160px; right: 20px; }
/*#floatingMenuBtn           { bottom: 220px; right: 20px; }
/*#floatingConsoleBtn        { bottom: 280px; right: 20px; font-size: 1.1em; padding: 10px 12px; }
/*#floatingWikiBtn           { bottom: 340px; right: 20px; width: 50px; height: 50px; border-radius: 50%; font-size: 28px; font-weight: bold; font-style: italic; padding: 0; display: flex; justify-content: center; align-items: center; }
/*#floatingPillageBtn        { bottom: 40px;  left: 20px; } 
/*#floatingBuildBtn          { bottom: 100px;  left: 20px; }
/*#floatingSplitBtn          { bottom: 160px;  left: 20px; }
/*#floatingReinforceBtn      { bottom: 220px; left: 20px; }
/*#floatingUndoMoveBtn       { bottom: 280px; left: 20px; }
/*#floatingConsolidateBtn    { bottom: 320px; left: 20px; display: none; } 
/*#floatingAssignGeneralBtn  { bottom: 380px; left: 20px; display: none;}
/*#floatingNextUnitBtn       { bottom: 440px; left: 20px; display: none; }
/*#floatingManageBtn         { bottom: 320px; left: 20px; display: none; }
/*#floatingInboxBtn          { bottom: 400px; right: 20px; width: 50px; height: 50px; border-radius: 50%; font-size: 28px; padding: 0; display: flex; justify-content: center; align-items: center; }

/* --- Estados Deshabilitados --- */
.floating-btn:disabled, #floatingUndoMoveBtn:disabled, #floatingReinforceBtn:disabled, #floatingSplitBtn:disabled, #floatingBuildBtn:disabled {
    background-color: #6c757d !important; opacity: 0.5;
    cursor: not-allowed; transform: scale(1) !important;
}
#floatingEndTurnBtn:disabled {
    background-color: #6c757d !important; opacity: 0.5;
    cursor: not-allowed; transform: scale(1) !important;
}

/* ========================================================================== */
/* 6.1 BOTONES FLOTANTES (ESTRUCTURA SEPARADA: FIJOS Y MEN√ö)                */
/* ========================================================================== */

/* --- 1. CONTENEDOR MAESTRO DE LA UI T√ÅCTICA --- */
#tactical-ui-container {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    pointer-events: none; /* No intercepta clics */
    z-index: 1001;
}

/* --- 2. BASE COM√öN PARA TODOS LOS GRUPOS (IZQUIERDA Y DERECHA) --- */
.floating-action-group {
    position: fixed;
    display: flex;
    gap: 8px;
    pointer-events: all; /* Permite clics en el √°rea del grupo */
}

/* --- 3. ESTILOS PARA TODOS LOS BOTONES --- */
.floating-action-group button {
    position: relative;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    border: 1px solid #7f8c8d;
    background-color: rgba(44, 62, 80, 0.9);
    color: #ecf0f1;
    font-size: 24px;
    cursor: pointer;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    flex-shrink: 0;
}
.floating-action-group button:hover:not(:disabled) {
    background-color: #34495e;
    transform: scale(1.1);
}
.floating-action-group button:disabled {
    background-color: #6c757d !important;
    opacity: 0.5;
    cursor: not-allowed;
    transform: none !important;
}

/* --- 4. POSICIONAMIENTO Y DIRECCI√ìN DE CADA GRUPO --- */

/* Grupo Izquierda */
.floating-action-group.left {
    bottom: 20px;
    left: 15px;
    flex-direction: column-reverse; /* Apila de abajo a arriba */
    align-items: flex-start;
}

/* Grupo Derecha (Contenedor maestro) */
.floating-action-group.right {
    bottom: 20px;
    right: 15px;
    flex-direction: column; /* Apila sus hijos (men√∫, ¬ª, ‚ñ∫) de arriba a abajo */
    align-items: flex-end;
}

/* --- 5. L√ìGICA DEL SUBMEN√ö ‚öôÔ∏è DE LA DERECHA --- */

.right-menu-group {
    position: relative; /* Contexto para el submen√∫ */
    display: flex;
    flex-direction: column-reverse; /* El submen√∫ sale hacia ARRIBA del bot√≥n ‚öôÔ∏è */
    align-items: flex-end;
    gap: 15px;
}

.submenu {
    display: flex;
    flex-direction: row-reverse; /* Botones se despliegan de derecha a izquierda */
    gap: 15px;
    max-width: 0;
    overflow: hidden;
    opacity: 0;
    transition: all 0.3s ease-out;
    pointer-events: none;
}

/* L√≥gica de apertura (ahora con el padre correcto) */
.right-menu-group.is-open .submenu {
    max-width: 500px;
    opacity: 1;
    pointer-events: all;
}

/* --- 6. ESTILOS FINALES PARA LOS BOTONES DE LA DERECHA --- */
#floatingEndTurnBtn {
    width: 30px;
    height: 30px;
    font-size: 28px;
    background-color: rgba(40, 167, 69, 0.9);
}

#floatingNextUnitBtn {
    display: none;
}

/* ========================================================================== */
/* 5. PANELES DE UI y DISE√ëO ADAPTABLE (REVISI√ìN M√ìVIL)
/* ========================================================================== */

/* --- Panel de Predicci√≥n de Combate --- */
#combatPredictionPanel {
    position: fixed;
    background-color: rgba(20, 20, 20, 0.9);
    color: #f0f0f0;
    padding: 10px 15px;
    border: 1px solid #555;
    border-radius: 8px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-size: 0.9em;
    z-index: 10001;
    pointer-events: none;
    white-space: nowrap;
    box-shadow: 0 4px 8px rgba(0,0,0,0.4);
    transition: opacity 0.1s linear;
    opacity: 0;
}
#combatPredictionPanel.visible { opacity: 1; }
#combatPredictionPanel h4 {
    margin: 0 0 8px 0;
    color: #f39c12;
    font-size: 1.1em;
    text-align: center;
    border-bottom: 1px solid #444;
    padding-bottom: 5px;
}
#combatPredictionPanel p { margin: 5px 0; line-height: 1.4; }
#combatPredictionPanel span.attacker-damage { color: #e74c3c; font-weight: bold; }
#combatPredictionPanel span.defender-damage { color: #3498db; font-weight: bold; }
#combatPredictionPanel span.critical-info { color: #f1c40f; font-weight: bold; display: block; text-align: center; margin-top: 8px; }

/* --- Panel de Men√∫ Flotante --- */
#floatingMenuPanel {
    position: fixed; z-index: 9999;
    background-color: rgba(245, 245, 245, 0.95);
    border: 1px solid #ccc;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    padding: 15px;
    transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    display: none;
    top: 70px; left: 10px; width: 260px;
}
#floatingMenuPanel h4 { text-align: center; margin-top: 0; margin-bottom: 10px; font-size: 1em; color: #333; }
#floatingMenuPanel #playerResourcesGrid_float {
    display: grid; grid-template-columns: repeat(7, 1fr); grid-template-rows: auto auto;
    gap: 4px 2px; padding: 8px; margin-bottom: 10px; background-color: #f8f9fa;
    border: 1px solid #e0e0e0; border-radius: 4px; text-align: center;
    font-size: 0.85em;
}
#floatingMenuPanel button, #floatingMenuPanel .button-like-label {
    width: 100%; display: block; margin-bottom: 8px; padding: 10px;
    text-align: left; background-color: #e9ecef; color: #333; border: 1px solid #ddd;
}
#floatingMenuPanel button:hover, #floatingMenuPanel .button-like-label:hover { background-color: #dee2e6; }
#floatingMenuPanel .resource-labels { grid-row: 1; grid-column: 1 / -1; display: contents; }
#floatingMenuPanel .resource-values { grid-row: 2; grid-column: 1 / -1; display: contents; }
#floatingMenuPanel .resource-labels span { font-size: 0.8em; font-weight: 500; color: #6c757d; }
#floatingMenuPanel .resource-values span { font-size: 0.9em; font-weight: bold; color: #212529; }

/* --- Paneles Inferiores (Contextual y Tutorial) - REGLA PRINCIPAL --- */

#contextualInfoPanel {
    bottom: 10px; /* Lo subimos para que deje espacio al tutorial debajo */
}

.tutorial-panel {
    bottom: 260px;
}

#contextualInfoPanel,
.tutorial-panel {
    position: fixed;
   /* bottom: 10px;*/
    left: 50%;
    
    width: 90vw;
    max-width: 450px;
    box-sizing: border-box;
    transform: translateX(-50%);

    background-color: rgba(10, 20, 30, 0.85);
    color: #cbd5e0;
    border: 1px solid rgba(135, 118, 70, 0.7);
    border-radius: 8px;
    padding: 8px 15px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.5);
    
    font-size: 0.85em;
    line-height: 1.6;
    
    pointer-events: none;
    z-index: 10000; /* Capa alta */
    
    opacity: 0;
    transition: opacity 0.3s ease, transform 0.3s ease;
}

#contextualInfoPanel.visible,
.tutorial-panel.visible {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
}

#contextualInfoPanel #closeContextualPanelBtn,
.tutorial-panel #closeTutorialPanelBtn {
    position: absolute;
    top: -8px;
    right: -8px;
    width: 28px;
    height: 28px;
    background-color: #c0392b;
    color: white;
    border: 2px solid white;
    border-radius: 50%;
    font-size: 16px;
    line-height: 24px;
    text-align: center;
    cursor: pointer;
    z-index: 10001; 
    pointer-events: auto !important; 
}

#reopenContextualPanelBtn {
    position: fixed;
    bottom: 10px;
     /* --- INICIO DEL CAMBIO --- */
    left: 50%; /* Lo mueve al centro horizontal */
    transform: translateX(-50%); /* Ajusta el centrado perfectamente */
    /* --- FIN DEL CAMBIO --- */
    width: 30px;
    height: 30px;
    background-color: rgba(30, 42, 56, 0.9);
    color: #e2e8f0;
    border: 1px solid #4a5568;
    border-radius: 5px;
    z-index: 999;
    cursor: pointer;
}

/* --- Panel de Turno del Oponente --- */
.turn-blocker {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 5000;
    display: flex; justify-content: center; align-items: center;
    font-size: 2.5em; color: white; text-shadow: 2px 2px 4px black;
    text-align: center; cursor: not-allowed;
}

/* --- REGLAS PARA PANTALLAS PEQUE√ëAS (M√ìVILES Y TABLETS) --- */
@media screen and (max-width: 768px) {
    
    /* Punto 7: Liberar esquinas para que no se tapen los botones en vertical */
    #contextualInfoPanel, .tutorial-panel {
        width: calc(100% - 130px) !important;
        min-width: 200px; /* Evita que se haga demasiado estrecho */
    }
    
    /* MODALES: Se hacen adaptables y ocupan casi toda la pantalla */
    .modal-content {
        width: 95vw !important;
        max-width: 95vw !important;
        max-height: 85vh !important;
        overflow-y: auto; /* A√ëADE SCROLL SI EL CONTENIDO ES MUY LARGO */
        padding: 15px;
    }
    
    /* MODAL DE H√âROE: Pasa de 3 columnas a 1 para que quepa en vertical */
    .hero-main-layout {
        grid-template-columns: 1fr; /* Una sola columna */
        gap: 15px;
    }
    .hero-main-layout .hero-column { padding: 10px; }
    
    /* MEN√ö DERECHO: Hacemos que el submen√∫ sea scrolleable si no cabe */
    .submenu {
        /* Restringe su altura m√°xima a un 50% de la pantalla y permite scroll */
        max-height: 50vh !important;
        overflow-y: auto !important;
    }
    .floating-action-group.right.is-open .submenu {
        /* Se expande a esa altura m√°xima */
        max-height: 50vh !important;
    }
    
    /* WIKI: Las pesta√±as se apilan si no caben en una l√≠nea */
    .wiki-tabs { flex-wrap: wrap; }
    .wiki-tab-btn { font-size: 0.8em; padding: 8px 10px; }
}

/* ========================================================================== */
/* 7. MODALES (base y espec√≠ficos)
/* ========================================================================== */

/* --- Modal Base --- */
.modal {
    display: none; position: fixed; z-index: 9998; left: 0; top: 0;
    width: 100%; height: 100%; overflow: auto;
    background-color: rgba(0,0,0,0.5);
    align-items: center; justify-content: center;
    pointer-events: auto;
}
.modal-content {
    background-color: #fefefe; padding: 20px; border: 1px solid #888;
    width: 90%; max-width: 600px; border-radius: 8px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    pointer-events: auto;
}
.close-button {
    color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;
    pointer-events: auto;
}
.close-button:hover, .close-button:focus { color: black; }
/** DUPLICADO: .close-button m√°s espec√≠fico para modales */
.modal .close-button {
    color: #aaa; position: absolute; top: 10px; right: 15px;
    font-size: 28px; font-weight: bold; cursor: pointer; line-height: 1;
}

/* --- Modal: Men√∫ Principal --- */
#mainMenuScreen.modal {
    background-color: transparent;
    position: fixed !important;
    overflow: hidden !important;
    z-index: 900 !important;
    top: 0 !important;
    left: 0 !important;
}

/* CUANDO EST√Å OCULTO: Asegurar que realmente no interfiere */
#mainMenuScreen.modal[style*="display: none"],
#mainMenuScreen.modal[style*="display:none"],
#mainMenuScreen.modal[style*="visibility: hidden"],
#mainMenuScreen.modal[style*="visibility:hidden"] {
    visibility: hidden !important;
    pointer-events: none !important;
    z-index: -1 !important;
    position: absolute !important;
    overflow: hidden !important;
}

/* Fallback: Si por alg√∫n motivo visibility est√° en hidden, asegurar que no interfiera */
#mainMenuScreen.modal[style*="visibility"] {
    pointer-events: none !important;
}

/* Elimina el fondo, borde y sombra de la caja de contenido. */
#mainMenuScreen .modal-content {
    width: 90%; /* Ocupa el 90% del ancho de la pantalla */
    background-color: transparent;
    border: none;
    box-shadow: none;
}

/* Oculta el t√≠tulo "Hex General Evolved" */
#mainMenuScreen h2 {
    display: none;
}

/* Estiliza los botones para que se vean bien sobre la imagen de fondo. */
#mainMenuScreen button {
    background-color: rgba(0, 0, 0, 0.6); /* Fondo negro semi-transparente */
    color: #f0e6d2; /* Color de texto tipo pergamino, m√°s c√°lido que el blanco puro */
    border: 1px solid rgba(255, 215, 0, 0.5); /* Borde sutil dorado/bronce */
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7); /* Sombra de texto para m√°xima legibilidad */
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    font-size: 1.2em; /* Un poco m√°s grande para darle epicidad */
    transition: all 0.2s ease-in-out; /* Transici√≥n suave para todos los efectos */
}

/* Efecto al pasar el rat√≥n por encima del bot√≥n. */
#mainMenuScreen button:hover,
#mainMenuScreen button:active {
    background-color: rgba(20, 20, 20, 0.8); /* Se oscurece un poco */
    border-color: rgba(255, 215, 0, 0.9); /* El borde se vuelve m√°s brillante */
    transform: translateY(-3px) scale(1.02); /* Se eleva y agranda ligeramente */
    box-shadow: 0 4px 15px rgba(0,0,0,0.4);
}

/* Mantenemos el estilo del bot√≥n de "Unirse a Partida" para que destaque */
#mainMenuScreen button#joinNetworkGameBtn {
    background-color: rgba(255, 193, 7, 0.7); /* Amarillo semi-transparente */
    color: #111;
    border-color: rgba(255, 255, 255, 0.6);
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
}

#mainMenuScreen button#joinNetworkGameBtn:hover {
    background-color: rgba(255, 193, 7, 0.9);
}

/* --- Modal: Detalles del H√©roe --- */
#heroDetailModal .modal-content {    max-width: 600px;    background-color: #f0f2f5;}
.hero-detail-header {
    display: flex;
    align-items: center;
    border-bottom: 2px solid #ccc;
    padding-bottom: 15px;
    margin-bottom: 15px;
}
.hero-detail-header .hero-sprite {
    font-size: 80px;
    margin-right: 20px;
    line-height: 1;
}
.hero-header-info h2 { margin: 0 0 5px 0; }
.hero-header-info p { margin: 0; font-style: italic; color: #6c757d; }
.hero-header-info .hero-rarity {
    margin-top: 8px;
    font-weight: bold;
    padding: 3px 8px;
    border-radius: 4px;
    display: inline-block;
}
.hero-rarity.Com√∫n { background-color: #adb5bd; color: white; }
.hero-rarity.Raro { background-color: #007bff; color: white; }
.hero-rarity.√âpico { background-color: #8a2be2; color: white; }
.hero-rarity.Legendario { background-color: #ffc107; color: #333; }

.hero-detail-body {
    display: flex;
    gap: 20px;
}
.hero-progression-section, .hero-skills-section {
    flex: 1;
}
.hero-progression-section h4, .hero-skills-section h4 {
    margin-top: 0;
    margin-bottom: 10px;
    border-bottom: 1px solid #ddd;
    padding-bottom: 5px;
}
.progress-item {
    margin-bottom: 15px;
    font-size: 0.9em;
}
.progress-item > span {
    display: block;
    margin-bottom: 5px;
}
.xp-bar-container {
    width: 100%;
    background-color: #ced4da;
    border-radius: 8px;
    height: 16px;
    overflow: hidden;
}
.xp-bar {
    height: 100%;
    width: 0%; /* Se actualizar√° con JS */
    background-color: #28a745;
    border-radius: 8px;
    transition: width 0.3s ease;
}
.xp-bar.fragments {
    background-color: #007bff;
}

.skill-item {
    margin-bottom: 10px;
}
.skill-item h5 {
    margin: 0 0 3px 0;
    color: #0056b3;
}
.skill-item p {
    margin: 0;
    font-size: 0.85em;
    color: #495057;
}
.skill-item.active-skill h5::before {
    content: 'ACTIVA | ';
    color: #dc3545;
    font-weight: bold;
}

.hero-detail-footer {
    margin-top: 20px;
    padding-top: 15px;
    border-top: 2px solid #ccc;
    text-align: right;
}
.hero-detail-footer button {
    padding: 8px 16px;
    margin-left: 10px;
}
.hero-detail-footer button:disabled {
    background-color: #6c757d;
    cursor: not-allowed;
    opacity: 0.6;
}

/* --- Modal: Briefing de Escenario --- */
#scenarioBriefingModal .modal-content { text-align: left; max-height: 90vh; overflow-y: auto; }
#scenarioBriefingModal #scenarioTitle { color: #0056b3; margin-bottom: 10px; }
#scenarioBriefingModal #scenarioImage { border: 1px solid #eee; max-width: 100%; height: auto; display: block; margin: 10px auto; border-radius: 4px; }
#scenarioBriefingModal #startScenarioBattleBtn { background-color: #28a745; color: white; display: block; margin: 20px auto 0 auto; padding: 10px 20px; }
#scenarioBriefingModal #startScenarioBattleBtn:hover { background-color: #1e7e34; }

/* --- Modal: √Årbol de Tecnolog√≠a --- */
.tech-tree-content .tech-node {
    position: absolute; width: 100px; height: 100px; background-color: #2a9d8f;
    color: white; border-radius: 50%; display: flex; flex-direction: column;
    align-items: center; justify-content: center; text-align: center;
    border: 3px solid #264653; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s;
    padding: 5px; box-sizing: border-box; font-size: 0.8em;
}
.tech-tree-content .tech-node:hover { transform: scale(1.05); box-shadow: 0 0 15px #f4a261; }
.tech-tree-content .tech-node img { width: 40px; height: 40px; margin-bottom: 5px; }
.tech-tree-content .tech-node.researched { background-color: #e9c46a; border-color: #f4a261; }
.tech-tree-content .tech-node.available { background-color: #2a9d8f; border-color: #264653; box-shadow: 0 0 10px 3px #aaf0d1; }
.tech-tree-content .tech-node.locked { background-color: #6c757d; opacity: 0.7; cursor: not-allowed; }

/* ========================================================== */
/* ==   NUEVOS ESTILOS COMPLETOS PARA TALENTOS (V2)        == */
/* ========================================================== */

/* --- Contenedor Principal del Modal Grande --- */
#talentTreeModal .modal-content.talent-tree-modal-content {
    width: 90vw;
    max-width: 1400px;
    height: 85vh;
    background-color: #2c3e50; /* Un azul-gris oscuro */
    color: #ecf0f1;
    display: flex;
    flex-direction: column;
    padding: 15px;
    border: 2px solid #95a5a6;
    box-shadow: 0 0 30px rgba(0,0,0,0.5);
}

.talent-modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #7f8c8d;
    padding-bottom: 10px;
    margin-bottom: 10px;
    flex-shrink: 0;
}
.talent-points-counter {
    font-size: 1.2em;
    font-weight: bold;
    color: #f1c40f; /* Dorado */
}
#resetTalentsBtn {
    background-color: #c0392b; /* Rojo */
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 5px;
    cursor: pointer;
}

/* --- El Viewport Scrollable --- */
#talentCanvasContainer {
    position: relative;
    flex-grow: 1; /* Ocupa todo el espacio disponible */
    overflow: auto; /* ¬°LA CLAVE! Permite el scroll */
    background-color: #34495e;
    border-radius: 8px;
    border: 1px solid #7f8c8d;
}

/* --- El Lienzo Gigante donde se dibuja TODO --- */
/* --- El Lienzo Gigante donde se dibuja TODO (TAMA√ëO CORREGIDO) --- */
.talent-tree-canvas {
    position: absolute;
    top: 0;
    left: 0;
    width: 1500px;  /* TU TAMA√ëO */
    height: 1500px; /* TU TAMA√ëO */
}

/* --- El Nexo Central (POSICI√ìN CORREGIDA) --- */
#talentNexoContainer {
    position: absolute;
    top: 950px;    /* TU COORDENADA Y */
    left: 750px;   /* TU COORDENADA X */
    transform: translate(-50%, -50%);
    width: 180px;
    height: 180px;
    z-index: 100;
    border-radius: 50%;
    background: #1f2b38;
    box-shadow: 0 0 20px rgba(0,0,0,0.7);
    border: 4px solid #7f8c8d;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    font-weight: bold;
    color: #ecf0f1;
}

/* --- Las L√≠neas de Conexi√≥n SVG --- */
.talent-svg-lines {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1; /* Por debajo de los nodos */
}

#talentNexoContainer .nexo-pie {
    /* Los "pies" ahora son simples divs dentro del c√≠rculo, m√°s f√°ciles de manejar */
    position: absolute;
    width: 100px;
    height: 100px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    transition: transform 0.2s;
    cursor: pointer;
    border: none;
}
#talentNexoContainer .nexo-pie:hover {
    transform: scale(1.1);
}
/* Posicionamiento simple usando translate */
.nexo-pie:nth-child(1) { transform: translate(-60%, 45%); } /* Izquierda-Abajo, m√°s centrado */
.nexo-pie:nth-child(2) { transform: translateY(-65%); }    /* Arriba, m√°s centrado */
.nexo-pie:nth-child(3) { transform: translate(60%, 45%); }  /* Derecha-Abajo, m√°s centrado */

.nexo-icon { font-size: 2.2em; line-height: 1; }
.nexo-name { font-size: 0.9em; margin-top: 5px; }


/* --- Nodos de Talento Individuales --- */
.talent-node {
    position: absolute;
    color: white;
    background-color: #4a5568; /* Gris oscuro */
    border: 3px solid #718096; /* Borde gris m√°s claro */
    z-index: 10;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: not-allowed;
    transition: transform 0.2s, box-shadow 0.2s;
    font-size: 1.2em; /* Icono m√°s grande */
    padding: 5px;
    box-sizing: border-box;
}
/* Formas de los nodos */
.talent-node.square { width: 50px; height: 50px; border-radius: 8px; }
.talent-node.circle { width: 45px; height: 45px; border-radius: 50%; }

/* Estados de los nodos */
.talent-node.available {
    background-color: #2980b9; /* Azul */
    border-color: #3498db;
    cursor: pointer;
    box-shadow: 0 0 15px rgba(52, 152, 219, 0.5);
}
.talent-node.maxed {
    background-color: #d69e2e; /* Dorado */
    border-color: #f1c40f;
    cursor: help;
}
.talent-node.available:hover {
    transform: translate(-50%, -50%) scale(1.1); /* Importante para no perder el centrado */
    box-shadow: 0 0 20px rgba(52, 152, 219, 0.9);
}

/* Nivel del talento */
.talent-node-level {
    position: absolute;
    bottom: -10px;
    right: -10px;
    font-weight: bold;
    font-size: 0.7em;
    background-color: rgba(0,0,0,0.8);
    color: #f1c40f; /* Dorado */
    border-radius: 50%;
    width: 24px;
    height: 24px;
    line-height: 24px;
    text-align: center;
    border: 1px solid #f1c40f;
}

/*===============================================================*/
/* --- Estilos para la Columna de Equipo (Dise√±o de Cuerpo) --- */
/*=============================================================*/
.equipment-layout {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px; /* Espacio entre filas */
    padding-top: 15px;
}

.equip-row-single {
    display: flex;
    justify-content: center;
}

.equipment-slot {
    height: 75px;
    background-color: #e9ecef;
    border: 2px dashed #adb5bd;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: background-color 0.2s, border-color 0.2s;
    position: relative; /* Para futuros iconos de objetos */
}

.equipment-slot:hover {
    background-color: #dde2e6;
    border-color: #007bff;
}

.equipment-slot span {
    color: #6c757d;
    font-size: 0.8em;
    font-weight: 500;
}

/* --- Posicionamiento espec√≠fico dentro de la rejilla central 2x2 --- */
/* --- Reemplaza esta secci√≥n en tu CSS --- */

.equip-row-middle {
    display: grid;
    /* Creamos una rejilla imaginaria de 2 columnas y 3 filas */
    grid-template-columns: 1fr 1fr;
    grid-template-rows: auto auto auto;
    gap: 10px;
    width: 100%;
    align-items: center; /* Centra los items verticalmente en sus filas */
}

/* --- Posicionamiento EXACTO para formar el rombo --- */

/* La Coraza ocupa las 2 columnas de la primera fila */
#equip-chest { 
    grid-column: 1 / span 2; 
    grid-row: 1;
    justify-self: center; /* Se centra horizontalmente en su √°rea */
    width: 50%; /* Hacemos que sea m√°s estrecho para formar el pico del rombo */
}

/* Los Guantes en la primera columna de la segunda fila */
#equip-gloves {
    grid-column: 1;
    grid-row: 2;
}

/* El Arma en la segunda columna de la segunda fila */
#equip-weapon {
    grid-column: 2;
    grid-row: 2;
}

/* El Pantal√≥n ocupa las 2 columnas de la tercera fila */
#equip-legs {
    grid-column: 1 / span 2;
    grid-row: 3;
    justify-self: center; /* Se centra horizontalmente */
    width: 50%; /* Tambi√©n m√°s estrecho para la base del rombo */
}

/* --- Estilos para el Pie de P√°gina del Modal de H√©roe --- */
.hero-detail-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 15px;
    padding-top: 15px;
    border-top: 1px solid #dee2e6;
}

.talent-button {
    background-color: #007bff;
    color: white;
    font-weight: bold;
    font-size: 1.1em;
    padding: 12px 24px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}
.talent-button:hover {
    background-color: #0056b3;
}
.upgrade-buttons button {
    margin-left: 10px;
    padding: 10px 20px;
}

/* --- Estilos para el Modal de √Årbol de Talentos (Pantalla Grande) --- */
.talent-tree-modal-content {
    width: 90vw;
    max-width: 1200px;
    height: 85vh;
    background-color: #34495e;
    color: #ecf0f1;
    display: flex;
    flex-direction: column;
    padding: 20px;
}
.talent-modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #7f8c8d;
    padding-bottom: 15px;
    margin-bottom: 15px;
}
.talent-points-counter {
    font-size: 1.2em;
    font-weight: bold;
}
#resetTalentsBtn {
    background-color: #e74c3c;
    color: white;
}

/* Reutilizamos los estilos de .tabs y .tab-button que ya ten√≠as */
#talentTreeTabs {
    border-bottom: 2px solid #95a5a6;
}
#talentTreeTabs .tab-button.active {
    color: #f1c40f;
    border-bottom-color: #f1c40f;
}

/* Renombramos tu .talent-tree-container para ser m√°s espec√≠fico */
#talentTreeContainer {
    flex-grow: 1; /* Ocupa el espacio restante */
    position: relative; /* Clave para el posicionamiento absoluto de los nodos */
    overflow: auto;
    background-color: #2c3e50;
    border-radius: 5px;
    margin-top: 10px;
}

/* ========================================================== */
/* ==   NUEVO: ESTILOS PARA SELECCI√ìN DE EQUIPO             == */
/* ========================================================== */

/* Indicador visual en el slot del h√©roe si hay mejoras disponibles */
.equipment-slot.available-upgrade {
    border-style: solid;
    border-color: #28a745; /* Verde brillante */
    background-color: #e9f7ef;
    animation: pulse-green 1.5s infinite;
}

@keyframes pulse-green {
    0% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0.7); }
    70% { box-shadow: 0 0 0 10px rgba(40, 167, 69, 0); }
    100% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0); }
}

/* Contenedor de la lista en el modal de selecci√≥n */
.equipment-list {
    max-height: 50vh;
    overflow-y: auto;
    border: 1px solid #ddd;
    border-radius: 5px;
    margin-top: 15px;
    background-color: #f8f9fa;
}

/* Cada item en la lista de selecci√≥n */
.equipment-item {
    display: flex;
    align-items: center;
    padding: 12px;
    cursor: pointer;
    border-bottom: 1px solid #eee;
    transition: background-color 0.2s;
}

.equipment-item:last-child {
    border-bottom: none;
}

.equipment-item:hover {
    background-color: #e9ecef;
}

.equipment-item.selected {
    background-color: #d4edda; /* Verde claro para el seleccionado */
    border-left: 4px solid #28a745;
}

.equipment-item .item-icon {
    font-size: 2.5em;
    margin-right: 15px;
    width: 40px;
    text-align: center;
}

.equipment-item .item-info {
    display: flex;
    flex-direction: column;
}

.equipment-item .item-name {
    font-weight: bold;
    font-size: 1.1em;
    margin-bottom: 4px;
}

/* Colores para el nombre del item seg√∫n su rareza */
.rarity-Com√∫n { color: #6c757d; }
.rarity-Raro { color: #007bff; }
.rarity-√âpico { color: #8a2be2; }
.rarity-Legendario { color: #fd7e14; }

.equipment-item .item-stats {
    font-size: 0.9em;
    color: #495057;
}

/* ========================================================== */
/* --- Modales: Gesti√≥n de Unidades --- */
/* ========================================================== */
/* Listas gen√©ricas en modales */
#availableRegimentsList li, #currentDivisionRegimentsList li, #availableStructuresList li {
    cursor: pointer; padding: 8px; border-bottom: 1px solid #eee; transition: background-color 0.2s;
}
#availableRegimentsList li:hover, #currentDivisionRegimentsList li:hover, #availableStructuresList li:hover { background-color: #f0f0f0; }
#availableStructuresList li.selected-structure { background-color: #d0e0ff; font-weight: bold; }

/* Panel de edici√≥n de nombre */
#unit-info .unit-name-editor { display: flex; align-items: center; margin-bottom: 8px; }
#unit-info .unit-name-editor label { margin-right: 5px; font-weight: bold; }
#unit-info #selectedUnitNameInput { flex-grow: 1; padding: 5px; border: 1px solid #ccc; border-radius: 3px; margin-right: 5px; background-color: #f8f9fa; }
#unit-info #selectedUnitNameInput:not([readonly]) { background-color: #fff; border-color: #007bff; }
#unit-info .unit-name-editor button { padding: 4px 8px; font-size: 0.9em; background-color: #e9ecef; border: 1px solid #ced4da; border-radius: 3px; cursor: pointer; }
#unit-info .unit-name-editor button:hover { background-color: #dee2e6; }
#unit-info #saveUnitNameBtn { background-color: #28a745; color: white; }
#unit-info #saveUnitNameBtn:hover { background-color: #218838; }

/* Lista detallada de regimientos */
.regiments-detailed-list { list-style: none; padding: 0; margin: 0; font-size: 0.8em; max-height: 150px; overflow-y: auto; border: 1px solid #e0e0e0; border-radius: 3px; background-color: #fdfdfd; }
.regiments-detailed-list li { padding: 6px 8px; border-bottom: 1px dashed #eee; }
.regiments-detailed-list li:last-child { border-bottom: none; }
.regiments-detailed-list li strong { color: #0056b3; }

/* Modal de Gesti√≥n General de Unidades */
.unit-management-content {
    width: 90%; max-width: 800px; background-color: #f0f2f5; padding: 20px;
    border-radius: 10px; box-shadow: 0 5px 20px rgba(0,0,0,0.2);
    display: flex; flex-direction: column;
}
.unit-management-content h3 { text-align: center; color: #333; margin-top: 0; margin-bottom: 20px; }
.unit-management-body { display: flex; gap: 20px; flex-grow: 1; min-height: 400px; }
.unit-selection-panel { flex: 2; display: flex; flex-direction: column; border: 1px solid #ccc; border-radius: 5px; background-color: #fff; }
.category-tabs { display: flex; border-bottom: 1px solid #ccc; padding: 5px; background-color: #e9ecef; }
.category-tabs .tab-btn { flex-grow: 1; padding: 10px 5px; background-color: transparent; border: none; border-radius: 3px; cursor: pointer; font-weight: 500; color: #495057; transition: background-color 0.2s; }
.category-tabs .tab-btn:hover { background-color: #dee2e6; }
.category-tabs .tab-btn.active { background-color: #007bff; color: white; }
.available-units-list { padding: 10px; overflow-y: auto; flex-grow: 1; }
.unit-entry { display: flex; justify-content: space-between; align-items: center; padding: 8px 5px; border-bottom: 1px solid #eee; }
.unit-entry:last-child { border-bottom: none; }
.unit-entry span { font-weight: 500; }
.quantity-controls { display: flex; align-items: center; }
.quantity-controls .quantity-btn { width: 28px; height: 28px; border: 1px solid #ccc; background-color: #f8f9fa; font-size: 1.2em; cursor: pointer; line-height: 1; }
.quantity-controls .quantity-input { width: 40px; text-align: center; border: 1px solid #ccc; border-left: none; border-right: none; height: 26px; -moz-appearance: textfield; }
.quantity-controls .quantity-input::-webkit-outer-spin-button, .quantity-controls .quantity-input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
.division-summary-panel { flex: 1; padding: 15px; background-color: #ffffff; border: 1px solid #ddd; border-radius: 5px; display: flex; flex-direction: column; }
.division-summary-panel h4 { margin-top: 0; text-align: center; border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 15px; }
.division-name-editor { margin-bottom: 15px; }
.division-name-editor input { width: 100%; padding: 8px; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px; }
#divisionCompositionList { list-style: none; padding: 0; margin: 0; flex-grow: 1; overflow-y: auto; }
#divisionCompositionList li { padding: 5px 0; }
.summary-details { border-top: 1px solid #eee; padding-top: 10px; margin-top: auto; font-size: 0.9em; }
.summary-details p { margin: 5px 0; }
.modal-footer-actions { display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px; }
.modal-footer-actions button { padding: 10px 20px; border-radius: 5px; border: none; font-weight: bold; cursor: pointer; }
#finalizeUnitManagementBtn { background-color: #28a745; color: white; }
#finalizeUnitManagementBtn:disabled { background-color: #94dcb0; cursor: not-allowed; }

/* Modal de Detalles de Unidad (Redise√±ado) */
#unitDetailModal .unit-detail-content, #unitDetailModal .modal-content { max-width: 400px; width: 90%; background-color: #e9ecef; padding: 15px; }
#unitDetailModal h3 { text-align: center; margin-top: 0; margin-bottom: 15px; font-size: 1.2em; }
.unit-main-stats { background-color: #fff; padding: 10px; border-radius: 5px; border: 1px solid #ccc; margin-bottom: 15px; }
.stat-row { display: flex; justify-content: space-between; align-items: center; font-size: 0.9em; padding: 4px 0; }
.stat-row.stat-summary span { font-weight: bold; }
.stat-row .stat-label { font-weight: bold; margin-right: 10px; }
.unit-total-health-bar-container { flex-grow: 1; height: 18px; background-color: #ced4da; border-radius: 9px; border: 1px solid #adb5bd; }
.unit-total-health-bar { height: 100%; background-color: #28a745; border-radius: 9px; transition: width 0.3s ease-out; }
#unitDetailTotalHealthText { margin-left: 10px; font-weight: bold; min-width: 80px; text-align: right; }
.regiment-section-title { text-align: center; font-size: 0.8em; color: #6c757d; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; }
#unitDetailRegimentList .regiment-detail-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 8px; border-bottom: 1px solid #eee; }
#unitDetailRegimentList .regiment-info { font-weight: 500; }
#unitDetailRegimentList .regiment-health-bar-container { flex-grow: 1; height: 12px; background-color: #e0e0e0; border-radius: 6px; margin: 0 15px; position: relative; }
#unitDetailRegimentList .regiment-health-bar { height: 100%; background-color: #4CAF50; border-radius: 6px; transition: width 0.3s ease; }
#unitDetailRegimentList .regiment-health-text { font-size: 0.8em; min-width: 50px; text-align: right; }
#unitDetailRegimentList .reinforce-btn { padding: 4px 8px; font-size: 1.2em; line-height: 1; margin-left: 10px; cursor: pointer; border: 1px solid #ccc; background-color: #f0f0f0; }
#unitDetailRegimentList .reinforce-btn:hover { background-color: #d4edda; }
#unitDetailRegimentList .reinforce-btn:disabled { opacity: 0.4; cursor: not-allowed; }
.detailed-regiments-list { background-color: #fff; border-radius: 5px; border: 1px solid #ccc; max-height: 250px; overflow-y: auto; padding: 5px !important; margin: 0 !important; }
.detailed-regiments-list .regiment-detail-item { display: flex; align-items: center; padding: 8px; border-bottom: 1px solid #f1f3f5; }
.detailed-regiments-list .regiment-detail-item:last-child { border-bottom: none; }
.regiment-icon { font-size: 1.5em; margin-right: 8px; width: 25px; text-align: center; }
.regiment-name { font-weight: 500; width: 100px; flex-shrink: 0; }
.detailed-regiments-list .regiment-health-bar-container { flex-grow: 1; height: 12px; background-color: #e9ecef; border-radius: 6px; margin: 0 10px; }
.detailed-regiments-list .regiment-health-bar { height: 100%; background-color: #519DE9; border-radius: 6px; transition: width 0.3s ease; }
.detailed-regiments-list .regiment-health-text { font-size: 0.8em; min-width: 60px; text-align: right; }
.reinforce-regiment-btn { background: #e9ecef; border: 1px solid #ced4da; border-radius: 50%; width: 24px; height: 24px; font-size: 1em; line-height: 1; cursor: pointer; margin-left: 10px; transition: background-color 0.2s; }
.reinforce-regiment-btn:hover { background-color: #d4edda; }
.reinforce-placeholder { width: 24px; height: 24px; margin-left: 10px; }

/* ========================================================== */
/* ==   NUEVO: ESTILOS PARA LA FORJA                        == */
/* ========================================================== */

/* Contenedor principal del modal de forja (2 columnas) */
.forge-container {
    display: flex;
    gap: 20px;
    margin-top: 20px;
    height: 60vh;
}

/* Columna Izquierda: Lista de planos */
.blueprint-list {
    flex: 1;
    border: 1px solid #ddd;
    border-radius: 5px;
    overflow-y: auto;
    background-color: #f8f9fa;
}

.blueprint-item {
    display: flex;
    align-items: center;
    padding: 10px;
    cursor: pointer;
    border-bottom: 1px solid #eee;
}

.blueprint-item:hover {
    background-color: #e9ecef;
}

.blueprint-item.selected {
    background-color: #e2e6ea;
    border-left: 4px solid #fd7e14; /* Naranja para la selecci√≥n */
}

.blueprint-item.can-forge .item-name {
    color: #28a745; /* Verde si se puede forjar */
}

.blueprint-item .item-icon {
    font-size: 2em;
    margin-right: 15px;
}

.blueprint-item .item-info .item-name {
    font-weight: bold;
}

.blueprint-item .item-info .item-progress {
    font-size: 0.9em;
    color: #6c757d;
}

/* Columna Derecha: Detalles del plano */
.blueprint-detail {
    flex: 1;
    padding: 20px;
    border: 1px solid #ddd;
    border-radius: 5px;
    background-color: #fff;
    display: flex;
    flex-direction: column;
}

.item-icon-large {
    font-size: 4em;
    text-align: center;
    margin-bottom: 15px;
}

#blueprintItemName {
    text-align: center;
    margin-top: 0;
}

#blueprintItemStats {
    text-align: center;
    font-style: italic;
    color: #495057;
    min-height: 40px;
}

.forge-progress-item {
    font-size: 0.9em;
}

#forgeItemBtn {
    background-color: #28a745;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}

#forgeItemBtn:disabled {
    background-color: #6c757d;
    cursor: not-allowed;
}
/* ========================================================== */
/* --- Modal: Wiki y Ayuda --- */
/* ========================================================== */

.help-modal-content {
    max-width: 700px; max-height: 90vh; overflow-y: auto;
    background-color: #f0f2f5; border: 1px solid #ccc;
    box-shadow: 0 5px 20px rgba(0,0,0,0.15); padding: 30px; position: relative;
}
.help-modal-content h2 { font-size: 2.2em; color: #0056b3; }
.help-modal-content h3 { font-size: 1.4em; color: #4a5568; margin-top: 25px; margin-bottom: 10px; border-bottom: 1px solid #e0e0e0; padding-bottom: 5px; }
.help-modal-content p { font-size: 1em; line-height: 1.5; color: #333; margin-bottom: 15px; }
.help-modal-content b { font-weight: bold; color: #007bff; }
.help-modal-content ul { list-style: disc; margin-left: 20px; margin-bottom: 15px; }
.help-modal-content li { margin-bottom: 5px; }
.help-modal-content button { background-color: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.2s ease-in-out; font-weight: bold; }
.help-modal-content button:hover { background-color: #218838; }
#doNotShowAgainCheckbox { transform: scale(1.2); margin-right: 8px !important; }

.wiki-content {
    width: 95%; max-width: 900px; height: 85vh; display: flex; flex-direction: column; padding: 20px;
}
.wiki-content h2 { text-align: center; margin-top: 0; margin-bottom: 15px; color: #333; }
.wiki-tabs { display: flex; border-bottom: 2px solid #007bff; margin-bottom: 15px; }
.wiki-tab-btn { padding: 10px 15px; cursor: pointer; border: none; background-color: transparent; font-size: 1em; font-weight: 500; color: #0056b3; border-radius: 5px 5px 0 0; transition: background-color 0.2s, color 0.2s; }
.wiki-tab-btn.active { background-color: #007bff; color: white; }
.wiki-tab-btn:hover:not(.active) { background-color: #e9ecef; }
.wiki-tab-content { flex-grow: 1; overflow-y: auto; padding-right: 10px; }
.wiki-page { display: none; }
.wiki-page.active { display: block; }
.wiki-page h3 { margin-top: 10px; margin-bottom: 10px; border-bottom: 1px solid #ccc; padding-bottom: 5px; }
.wiki-page p { font-size: 0.9em; color: #555; margin-bottom: 15px; }
.table-container { overflow-x: auto; }
.wiki-content table { width: 100%; border-collapse: collapse; font-size: 0.9em; }
.wiki-content th, .wiki-content td { padding: 8px 10px; border: 1px solid #ddd; text-align: left; vertical-align: middle; }
.wiki-content thead th { background-color: #f2f2f2; font-weight: bold; }
.wiki-content tbody tr:nth-child(even) { background-color: #f9f9f9; }
.wiki-regiment-icon { font-size: 1.5em; width: 30px; text-align: center; }
.wiki-stars { color: #f39c12; white-space: nowrap; }
#wikiConceptsContent div { margin-bottom: 20px; }
#wikiConceptsContent h4 { font-size: 1.1em; color: #0056b3; margin-bottom: 5px; }

/* --- Modal: Lobby Multijugador --- */
#lanLobbyScreen .container { border: 1px solid #ddd; border-radius: 5px; padding: 15px; margin-top: 15px; background-color: #f9f9f9; }
#lanLobbyScreen h2, #lanLobbyScreen h3 { text-align: center; color: #333; }
#lan-room-id { color: #007bff; font-family: monospace; font-size: 1.1em; user-select: all; }
#lan-status.conectado { color: #28a745; }
#lan-status.desconectado { color: #dc3545; }
#lan-player-list { list-style: none; padding-left: 10px; }
#lan-start-game-btn { display: block; margin: 15px auto 0; width: 60%; padding: 12px; background-color: #28a745; }



/* Modal: Gachas */
#gachaResultList li {
    padding: 8px;
    border-bottom: 1px solid #ced4da;
    font-size: 1.1em;
}

    #gachaResultList li:last-child {
        border-bottom: none;
    }

    /* Colores por rareza en los resultados */
    .rarity-COMUN { color: #6c757d; }
    .rarity-RARO { color: #007bff; font-weight: bold; }
    .rarity-EPICO { color: #8a2be2; font-weight: bold; }
    .rarity-LEGENDARIO { color: #ffc107; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.3); }

/* ========================================================================== */
/* 8. ANIMACIONES (@keyframes)
/* ========================================================================== */

@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
@keyframes shake { 0%, 100% { transform: translateX(0); } 10% { background-color: rgba(255,0,0,0.5); } 20% { transform: translateX(-2px); background-color: transparent; } 40% { transform: translateX(2px); } 60% { transform: translateX(-2px); } 80% { transform: translateX(2px); } }
@keyframes explode { 0% { transform: scale(1) rotate(0deg); opacity: 1; } 50% { transform: scale(1.3) rotate(15deg); opacity: 0.5; } 100% { transform: scale(0.3) rotate(-15deg); opacity: 0; display:none !important; } }
@keyframes unitHit { 0% { transform: translateX(0) translateY(0); } 25% { transform: translateX(-5px) translateY(-5px) rotate(-2deg); } 50% { transform: translateX(5px) translateY(5px) rotate(2deg); } 100% { transform: translateX(0) translateY(0); } }
@keyframes unitAttacking { 0% { transform: scale(1); } 50% { transform: scale(1.1) translateX(5px) translateY(5px); } 100% { transform: scale(1); } }
@keyframes hexHitFlash { 0% { background-color: transparent; } 50% { background-color: rgba(255, 100, 100, 0.7); } 100% { background-color: transparent; } }
@keyframes ownerChangeFlash { 0% { box-shadow: inset 0 0 0 0px transparent; } 50% { box-shadow: inset 0 0 0 5px gold; } 100% { box-shadow: inset 0 0 0 3px var(--owner-color); } }
.explosion-animation { position: absolute; width: 32px; height: 32px; background-image: url('images/explosion.png'); background-size: 256px 32px; background-repeat: no-repeat; animation: playExplosion 0.6s steps(8) forwards; z-index: 100; pointer-events: none; transform: translate(-50%, -50%); }
@keyframes playExplosion { from { background-position: 0px; } to { background-position: -1024px; } }
@keyframes floatAndFade { 0% { transform: translateY(0) scale(1); opacity: 1; } 100% { transform: translateY(-50px) scale(0.8); opacity: 0; } }
@keyframes pulseHighlight { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(1.02); opacity: 0.8; } }
@keyframes pulseHighlightHex { 0% { box-shadow: inset 0 0 0 4px gold, inset 0 0 0 8px rgba(0, 255, 255, 0.7); } 100% { box-shadow: inset 0 0 0 6px gold, inset 0 0 0 10px rgba(0, 255, 255, 0.9); } }


/* ========================================================================== */
/* 13. ESTILOS DEL NUEVO MEN√ö PRINCIPAL INTERACTIVO (COMPLETO)
/* ========================================================================== */

/* --- Contenedor y Estilo Base de Hotspots --- */

#interactiveBoardContainer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: auto;
    z-index: 10;
}

.main-menu-hotspot {
    position: absolute;
  /*  background-color: rgba(255, 0, 0, 0.4); /* Descomentado para que veas las zonas rojas y puedas ajustarlas */
    border-radius: 25px;
    cursor: pointer;
    transition: transform 0.1s ease-out, background-color 0.1s;
    animation: pulse-glow 3s infinite ease-in-out;
}

/* --- Posicionamiento de cada Hotspot (Estimaci√≥n inicial) --- */

/* Partida R√°pida: Tablero hexagonal central */
#hotspotMap {
    top: 45%;
    left: 32%;
    width: 36%;
    height: 50%;
    border-radius: 50%;
    animation-delay: 0s;
}

/* Cuartel: Libro arriba a la izquierda */
#hotspotBarracks {
    top: 20%;
    left: 20%;
    width: 13%;
    height: 28%;
    animation-delay: -0.5s;
}

/* Forja: Manuscrito de Soldado a la izquierda */
#hotspotForge {
    top: 60%;
    left: 12%;
    width: 18%;
    height: 28%;
    animation-delay: -1s;
}

/* Altar de los Deseos: Manuscrito a la derecha arriba de soldado*/
#hotspotAltar {
    top: 20%;
    left: 72%;
    width: 13%;
    height: 28%;
    animation-delay: -1.5s;
}

/* Campa√±a: Ventana con el Arbol y el rio */
#hotspotCampaign {
    top: 10%;
    left: 35%;
    width: 35%;
    height: 25%;
    animation-delay: -2s;
}

/* Tronos de Iberia: Ruinas a la derecha */
#hotspotThrones {
    top: 60%;
    left: 72%;
    width: 18%;
    height: 28%;
    animation-delay: -2.5s;
}


/* --- Efectos Visuales y Animaciones --- */

@keyframes pulse-glow {
    0% { box-shadow: 0 0 8px 3px rgba(255, 220, 100, 0); }
    50% { box-shadow: 0 0 16px 8px rgba(255, 220, 100, 0.5); }
    100% { box-shadow: 0 0 8px 3px rgba(255, 220, 100, 0); }
}

.main-menu-hotspot:active {
    background-color: rgba(255, 255, 150, 0.35);
    animation: none;
    box-shadow: 0 0 20px 10px rgba(255, 255, 100, 0.6);
    transform: scale(1.05);
}


/* --- UI restante del men√∫ --- */

#generalInfoPanel {
    position: absolute;
    top: 15px;
    right: 15px;
    background-color: rgba(0, 0, 0, 0.6);
    color: #f0e6d2;
    padding: 8px 15px;
    border-radius: 8px;
    border: 1px solid rgba(255, 215, 0, 0.5);
    font-size: 0.9em;
    display: flex;
    align-items: center;
    gap: 15px;
}

#logoutBtn_main {
    background: none;
    border: none;
    color: #f0e6d2;
    font-size: 1.5em;
    cursor: pointer;
    padding: 0;
    line-height: 1;
}

#gameModesModal button {
    background-color: rgba(40, 40, 40, 0.8);
    color: #f0e6d2;
    border: 1px solid rgba(255, 215, 0, 0.7);
    transition: background-color 0.2s;
}

#gameModesModal button:hover,
#gameModesModal button:active {
    background-color: rgba(60, 60, 60, 0.9);
    border-color: rgba(255, 215, 0, 1);
}

/* ========================================================================== */
/* 14. SISTEMA DE NOTIFICACIONES (TOASTS)
/* ========================================================================== */

.toast-notification {
    position: fixed; /* Se pega a la pantalla, no al juego */
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%); /* Lo centra perfectamente */
    padding: 12px 25px;
    background-color: rgba(20, 20, 20, 0.9);
    color: #f0f0f0;
    border-radius: 20px;
    border: 1px solid #555;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
    z-index: 99999; /* Por encima de todo */
    font-size: 1.1em;
    font-weight: 500;
    text-align: center;
    pointer-events: none; /* No se puede hacer clic en la notificaci√≥n */
    opacity: 0; /* Empieza invisible */
    transition: opacity 0.3s ease-out;

    /* Animaci√≥n de entrada y salida */
    animation: toast-fade-in-out 3s ease-in-out forwards;
}

/* Tipos de notificaci√≥n (opcional, pero √∫til) */
.toast-notification.info {
    border-color: #3498db; /* Azul */
}
.toast-notification.success {
    border-color: #2ecc71; /* Verde */
}
.toast-notification.warning {
    border-color: #f1c40f; /* Amarillo */
}
.toast-notification.error {
    border-color: #e74c3c; /* Rojo */
}


@keyframes toast-fade-in-out {
    0% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.8);
    }
    15% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
    }
    85% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
    }
    100% {
        opacity: 0;
        transform: translate(-50%, -70px) scale(0.8);
    }
}

/* ========================================================================== */
/* ==   SOLUCI√ìN DEFINITIVA DE CAPTURA DE CLICS                            == */
/* ========================================================================== */

/* 1. La regla m√°s importante de todas.
   Forzamos a TODOS los botones dentro del contenedor de la UI t√°ctica a que
   SIEMPRE acepten eventos de rat√≥n, sin importar el estado de sus padres. */
#tactical-ui-container button {
    pointer-events: all !important;
}

/* 2. El contenedor de las unidades (gameBoard) no debe permitir que las unidades
   (que tienen pointer-events: none) bloqueen los clics al propio tablero. */
#gameBoard {
    pointer-events: all;
}
.unit {
    /* Esta es la regla clave que ten√≠as, la mantenemos.
       La unidad es "invisible" para los clics, que pasan a trav√©s de ella
       hasta el hex√°gono que est√° debajo. */
    pointer-events: none;
}
/* ========================================================================== */
/* ==   15. SISTEMA DE MODALES DE CONFIGURACI√ìN (UNIFICADO Y MOBILE-FIRST) == */
/* ========================================================================== */

/* --- 15.1: Base del Contenedor del Modal (Overlay) --- */
.modal-overlay {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.75);
    z-index: 9998;
    align-items: center;
    justify-content: center;
    padding: 10px;
    box-sizing: border-box;
}
.modal-overlay.active {
    display: flex;
}

/* --- 15.2: Base de la Ventana del Modal --- */
.modal-container {
    background-color: #f0f2f5;
    border: 1px solid #ced4da;
    border-radius: 12px;
    box-shadow: 0 5px 25px rgba(0,0,0,0.3);
    width: 95vw;
    height: auto;
    max-width: 500px;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    transform: scale(0.95);
    opacity: 0;
    transition: transform 0.2s ease-out, opacity 0.2s ease-out;
}
.modal-overlay.active .modal-container {
    transform: scale(1);
    opacity: 1;
}

/* --- 15.3: Cabecera, Cuerpo y Pie de P√°gina del Modal --- */
.modal-header {
    flex-shrink: 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 20px;
    border-bottom: 1px solid #dee2e6;
}
.modal-header h2 {
    margin: 0;
    font-size: 1.3em;
    color: #343a40;
}
.modal-close-btn {
    font-size: 2em;
    color: #6c757d;
    cursor: pointer;
    background: none;
    border: none;
}
.modal-body {
    padding: 20px;
    overflow-y: auto;
}
.modal-footer {
    flex-shrink: 0;
    display: flex;
    justify-content: flex-end;
    gap: 12px;
    padding: 15px 20px;
    background-color: #e9ecef;
    border-top: 1px solid #dee2e6;
    border-radius: 0 0 12px 12px;
}
.modal-footer button {
    padding: 10px 20px;
    font-size: 1em;
    font-weight: 500;
    border-radius: 5px;
    border: none;
    cursor: pointer;
}
.modal-footer .button-primary {
    background-color: #007bff;
    color: white;
}
.modal-footer .button-secondary {
    background-color: #6c757d;
    color: white;
}

/* --- 15.5: Estilos para PANTALLA 2 de Configuraci√≥n (Jugadores) --- */
#setupScreen2 .modal-body {
    padding: 15px;
}
.player-grid-container {
    display: grid;
    grid-template-columns: repeat(2, 1fr); 
    gap: 10px;
}
/* Para tablets y pantallas un poco m√°s grandes, 4 columnas */
@media (min-width: 500px) {
    .player-grid-container {
        grid-template-columns: repeat(4, 1fr);
    }
}
.player-card {
    background-color: #fff;
    border: 1px solid #ced4da;
    border-radius: 8px;
    padding: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
}
.player-card .player-icon {
    font-size: 1.8em;
    font-weight: bold;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    margin: 0;
    flex-shrink: 0;
}
.player-card select {
    width: 100%;
    padding: 8px 5px;
    font-size: 0.85em;
    border-radius: 4px;
}
.player-card select:disabled {
    background-color: #e9ecef;
    opacity: 0.7;
}

/* Colores para cada icono de jugador (reutilizados) */
.player-icon.player-color-1 { background-color: #007bff; }
.player-icon.player-color-2 { background-color: #dc3545; }
.player-icon.player-color-3 { background-color: #28a745; }
.player-icon.player-color-4 { background-color: #ffc107; }
.player-icon.player-color-5 { background-color: #6f42c1; }
.player-icon.player-color-6 { background-color: #fd7e14; }
.player-icon.player-color-7 { background-color: #20c997; }
.player-icon.player-color-8 { background-color: #e83e8c; }

/* ========================================================================== */
/* ==   MODALES DE JUEGO (ESTILO TEM√ÅTICO Y COMPACTO PARA M√ìVIL)           == */
/* ========================================================================== */

/* --- Clase base para aplicar el nuevo tema a cualquier modal --- */
.modal-themed .modal-content {
    background-color: #2c3e50;
    border: 2px solid #95a5a6;
    border-radius: 8px;
    box-shadow: 0 0 20px rgba(0,0,0,0.5);
    color: #ecf0f1;
    width: 95vw;
    max-width: 500px; /* Un m√°ximo razonable para la mayor√≠a de los modales */
    max-height: 90vh; /* Altura m√°xima para evitar scroll */
    padding: 0; /* Eliminamos el padding para tener control total */
    display: flex;
    flex-direction: column;
    margin: 0 0 10px 0; /* Reducimos el margen inferior del t√≠tulo */
    font-size: 1.1em; /* Un poco m√°s peque√±o para ser m√°s compacto */
}

/* --- Estilo para la cabecera (reutilizable) --- */
.modal-themed .modal-header {
    padding: 10px 15px;
    border-bottom: 1px solid #7f8c8d;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-shrink: 0;
}
.modal-themed h2, .modal-themed h3 {
    margin: 0;
    font-size: 1.1em;
    color: #f1c40f;
    text-transform: uppercase;
    letter-spacing: 1px;
}
.modal-themed .close-button {
    position: static; /* Quitamos el posicionamiento absoluto */
    color: #bdc3c7;
    font-size: 2em;
    float: none;
    line-height: 1;
}

/* --- Estilo para el cuerpo (con scroll si es necesario) --- */
.modal-themed .modal-body {
    padding: 15px;
    overflow-y: auto; /* Permite scroll si el contenido es muy largo */
    flex-grow: 1;
}

/* --- Estilo para el pie de p√°gina (reutilizable) --- */
.modal-themed .modal-footer {
    padding: 10px 15px;
    background-color: #212f3d;
    border-top: 1px solid #7f8c8d;
    border-radius: 0 0 6px 6px; /* Bordes redondeados solo abajo */
    flex-shrink: 0;
    display: flex;
    justify-content: flex-end;
    gap: 10px;
}

/* ---                  --- */
/*MODALES DE PANTALLAS DE BOTONES*/
/* ---                  --- */

/* ========================================================================== */
/* ==   MODALES DE UNIDAD (üí™, ‚úÇÔ∏è) - ACTUALIZACI√ìN A TEMA OSCURO            == */
/* ========================================================================== */

/* --- 1. MODAL DETALLES/REFORZAR UNIDAD (üí™) --- */

/* Hacemos el modal m√°s bajo para que no se salga de la pantalla en landscape */
#unitDetailModal .modal-content {
    background-color: #2c3e50;
    border: 2px solid #95a5a6;
    color: #ecf0f1;
    max-height: 95vh;  /* Nunca ocupes m√°s del 95% de la altura */
    height: auto;      /* La altura se adaptar√° a su contenido */
    padding: 15px;
    box-sizing: border-box; /* Incluye el padding en el tama√±o total */

    /* <<== LA MAGIA DEL FLEXBOX ==>> */
    display: flex;
    flex-direction: column; /* Apila los elementos verticalmente */
}

/* Permitimos que el t√≠tulo, los stats y la lista crezcan, pero la lista de regimientos es la que m√°s se expande */

/* El t√≠tulo y los stats principales ocupan el espacio que necesiten */
#unitDetailModal h3, 

/* La lista de regimientos ser√° la √∫nica que ocupe el resto del espacio y tendr√° scroll si es necesario */
#unitDetailModal .detailed-regiments-list {
    background-color: #34495e;
    border: 1px solid #7f8c8d;
    flex-grow: 1;         /* Haz que este elemento crezca y ocupe el espacio vertical restante */
    overflow-y: auto;     /* Activa el scroll vertical SOLO si la lista no cabe */
    min-height: 100px;    /* Dale una altura m√≠nima para que no desaparezca si no hay regimientos */
}

#unitDetailModal h3 {
    color: #f1c40f; /* T√≠tulo dorado */
}
/* Panel interno de stats principales */
#unitDetailModal .unit-main-stats {
    flex-shrink: 0; /* No permitimos que se encojan */
    background-color: #34495e; /* Fondo del panel */
    border: 1px solid #7f8c8d;
}
/* Barra de vida principal */
#unitDetailModal .unit-total-health-bar-container {
    background-color: #1f2b38; /* Fondo de la barra oscuro */
    border-color: #7f8c8d;
}
#unitDetailModal .stat-row,
#unitDetailModal #unitDetailTotalHealthText {
    color: #ecf0f1;
}

/* T√≠tulo de la secci√≥n de regimientos */
#unitDetailModal .regiment-section-title {
    color: #bdc3c7;
}

#unitDetailModal .detailed-regiments-list .regiment-detail-item {
    border-bottom: 1px solid #2c3e50; /* Separador oscuro */
}
/* Barra de vida de cada regimiento */
#unitDetailModal .detailed-regiments-list .regiment-health-bar-container {
    background-color: #1f2b38;
}
/* Bot√≥n para reforzar regimiento */
#unitDetailModal .reinforce-regiment-btn {
    background: #4a5568;
    border: 1px solid #7f8c8d;
    color: #ecf0f1;
}
#unitDetailModal .reinforce-regiment-btn:hover {
    background-color: #5a6a7a;
    border-color: #f1c40f;
}

/* ========================================================================== */
/* --- 2. MODAL DIVIDIR UNIDAD (‚úÇÔ∏è) --- */
/* ========================================================================== */

/* Modal de Divisi√≥n Avanzada */
#advancedSplitUnitModal .modal-content { max-width: 450px; padding: 15px; }
#advancedSplitUnitModal h3 { font-size: 1.1em; margin-bottom: 5px; }
#advancedSplitUnitModal > p { font-size: 0.8em; margin-bottom: 10px; }
.split-regiment-container { display: flex; gap: 10px; margin-top: 10px; flex-wrap: nowrap; }
.regiment-column { flex: 1; min-width: 0; padding: 8px; border: 1px solid #ddd; border-radius: 5px; background-color: #fff; display: flex; flex-direction: column; }
.regiment-column h4 { font-size: 1em; margin-top: 0; margin-bottom: 5px; padding-bottom: 4px; border-bottom: 1px solid #eee; text-align: center; }
.regiment-column p { font-size: 0.8em; margin: 2px 0; text-align: center; }
#newSplitUnitNameInput { padding: 4px; font-size: 0.9em; width: 100%; box-sizing: border-box; }
.regiments-list { list-style: none; padding: 0; margin: 5px 0 0 0; max-height: 200px; overflow-y: auto; border: 1px solid #91c5fa; border-radius: 3px; flex-grow: 1; }
.regiments-list li { padding: 6px 8px; font-size: 1.5em; display: flex; justify-content: space-between; align-items: center; cursor: pointer; border-bottom: 1px solid #eee; }
.regiments-list li:last-child { border-bottom: none; }
.regiments-list li:hover { background-color: #e9f7ff; }
.regiments-list li span.regiment-type { font-weight: bold; color: #007bff; margin-left: 5px; }
.regiments-list li span.regiment-actions { font-size: 0.8em; color: #007bff; }
#advancedSplitUnitModal .modal-footer-actions { margin-top: 15px; }
#advancedSplitUnitModal button { padding: 8px 16px; font-size: 0.9em; }
#advancedSplitUnitModal button:hover { background-color: #0056b3; }
#advancedSplitUnitModal button:disabled { background-color: #ccc; cursor: not-allowed; }
#advancedSplitUnitModal button#finalizeSplitBtn { background-color: #28a745; }
#advancedSplitUnitModal button#finalizeSplitBtn:hover { background-color: #218838; }
#advancedSplitUnitModal button#cancelAdvancedSplitBtn { background-color: #6c757d; }
#advancedSplitUnitModal button#cancelAdvancedSplitBtn:hover { background-color: #5a6268; }

/* Aplicamos el tema base al contenedor del modal */
#advancedSplitUnitModal .modal-content {
    background-color: #2c3e50;
    border: 2px solid #95a5a6;
    color: #ecf0f1;
}
#advancedSplitUnitModal h3,
#advancedSplitUnitModal h4 {
    color: #f1c40f; /* T√≠tulos dorados */
}
#advancedSplitUnitModal p {
    color: #bdc3c7; /* Texto descriptivo m√°s tenue */
}
/* Paneles internos de las columnas */
#advancedSplitUnitModal .regiment-column {
    background-color: #34495e;
    border: 1px solid #7f8c8d;
}
#advancedSplitUnitModal .regiment-column p {
    color: #ecf0f1;
}
/* Input para el nombre de la nueva unidad */
#advancedSplitUnitModal #newSplitUnitNameInput {
    background-color: #2c3e50;
    border: 1px solid #7f8c8d;
    color: #f1c40f;
    text-align: center;
}
/* Lista de regimientos en las columnas */
#advancedSplitUnitModal .regiments-list {
    border: 1px solid #7f8c8d;
}
#advancedSplitUnitModal .regiments-list li:hover {
    background-color: #4a5568; /* Resaltado al pasar el rat√≥n */
}
/* Iconos dentro de la lista de divisi√≥n */
#advancedSplitUnitModal .regiments-list li span.regiment-type {
    color: #ecf0f1;
}
/* Botones de acci√≥n del pie de p√°gina */
#advancedSplitUnitModal button {
    padding: 8px 16px;
    border-radius: 5px;
    border: none;
    color: white;
    font-weight: bold;
}
#advancedSplitUnitModal #finalizeAdvancedSplitBtn {
    background-color: #27ae60; /* Verde */
}
#advancedSplitUnitModal #cancelAdvancedSplitBtn {
    background-color: #7f8c8d; /* Gris */
}

/* nuevo set */ 

/* --- COMPRESI√ìN EXTREMA: MODAL DIVIDIR UNIDAD (Landscape 320px) --- */
@media (max-width: 768px) {
    /* 1. Forzar el modal a ocupar toda la pantalla sin bordes */
    #advancedSplitUnitModal .modal-content {
        width: 100vw !important;
        height: 100vh !important;
        max-width: 100vw !important;
        max-height: 100vh !important;
        margin: 0 !important;
        padding: 5px !important;
        display: flex !important;
        flex-direction: column !important;
        border: none !important;
    }

    /* 2. ELIMINAR T√çTULO, DESCRIPCI√ìN Y BOT√ìN CERRAR (Innecesarios en esta fase) */
    #advancedSplitUnitModal h3, 
    #advancedSplitUnitModal .close-button, 
    #advancedSplitUnitModal > p {
        display: none !important; 
    }

    /* 3. GRID DE DOS COLUMNAS (Lado a Lado) */
    .split-regiment-container {
        display: grid !important;
        grid-template-columns: 1fr 1fr !important;
        gap: 5px !important;
        height: 70% !important; /* Espacio para las listas */
        margin-top: 5px !important;
    }

    /* 4. LISTAS CON SCROLL (Para ver los 20 regimientos de 4 en 4) */
    #originalUnitRegimentsList, 
    #newUnitRegimentsList {
        flex-grow: 1 !important;
        overflow-y: auto !important;
        max-height: 140px !important; /* Altura ideal para 320px de pantalla */
        background: rgba(0,0,0,0.3) !important;
        border: 1px solid #4a5568 !important;
    }

    .regiments-list li {
        padding: 4px !important;
        font-size: 0.75em !important;
        border-bottom: 1px solid #333 !important;
    }

    /* Est√©tica de las columnas internas */
    .regiment-column {
        height: 100% !important;
        padding: 2px !important;
    }
    .regiment-column h4 { font-size: 0.8em !important; margin: 0 !important; }
    #newSplitUnitNameInput { height: 25px !important; font-size: 0.8em !important; }

    /* 5. BOTONES DE ACCI√ìN FIJOS ABAJO */
    #advancedSplitUnitModal div[style*="text-align: center"] {
        position: fixed !important;
        bottom: 5px !important;
        left: 0 !important;
        width: 100% !important;
        display: flex !important;
        justify-content: space-evenly !important;
        padding: 5px 0 !important;
        background: #1a2531 !important; /* Fondo para que no se mezcle con el mapa */
    }

    #advancedSplitUnitModal button {
        padding: 8px 15px !important;
        font-size: 1em !important;
        min-width: 45% !important;
        border-radius: 5px !important;
    }
}

/* ========================================================================== */
/* ==   18. CONSOLA DE DEPURACI√ìN (ESTILO RETRO RESTAURADO Y MEJORADO)      == */
/* ========================================================================== */

#debug-console {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 35%; /* Ocupa un poco m√°s de un tercio de la pantalla */
    
    background-color: rgba(10, 20, 15, 0.85); /* Negro verdoso muy oscuro y transl√∫cido */
    border-top: 2px solid rgba(0, 255, 127, 0.5); /* Borde superior verde ne√≥n */
    
    display: flex;
    flex-direction: column;
    font-family: 'Consolas', 'Lucida Console', 'Courier New', monospace; /* Fuente de terminal */
    
    /* Peque√±o efecto de resplandor para el texto, como en un monitor CRT */
    text-shadow: 0 0 3px rgba(57, 255, 20, 0.3);

    box-shadow: 0 -5px 15px rgba(0,0,0,0.4);
    z-index: 1000;
}

#console-output {
    flex-grow: 1; /* Ocupa todo el espacio disponible */
    overflow-y: auto;
    padding: 10px;
    font-size: 0.9em;
    color: #39FF14; /* Color verde ne√≥n base */
    scrollbar-width: thin;
    scrollbar-color: #39FF14 rgba(10, 20, 15, 0.85);
}

#console-output > div {
    margin-bottom: 5px;
    line-height: 1.4;
    word-break: break-word; /* Evita que el texto largo se desborde */
}

/* --- Colores por tipo de evento (como pediste) --- */
#console-output .log-info {
    color: #E0E0E0; /* Texto blanco/gris claro para logs generales */
}

#console-output .log-success {
    color: #00FF7F; /* Verde primavera para √©xitos */
}

#console-output .log-warning {
    color: #FFD700; /* Amarillo/Dorado para advertencias */
}

#console-output .log-error {
    color: #FF4500; /* Rojo anaranjado para errores */
    font-weight: bold;
}

#console-output .log-command {
    color: #87CEEB; /* Azul cielo para los comandos que se escriben */
    font-style: italic;
}


#console-input {
    width: 100%;
    padding: 8px 10px;
    box-sizing: border-box;
    
    background-color: #000;
    border: none;
    border-top: 1px solid rgba(0, 255, 127, 0.4);
    
    color: #39FF14; /* Texto de entrada tambi√©n verde */
    font-family: inherit; /* Hereda la fuente monoespaciada */
    font-size: 1em;
}

#console-input:focus {
    outline: none;
    background-color: #111;
}

/* ========================================================================== */
/* ==   NUEVO MEN√ö SUPERIOR (‚ò∞) - BARRA COMPACTA                           == */
/* ========================================================================== */

/* --- Barra Superior: Marca de Agua con Control de Bot√≥n --- */
.top-bar {
    position: fixed;
    top: 0; left: 0;
    width: 100%;
    height: 45px;
    /* Quitamos el !important para que el JS pueda ocultarla */
    display: flex; 
    flex-direction: row;
    justify-content: center; 
    pointer-events: none;
    z-index: 13000;
}

/* T√≠tulo: Marca de agua dorada muy suave */
#top-bar-phase-turn {
    position: absolute;
    left: 10px; top: 12px;
    font-size: 0.65em;
    font-weight: bold;
    color: rgba(241, 196, 15, 0.4); /* Dorado transl√∫cido */
    text-shadow: 1px 1px 1px rgba(0,0,0,0.5);
    pointer-events: none;
}

/* Paneles y Recursos: Siempre en fila */
.top-bar-panel, #top-bar-resources {
    display: flex;
    flex-direction: row;
    background: none !important;
    border: none !important;
    gap: 4px;
}

/* Los Picos: Fondo oscuro marca de agua y letra BLANCA */
.resource-item, 
.top-bar-actions-panel button, 
.top-bar-actions-panel .button-like-label {
    width: 42px;
    height: 40px;
    background-color: rgba(0, 0, 0, 0.4); 
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    clip-path: polygon(50% 0%, 100% 25%, 100% 100%, 0% 100%, 0% 25%);
    pointer-events: all;
    /* Color de iconos y botones: Blanco gris√°ceo transl√∫cido */
    color: rgba(236, 240, 241, 0.8) !important;
    border: none !important;
}

/* Valores: Dorado claro para que resalten sobre el verde/gris */
.resource-item strong {
    font-size: 0.65em;
    color: #f1c40f !important;
    margin-top: -2px;
    text-shadow: 1px 1px 1px black;
}

/* Panel de botones: Flota a la derecha */
.top-bar-actions-panel {
    position: absolute;
    right: 10px; top: 0;
}

/* Hover suave para los botones */
.top-bar-actions-panel button:hover {
    background-color: rgba(52, 152, 219, 0.5);
}

/* ========================================================================== */
/* ==   ESTILO DEL CAMINO                 == */
/* ========================================================================== */

/* Esta regla dibuja la capa marr√≥n con la forma hexagonal correcta */
#gameBoard .hex.structure-Camino::after {
    content: ''; 
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    /* FORZAMOS la forma hexagonal para que no dependa de herencia */
    clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
    background-color: rgba(139, 69, 19, 0.6); /* Marr√≥n semi-transparente */
    z-index: 1; 
    pointer-events: none;
}

/* Esta regla se asegura de OCULTAR SIEMPRE el emoji del camino */
#gameBoard .hex.structure-Camino .structure-sprite {
    display: none !important;
}

/* ========================================================================== */
/* ==   OPTIMIZACI√ìN MODAL DE UNIDADES (‚ûï)     == */
/* ========================================================================== */

/* ========================================================================== */
/* ==   CORRECCI√ìN MODAL DE UNIDADES (M√ìVIL-FIRST Y PRECISO)              == */
/* ========================================================================== */
/* ========================================================================== */
/* ==   SOLUCI√ìN MODAL DE UNIDADES (ENFOQUE PRECISO Y DEFINITIVO)           == */
/* ========================================================================== */
/* ========================================================================== */
/* ==   SOLUCI√ìN MODAL UNIDADES (ENFOQUE EQUILIBRADO Y CORRECTO)            == */
/* ========================================================================== */

/* ========================================================================== */
/* ==   SOLUCI√ìN DEFINITIVA: MODAL DE UNIDADES (ESTRUCTURA PROFESIONAL)    == */
/* ========================================================================== */

/* ========================================================================== */
/* ==   SOLUCI√ìN MINUCIOSA Y FINAL: Solo los 2 cambios solicitados         == */
/* ========================================================================== */

/* ========================================================================== */
/* ==   SOLUCI√ìN FINAL Y MINUCIOSA (v. Correcta)                             == */
/* ==   Aplicando solo los 2 cambios solicitados y corrigiendo mis errores.  == */
/* ========================================================================== */

/* ========================================================================== */
/* ==   SOLUCI√ìN FINAL, CUIDADOSA Y CORRECTA PARA EL MODAL DE UNIDADES      == */
/* ========================================================================== */

/* --- 1. CONTENEDOR PRINCIPAL: El marco del modal. --- */
/* Su √∫nica funci√≥n es definir el tama√±o m√°ximo y ser un contenedor flex vertical. */
#unitManagementModal .modal-content {
    width: 95vw;
    max-width: 600px;
    max-height: 90vh; /* L√≠mite M√ÅXIMO de altura. No crecer√° m√°s que esto. */

    display: flex;
    flex-direction: column; /* Apila T√≠tulo, Cuerpo y Pie de p√°gina. */
    
    overflow: hidden; /* IMPIDE que el propio modal tenga un scroll general. */
    
    background-color: #2c3e50;
    font-size: 0.9em;
    position: relative;
    padding: 0;
    border-radius: 8px;
}

/* --- 2. T√çTULO Y PIE DE P√ÅGINA: Secciones fijas. --- */
/* Nunca se encogen y siempre est√°n visibles. */
#unitManagementModal h3,
#unitManagementModal .modal-footer-actions {
    flex-shrink: 0;
}
/* Estilo del bot√≥n de cerrar (corregido) */
#unitManagementModal .close-button {
    position: absolute;
    top: 10px; right: 15px; z-index: 10;
}

/* --- 3. CUERPO: La √∫nica secci√≥n que puede hacer scroll. --- */
/* Se estira para llenar el espacio entre el t√≠tulo y el pie de p√°gina. */
#unitManagementModal .unit-management-body {
    flex-grow: 1; /* Le dice al cuerpo que ocupe todo el espacio vertical disponible. */
    overflow-y: auto; /* ¬°AQU√ç EST√Å LA √öNICA BARRA DE SCROLL! */

    display: flex; /* Mantiene el layout de 2 columnas para los paneles. */
    min-height: 0; /* Un truco de Flexbox para que funcione bien en todos los navegadores. */
}

/* --- 4. PANELES: Ya no necesitan scroll ni alturas m√°ximas. --- */
/* Simplemente crecen lo que necesiten dentro de su padre con scroll. */
#unitManagementModal .unit-selection-panel,
#unitManagementModal .division-summary-panel {
    flex: 1; /* Ocupan 50% del ancho. */
    height: auto;
    overflow: visible;
    padding: 10px;

    /* CORRECCI√ìN DE FONDOS */
    background-color: transparent; /* El panel izquierdo es transparente. */
}
#unitManagementModal .division-summary-panel {
    background-color: #212f3d; /* El derecho tiene su propio fondo oscuro. */
}

/* --- 5. Las listas internas. --- */
/* Ya no necesitan NINGUNA regla de altura o scroll. */
#unitManagementModal .available-units-list,
#unitManagementModal #divisionCompositionList {
    height: auto;
    max-height: none;
    flex-grow: 1;       /* Ocupa el espacio vertical sobrante. */
    overflow-y: auto;   /* Muestra un scroll si la lista es muy larga. */
    min-height: 0;      /* Truco de flexbox para asegurar que se comporte bien. */
    
    /* Le a√±adimos un estilo visual consistente con el panel derecho. */
    border: 1px solid #7f8c8d;
    background-color: #34495e;
    border-radius: 4px;
    margin-top: 10px;
    padding: 5px;
}

/* Esta regla es para el panel izquierdo (reduce el espacio de cada l√≠nea) */
#unitManagementModal .unit-entry {
    padding: 2px 2px;
}

/* 1. Convertimos el panel izquierdo en una columna flexible. */
#unitManagementModal .unit-selection-panel {
    display: flex;
    flex-direction: column;
}

/* panel Derecho, Cada item de la lista (icono y cantidad) */
#unitManagementModal .compact-composition-list li {
    display: flex;
    align-items: center;
    font-size: 1em;
    padding: 1px 1px;
    background-color: rgba(44, 62, 80, 0.7);
    border-radius: 2px;
    margin-bottom: 2px;
}

/* 1. Hacemos que el panel derecho sea una columna flex para controlar su contenido. */
#unitManagementModal .division-summary-panel {
    display: flex;
    flex-direction: column;
}

/* 2. Hacemos que la lista de unidades sea la √öNICA que se estire y tenga scroll. */
#unitManagementModal #divisionCompositionList {
    flex-grow: 1;      /* La lista ocupa todo el espacio vertical sobrante DENTRO del panel. */
    overflow-y: auto;  /* Si la lista crece, ella misma tendr√° scroll. */
    min-height: 50px;  /* Le damos una altura m√≠nima para que no desaparezca si est√° vac√≠a. */
    
    /* Peque√±os ajustes visuales para el contenedor de la lista */
    border: 1px solid #7f8c8d;
    background-color: #34495e;
    border-radius: 4px;
    margin: 10px 0;
    padding: 5px;
}

/* --- 6. Iconos y Fuentes (revisado para ser correcto) --- */
#unitManagementModal .compact-composition-list .regiment-icon-emoji {
    font-size: 1.4em;
    line-height: 1;
}
#unitManagementModal .compact-composition-list .regiment-icon-image {
    width: 24px;
    height: 24px;
}
#unitManagementModal .summary-details {
    margin-top: auto; /* Mantiene el resumen pegado abajo. */
}

/* ========================================================================== */
/* ==   DISE√ëO ADAPTABLE R√ÅPIDO PARA M√ìVILES (CUARTEL, DESEOS, FORJA)      == */
/* ========================================================================== */

/* Esta regla se aplica a pantallas de 620px de ancho o menos (tablets y m√≥viles) */
@media (max-width: 620px) {

    /* --- REGLA GENERAL PARA TODOS LOS MODALES EN M√ìVIL --- */
    /* Hacemos que los modales ocupen casi toda la pantalla y reducimos su padding. */
    .modal-themed .modal-content {
        width: 95vw !important;
        max-width: 95vw !important;
        max-height: 85vh !important;
        padding: 10px !important;
    }

    /* --- 1. SOLUCI√ìN PARA EL CUARTEL DE H√âROES --- */
    #barracksModal .hero-collection-grid {
        background-color: #34495e; /* Fondo azul oscuro */
        grid-template-columns: repeat(auto-fill, minmax(90px, 1fr)); /* Tarjetas m√°s peque√±as para ver m√°s */
        gap: 10px;
    }

    .hero-card {
        background-color: #2c3e50; /* Fondo de tarjeta oscuro */
        border: 1px solid #7f8c8d;
        color: #ecf0f1;
        padding: 5px 2px;
    }

    .hero-card:hover {
        background-color: #3d566e;
        border-color: #f1c40f; /* Brillo dorado al pasar el dedo/rat√≥n */
    }

    .hero-card-image {
        width: 50px !important; /* Imagen un poco m√°s peque√±a */
        height: 50px !important;
        margin-bottom: 2px;
    }

    .hero-card .hero-name {
        font-size: 0.7em;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis; /* Evita que nombres largos rompan la tarjeta */
    }

    .hero-fragments-progress {
        font-size: 0.7em;
        margin-top: 2px;
    }

    /* Estado bloqueado m√°s acorde al tema oscuro */
    .hero-card.is-locked {
        background-color: #1f2b38;
        opacity: 0.6;
    }

    /* Reducimos el tama√±o de la imagen y las fuentes dentro de cada tarjeta */
    #barracksModal .hero-card-image {
        width: 60px;
        height: 60px;
    }
    #barracksModal .hero-name {
        font-size: 0.9em;
    }
    #barracksModal .hero-level {
        font-size: 0.8em;
    }


    /* --- 2. SOLUCI√ìN PARA EL ALTAR DE LOS DESEOS --- */
    #deseosModal .wish-actions {
        /* Apila los dos botones grandes verticalmente en lugar de uno al lado del otro */
        flex-direction: column;
    }
    #deseosModal h2 { font-size: 1.5em; } /* T√≠tulo m√°s peque√±o */
    #deseosModal p { font-size: 0.9em; } /* Texto m√°s peque√±o */


    /* --- 3. SOLUCI√ìN PARA LA FORJA --- */
    #forgeModal .forge-container {
        /* Apila las dos columnas (lista y detalles) verticalmente */
        flex-direction: column;
        height: auto; /* Permitimos que la altura crezca lo necesario */
        max-height: 70vh; /* Pero limitamos su altura total */
    }

    #forgeModal .blueprint-list {
        /* Damos una altura fija a la lista de planos para que no ocupe toda la pantalla */
        max-height: 200px; /* O unos 25vh, como prefieras */
        flex-shrink: 0; /* Evita que se encoja */
    }

    /* --- 4. SOLUCI√ìN PARA PANTALLA DE CONSTRUCCI√ìN --- */
    /* Reducir tama√±o en tel√©fono para permitir cerrar c√≥modamente */
    #buildStructureModal .modal-content {
        width: 100%;
        max-width: 320px !important;
        max-height: 320px !important;
        padding: 12px !important;
        margin: auto;
    }

    #buildStructureModal .modal-header {
        padding: 8px 12px !important;
    }

    #buildStructureModal .modal-header h3 {
        font-size: 1em !important;
        margin: 0 !important;
    }

    #buildStructureModal .modal-body {
        padding: 8px 0 !important;
        max-height: 200px !important;
        overflow-y: auto !important;
        flex-grow: 1;
    }

    #buildStructureModal #availableStructuresList {
        margin: 0 !important;
        padding: 0 !important;
    }

    #buildStructureModal #availableStructuresList li {
        padding: 6px 8px !important;
        font-size: 0.85em !important;
        margin: 2px 0 !important;
    }

    #buildStructureModal .modal-footer {
        padding: 8px 12px !important;
    }

    #buildStructureModal #confirmBuildBtn {
        padding: 8px 12px !important;
        font-size: 0.9em !important;
        width: 100%;
    }
}

/* ========================================================================== */
/* ==   DISE√ëO ADAPTABLE M√ìVIL (V6 - VERSI√ìN CORREGIDA Y FINAL)              == */
/* ========================================================================== */

@media (max-width: 768px) {

    /* --- CONTENEDOR PRINCIPAL: Flex vertical para anclar el footer --- */
    .modal-themed .modal-content {
       /* width: 98vw !important;
        max-width: 98vw !important;*/
        height: 95vh !important;
        padding: 5px !important;
        display: flex;
        flex-direction: column;
    }

    #heroDetailModal .close-button { position: absolute; top: 5px; right: 10px; z-index: 10; }
    #heroDetailModal h2 { display: none; }


    /* --- LAYOUT PRINCIPAL: Columnas con tama√±o m√°s controlado --- */
    #heroDetailModal .hero-main-layout {
        /* ¬°LA SOLUCI√ìN A LA COLUMNA ANCHA! La columna de equipo ahora tiene un tama√±o m√°s fijo. */
        grid-template-columns: 1fr 1fr 0.8fr;
        gap: 5px;
        align-items: center; /* Volvemos a centrar verticalmente, se ve mejor */
    }

    #heroDetailModal .hero-main-layout .hero-column { padding: 0 3px; }


    /* --- HABILIDADES: Restaurado el layout 2x2 --- */
    #heroDetailModal .skills-list {
        display: grid; /* ¬°LA REGLA QUE HAB√çA QUITADO! */
        grid-template-columns: 1fr 1fr;
        gap: 5px;
    }

    /* Refinamos el tama√±o de las habilidades para que encajen bien */
    #heroDetailModal .skill-item-rok { margin-bottom: 0; flex-direction: column; align-items: center; gap: 2px; }
    #heroDetailModal .skill-item-rok .skill-icon { width: 40px; height: 40px; font-size: 20px; }
    #heroDetailModal .skill-item-rok .skill-level { width: 18px; height: 18px; line-height: 18px; font-size: 0.7em; }
    #heroDetailModal .skill-item-rok .skill-info h5 { font-size: 0.75em; text-align: center; }
    #heroDetailModal .skill-item-rok .skill-info p { display: none; }


    /* --- PANEL CENTRAL (Mantenemos la reducci√≥n de tama√±o) --- */
    #heroDetailModal .hero-center-column { font-size: 0.7em; }
    #heroDetailModal #hero-portrait-container { width: 55px; height: 55px; }
    #heroDetailModal .hero-name-title { margin-bottom: 4px; }
    #heroDetailModal .hero-name-title h2 { font-size: 1em; margin: 0; }
    #heroDetailModal .hero-name-title p { display: none; }
    #heroDetailModal .progress-item { margin-bottom: 4px; }
    #heroDetailModal .xp-bar-container { height: 10px; background-color: #1f2b38;
    border: 1px solid #7f8c8d;}


    /* --- EQUIPO (Mantenemos la reducci√≥n de tama√±o) --- */
    #heroDetailModal .equipment-layout { gap: 3px; font-size: 0.7em; }
    #heroDetailModal .equipment-slot { height: 35px; }
    #heroDetailModal .equip-row-middle { gap: 3px; }
    #heroDetailModal #equip-chest, #heroDetailModal #equip-legs { width: 35px; }


    /* --- FOOTER ANCLADO ABAJO (Sin cambios, sigue siendo la clave) --- */
    #heroDetailModal .hero-detail-footer {
        margin-top: auto;
        padding-top: 5px;
        border-top: 1px solid #7f8c8d;
        flex-wrap: wrap;
        justify-content: center;
        gap: 8px;
    }
}

 /* ========================================================================== */
/* ==   DISE√ëO ADAPTABLE (SOLUCI√ìN EXCLUSIVA PARA PANTALLA DE TALENTOS)      == */
/* ========================================================================== */

/* Dentro de @media (max-width: 768px) { ... } */

    /* --- AJUSTE DE ANCHO PARA LA PANTALLA DE TALENTOS --- */
    
    #talentTreeModal .modal-content {
        /*
        Hacemos la ventana de talentos m√°s estrecha.
        width: 90vw !important;              <-- La regla original de tu CSS que lo hace ancho.
        */
        width: 98vw !important; /* Mantenemos el ancho para tener espacio para el √°rbol */
        max-width: 98vw !important; /* Forzamos a que nunca sea m√°s ancho */
        height: 90vh !important;
        padding: 8px !important;
    }

    /* Y hacemos que su encabezado sea flexible para que no se rompa en pantallas peque√±as */
    #talentTreeModal .talent-modal-header {
        flex-wrap: wrap;
        justify-content: center;
        gap: 10px;
        padding-bottom: 8px;
    }

    #talentTreeModal .talent-modal-header h2 {
        width: 100%;
        text-align: center;
        font-size: 1.1em;
        margin: 0;
    }

    #talentTreeModal .talent-points-counter,
    #talentTreeModal #resetTalentsBtn {
        font-size: 0.9em;
    }
    /*-------------------------*/
    @media (max-width: 768px) {

    /* ... aqu√≠ van todas tus otras reglas para #heroDetailModal, #skillDetailModal, etc. ... */
    
    
    /* --- SOLUCI√ìN PARA LA PANTALLA DE TALENTOS (CON MOVIMIENTO Y ZOOM) --- */
    
    /* 1. Mantenemos el contenedor principal con scroll, como debe ser. */
    #talentCanvasContainer {
        overflow: auto; /* ¬°RECUPERAMOS EL MOVIMIENTO! */

        /* IMPORTANTE: Le damos una pista al navegador para que el zoom por pellizco funcione bien. */
        touch-action: pan-x pan-y;
    }

    /* 2. Reducimos el tama√±o del lienzo, PERO NO TANTO. */
    #talentTreeModal .talent-tree-canvas {
        /* Tama√±o reducido a la mitad (1500px -> 750px). Es un buen punto intermedio. */
        width: 750px;
        height: 750px;

        /* ESCALAMOS EL CONTENIDO a la mitad, no a 1/3. As√≠ sigue siendo legible. */
        transform: scale(0.5);
        
        transform-origin: top left;
    }

    /* 3. Nos aseguramos de que el modal de talentos aproveche bien la pantalla. */
    #talentTreeModal .modal-content {
        width: 100vw !important;  /* Usamos todo el ancho de la pantalla */
        height: 100vh !important; /* Y casi todo el alto */
        padding: 5px !important;  /* Con un padding m√≠nimo */
    }
}

/* ========================================================================== */
/* ==   DISE√ëO ADAPTABLE (V10 - COMPACTACI√ìN VERTICAL AGRESIVA)            == */
/* ========================================================================== */

/* Dentro de @media (max-width: 768px) { ... } */

    /* --- SOLUCI√ìN PARA LA PANTALLA DE HABILIDADES (Miniaturizaci√≥n Extrema) --- */

    #skillDetailModal .skill-detail-content {
        width: auto !important;
        max-width: 500px !important;
        padding: 8px;
    }

    /* ¬°CLAVE 1: REINICIO GLOBAL DE ESPACIOS PARA TODOS LOS HIJOS DEL MODAL! */
    #skillDetailModal .skill-detail-content * {
        margin: 0 !important;      /* Elimina TODOS los m√°rgenes de todos los elementos internos. */
        line-height: 1.1 !important; /* Forza un interlineado s√∫per compacto. */
    }

    /* Ahora aplicamos peque√±os espacios SOLO donde los necesitamos */
    
    #skillDetailModal .skill-detail-header {
        display: flex;
        align-items: center;
        gap: 8px;
        padding-bottom: 5px; /* Un poco de espacio antes de la l√≠nea */
        margin-bottom: 5px !important; /* Un poco de espacio despu√©s de la l√≠nea */
        border-bottom: 1px solid #dee2e6;
    }

    #skillDetailModal .skill-detail-header .skill-icon {
        width: 35px;
        height: 35px;
        font-size: 18px;
    }

    #skillDetailModal .skill-detail-header h3,
    #skillDetailModal .skill-detail-header p {
        font-size: 0.8em;
    }

    #skillDetailModal .skill-detail-body p {
        font-size: 0.8em;
        margin-bottom: 5px !important; /* Espacio despu√©s de la descripci√≥n */
    }

    #skillDetailModal .skill-detail-body h4 {
        font-size: 0.9em;
        margin-bottom: 4px !important; /* Espacio antes de la lista de niveles */
    }

    /* ¬°CLAVE 2: LA LISTA DE NIVELES S√öPER COMPACTA! */
    #skillDetailModal #skillLevelPreview .level-row {
        font-size: 0.75em;
        padding: 1px 3px !important; /* Padding m√≠nimo */
        margin-bottom: 1px !important; /* Separaci√≥n m√≠nima entre l√≠neas */
    }

    #skillDetailModal .skill-detail-footer {
        margin-top: 8px !important; /* Espacio antes del footer */
        padding-top: 5px !important;
        border-top: 1px solid #dee2e6;
        display: flex;
        flex-direction: column;
        align-items: stretch;
        gap: 5px;
    }

    #skillDetailModal #upgradeSkillBtn {
        font-size: 0.9em;
        padding: 5px;
    }

   /* ========================================================================== */
/* ==   DISE√ëO ADAPTABLE (V15 - FORJA INTELIGENTE Y COMPACTA PARA M√ìVIL)    == */
/* ========================================================================== */

/* Dentro de @media (max-width: 768px) { ... } */

    /* --- SOLUCI√ìN PARA LA FORJA (Redise√±o Compacto) --- */

    /* 1. OCULTAMOS ELEMENTOS REDUNDANTES Y PREPARAMOS EL MODAL */
    #forgeModal h2,
    #forgeModal > p {
        display: none; /* Ocultamos el t√≠tulo "Forja del General" y la descripci√≥n. */
    }
    #forgeModal .close-button {
        position: absolute;
        top: 8px; right: 10px; z-index: 10;
        transform: scale(0.9);
    }
    #forgeModal .forge-container {
        flex-direction: row;
        gap: 8px;
        height: 100%; /* El contenedor ahora usa toda la altura del modal */
    }


    /* --- 2. PANEL IZQUIERDO: REDISE√ëO A "ICONO + DOS L√çNEAS" --- */
    #forgeModal .blueprint-list {
        padding: 5px;
        flex: 1.2; /* Damos un poco m√°s de espacio a la lista */
        overflow-y: auto; /* Nos aseguramos de que tenga scroll */
    }
    #forgeModal .blueprint-item {
        display: grid; /* ¬°LA CLAVE! Usamos grid para un control preciso. */
        grid-template-columns: auto 1fr; /* Columna para el icono, y el resto para el texto. */
        grid-template-rows: auto auto;    /* Dos filas para el texto. */
        grid-template-areas:
            "icon name"
            "icon progress";
        align-items: center;
        gap: 0 8px; /* Espacio solo entre columnas, no entre filas. */
        padding: 4px;
        text-align: left; /* Alineamos el texto a la izquierda. */
    }
    #forgeModal .blueprint-item.selected {
        background-color: #4a5568;
    }

    #forgeModal .blueprint-item .item-icon {
        grid-area: icon;
        font-size: 2em;
        margin: 0;
    }
    #forgeModal .blueprint-item .item-info .item-name {
        grid-area: name;
        font-size: 0.9em;
    }
    #forgeModal .blueprint-item .item-info .item-progress {
        grid-area: progress;
        font-size: 0.75em;
    }

    /* Ocultamos el contenedor original de la info de texto, ya que grid lo controla todo. */
    #forgeModal .blueprint-item .item-info {
        display: contents; /* Le decimos al navegador que ignore esta caja. */
    }


    /* --- 3. PANEL DERECHO: SIMPLIFICADO AL M√ÅXIMO --- */
    #forgeModal .blueprint-detail {
        padding: 8px;
        flex: 1; /* Le damos un poco menos de espacio que a la lista */
        display: flex; /* Lo convertimos en columna flex para controlar el contenido. */
        flex-direction: column;
        justify-content: center; /* Centramos verticalmente lo que queda. */
        gap: 15px; /* Espacio generoso entre los 3 elementos. */
    }

    /* Ocultamos el icono y el nombre, que ya est√°n visibles en la selecci√≥n. */
    #forgeModal #blueprintItemIcon,
    #forgeModal #blueprintItemName,
    #forgeModal hr,
    #forgeModal h4 {
        display: none !important;
    }

    #forgeModal #blueprintItemStats {
        text-align: center;
        font-size: 0.9em;
        font-style: normal; /* Le quitamos la cursiva. */
        font-weight: bold;
    }
    
    #forgeModal #forgeItemBtn {
        font-size: 1em;
        padding: 10px;
        margin: 0; /* Quitamos cualquier margen que interfiera. */
    }

    /* ========================================================================== */
/* ==   NUEVO DISE√ëO PARA EL ALTAR DE LOS DESEOS (GACHA)                   == */
/* ========================================================================== */

.gacha-main-layout {
    display: grid;
    grid-template-columns: 250px 1fr 220px; /* Izquierda | Centro (flexible) | Derecha */
    gap: 15px;
    height: 100%;
    padding-top: 20px;
}

.gacha-column {
    background-color: rgba(0, 0, 0, 0.3);
    border: 1px solid #7f8c8d;
    border-radius: 8px;
    padding: 15px;
    display: flex;
    flex-direction: column;
}

.gacha-column h3 {
    text-align: center;
    margin-top: 0;
    margin-bottom: 10px;
    color: #f1c40f;
    font-size: 1.2em;
}

/* --- Columna de Historial --- */
#gacha-history-list {
    list-style: none;
    padding: 0;
    margin: 0;
    flex-grow: 1;
    overflow-y: auto;
    font-size: 0.85em;
}
.history-item {
    padding: 4px 8px;
    border-radius: 4px;
    margin-bottom: 3px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
.history-item-placeholder { color: #95a5a6; }
.history-item.rarity-raro { background-color: rgba(0, 123, 255, 0.2); border-left: 3px solid #007bff; }
.history-item.rarity-epico { background-color: rgba(138, 43, 226, 0.2); border-left: 3px solid #8a2be2; }
.history-item.rarity-legendario { background-color: rgba(253, 126, 20, 0.2); border-left: 3px solid #fd7e14; font-weight: bold;}
.history-item.crit { color: #f1c40f; font-weight: bold; }


/* --- Columna de Animaci√≥n --- */
.gacha-animation-column { justify-content: center; align-items: center; }
#gacha-reveal-area {
    width: 100%;
    height: 200px;
    display: flex;
    justify-content: center;
    align-items: center;
    perspective: 1000px;
}
.reveal-placeholder { text-align: center; color: #95a5a6; }
.placeholder-icon { font-size: 3em; opacity: 0.5; }

/* La "carta" que se anima */
.gacha-reveal-card {
    width: 150px;
    height: 180px;
    position: relative;
    transform-style: preserve-3d;
    transition: transform 0.6s;
    animation: fadeIn-gacha 0.3s ease-out;
}
.gacha-reveal-card.is-flipped { transform: rotateY(180deg); }

.card-face {
    position: absolute;
    width: 100%; height: 100%;
    backface-visibility: hidden;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.4);
}
.card-back {
    background: linear-gradient(145deg, #4a5568, #2c3e50);
    border: 2px solid #95a5a6;
    display: flex; justify-content: center; align-items: center; font-size: 4em;
    color: #f1c40f;
}
.card-front {
    background-color: #34495e;
    transform: rotateY(180deg);
    padding: 10px;
    text-align: center;
    display: flex; flex-direction: column; justify-content: center; align-items: center;
}
.card-front-icon { font-size: 3em; margin-bottom: 5px; }
.card-front-text { font-weight: bold; }
.card-front-amount { font-size: 0.9em; color: #bdc3c7; }

/* Bordes por rareza */
.card-front.rarity-comun { border: 3px solid #adb5bd; }
.card-front.rarity-raro { border: 3px solid #007bff; box-shadow: 0 0 10px #007bff; }
.card-front.rarity-epico { border: 3px solid #8a2be2; box-shadow: 0 0 15px #8a2be2; }
.card-front.rarity-legendario { border: 3px solid #fd7e14; box-shadow: 0 0 20px #fd7e14; }

@keyframes fadeIn-gacha { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }

/* --- Columna de Acciones --- */
.gacha-actions-column { justify-content: center; text-align: center; }
.gacha-actions-column p { font-size: 1.1em; }
.gacha-actions-column #gacha-sellos-count { color: #f1c40f; }

.gacha-button {
    width: 100%;
    padding: 15px 10px;
    margin-top: 15px;
    border-radius: 8px;
    border: 1px solid #95a5a6;
    background-color: #34495e;
    color: #ecf0f1;
    cursor: pointer;
    transition: all 0.2s ease;
}
.gacha-button:hover:not(:disabled) { background-color: #4a5568; transform: translateY(-2px); }
.gacha-button:disabled { opacity: 0.5; cursor: not-allowed; }

.gacha-button .button-main-text { font-size: 1.1em; font-weight: bold; }
.gacha-button .button-cost { display: block; font-size: 0.9em; opacity: 0.8; }
.gacha-button.pull-10 { border-color: #27ae60; background-color: #2c5a41; }

/* --- DISE√ëO ADAPTABLE PARA M√ìVILES --- */
@media (max-width: 768px) {
    .gacha-main-layout {
        grid-template-columns: 1fr; /* Apilamos las columnas */
        grid-template-rows: auto 1fr auto; /* Damos m√°s espacio a la animaci√≥n */
        height: auto;
    }
    #gacha-history-list {
        max-height: 120px; /* Limitamos la altura del historial */
    }
}

/* ========================================================================== */
/* ==   DISE√ëO ADAPTABLE (V16 - MINIATURIZAR PANTALLA DE DESEOS)            == */
/* ========================================================================== */

/* Dentro de @media (max-width: 768px) { ... } */
    
    /* --- SOLUCI√ìN PARA EL ALTAR DE LOS DESEOS (Miniaturizado al 40%) --- */

    /* Forzamos al modal a ser un poco m√°s alto para que quepan las 3 columnas */
    #deseosModal .modal-content {
        height: 280px !important;
    }

    /* Reducimos las 3 columnas y el espacio entre ellas */
    #deseosModal .gacha-main-layout {
        /* Proporciones: 1 (historial), 1 (animaci√≥n), 0.8 (botones) */
        grid-template-columns: 1fr 1fr 0.8fr; 
        gap: 8px;
        padding-top: 15px;
    }

    #deseosModal .gacha-column {
        padding: 8px; /* Padding m√°s peque√±o */
    }

    /* Reducimos la fuente de todos los t√≠tulos */
    #deseosModal .gacha-column h3 {
        font-size: 0.9em;
        margin-bottom: 5px;
    }

    /* --- Miniaturizar Historial (Columna Izquierda) --- */
    #deseosModal #gacha-history-list {
        font-size: 0.7em; /* Letra muy peque√±a */
    }

    /* --- Miniaturizar Animaci√≥n (Columna Central) --- */
    #deseosModal #gacha-reveal-area {
        height: auto;
    }
    #deseosModal .gacha-reveal-card {
        width: 100px; /* Tarjeta un 33% m√°s peque√±a */
        height: 120px;
        transform: scale(0.9); /* Un truco extra para encogerla un poco m√°s */
    }
    #deseosModal .card-front-icon { font-size: 2em; } /* Icono de premio m√°s peque√±o */
    #deseosModal .card-front-icon img { width: 35px !important; height: 35px !important; }
    #deseosModal .card-front-text { font-size: 0.9em; }
    #deseosModal .card-front-amount { font-size: 0.8em; }


    /* --- Miniaturizar Acciones (Columna Derecha) --- */
    #deseosModal .gacha-actions-column p {
        font-size: 0.9em; /* Texto de "Sellos de Guerra" */
    }
    #deseosModal .gacha-button {
        padding: 8px 5px; /* Botones m√°s delgados */
        margin-top: 10px;
    }
    #deseosModal .gacha-button .button-main-text {
        font-size: 0.9em; /* Texto principal del bot√≥n */
    }
    #deseosModal .gacha-button .button-cost {
        font-size: 0.75em; /* Coste en sellos */
    }

    /* Ocultamos el apilamiento que definimos antes. Ya no es necesario. */
    .gacha-main-layout {
        grid-template-rows: none;
    }

    /* --- 1. ESTILO PARA PANTALLA GRANDE (ESCRITORIO) --- */

/* Hacemos la "carta" mucho m√°s grande */
.gacha-reveal-card {
    width: 200px;
    height: 240px;
}

/* Aumentamos el tama√±o del icono/emoji dentro de la carta */
.card-front-icon {
    font-size: 5em; /* Antes era 3em */
    margin-bottom: 10px;
}

/*imagen <img> sea el triple de grande. */

/* --- 1. ESTILO PARA PANTALLA GRANDE (ESCRITORIO) --- */

.gacha-reveal-card {
    width: 200px;
    height: 240px;
}

.card-front-icon {
    font-size: 5em;
    margin-bottom: 10px;
}

/* Esta es la regla que AHORA S√ç va a funcionar */
.card-front-icon img {
    width: 150px;
    height: 150px;
    border-radius: 10px; /* Un poco de borde redondeado */
}


/* --- 2. AJUSTE PARA M√ìVILES --- */
@media (max-width: 768px) {
    
    #deseosModal .gacha-reveal-card {
        width: 120px;
        height: 140px;
    }
    
    #deseosModal .card-front-icon {
        font-size: 1em;
    }
    
    /* Y esta es la regla que funcionar√° en m√≥vil */
    #deseosModal .card-front-icon img {
        width: 60px;
        height: 60px;
    }
}

/* ========================================================================== */
/* ==   DISE√ëO ADAPTABLE (V19 - SOLUCI√ìN FINAL√çSIMA PARA LA IMAGEN)          == */
/* ========================================================================== */

/* --- TAMA√ëO DE LA 'CARTA' EN ESCRITORIO (SE MANTIENE) --- */
.gacha-reveal-card {
    width: 200px;
    height: 240px;
}
.card-front-icon { font-size: 5em; margin-bottom: 10px; }

/* --- TAMA√ëO DE LA IMAGEN DENTRO DE LA CARTA EN ESCRITORIO (LA SOLUCI√ìN) --- */
.card-front-icon img {
    /* Usamos !important para romper el "candado" de la regla anterior que yo puse. */
    width: 90px !important;
    height: 90px !important;
    border-radius: 10px;
    font-size: initial !important;
}

/* --- AJUSTES PARA M√ìVILES (CON LA SOLUCI√ìN) --- */
@media (max-width: 768px) {
    #deseosModal .gacha-reveal-card {
        width: 120px;
        height: 140px;
    }
    #deseosModal .card-front-icon img {
        /* Tambi√©n usamos !important aqu√≠ para asegurar que funcione en m√≥vil. */
        width: 60px !important;
        height: 60px !important;
    }
    #deseosModal .card-front-icon { font-size: 3.5em; }
}

/* ================================================================= */
/* ==   AJUSTE FINAL DE ALTURA Y 'X' PARA EL ALTAR DE LOS DESEOS  == */
/* ================================================================= */

/* Dentro de @media (max-width: 768px) { ... } */

    /* Forzamos al modal a ser un contenedor "relativo" para poder posicionar la 'X' */
    #deseosModal .modal-content {
        position: relative;
    }

    /* Sacamos la 'X' del flujo para que no ocupe espacio y reducimos la altura */
    #deseosModal .close-button {
        position: absolute;
        top: 8px;
        right: 12px;
        z-index: 10;
    }

    /* ========================================================================== */
/* ==   DISE√ëO ADAPTABLE (V20 - MINIATURIZAR PANTALLA DE GESTI√ìN üí™)         == */
/* ========================================================================== */

/* Dentro de @media (max-width: 768px) { ... } */

    /* --- SOLUCI√ìN PARA LA PANTALLA DE GESTI√ìN DE DIVISI√ìN (üí™) --- */

    /* 1. Reducimos el tama√±o general del modal y la fuente base. */
    #unitDetailModal .modal-content {
        width: 95vw !important;
        max-width: 360px !important; /* Hacemos la ventana mucho m√°s estrecha. */
        max-height: 90vh !important;
        font-size: 0.85em; /* Reducimos todo el texto un 15%. */
        padding: 10px !important;
    }

    /* 2. Compactamos el encabezado y el bloque de estad√≠sticas principales. */
    #unitDetailModal h3 {
        font-size: 1.2em;
        margin-bottom: 10px;
    }
    #unitDetailModal .unit-main-stats {
        padding: 8px;
        margin-bottom: 10px;
        gap: 5px; /* Reducimos el espacio entre las filas de stats */
    }
    #unitDetailModal .stat-row {
        padding: 2px 0; /* Hacemos las filas m√°s delgadas. */
    }
    #unitDetailModal .unit-total-health-bar-container {
        height: 16px; /* Barra de vida principal m√°s fina. */
    }

    /* 3. Hacemos la lista de regimientos y sus elementos internos mucho m√°s peque√±os. */
    #unitDetailModal .regiment-section-title {
        font-size: 0.9em;
        margin-bottom: 5px;
    }
    #unitDetailModal .detailed-regiments-list .regiment-detail-item {
        padding: 6px 8px; /* Filas de la lista m√°s delgadas. */
        gap: 8px;
    }
    #unitDetailModal .detailed-regiments-list .regiment-icon {
        font-size: 1.2em; /* Iconos m√°s peque√±os. */
        margin-right: 5px;
    }
    #unitDetailModal .detailed-regiments-list .regiment-health-bar-container {
        height: 10px; /* Barras de vida individuales m√°s finas. */
    }
    #unitDetailModal .detailed-regiments-list .regiment-health-text {
        font-size: 0.9em;
    }
    #unitDetailModal .reinforce-regiment-btn {
        padding: 3px 6px; /* Bot√≥n de reforzar m√°s peque√±o. */
        font-size: 0.9em;
    }
    /* ========================================================== */
/* ==   NUEVO: CONTADOR DE TIEMPO POR TURNO                 == */
/* ========================================================== */

.turn-timer-display {
    position: fixed; /* Lo fija en la ventana del navegador */
    top: 15px;
    right: 15px;
    
    background-color: rgba(0, 0, 0, 0.7);
    color: #f0f0f0;
    
    padding: 5px 15px;
    border-radius: 20px;
    border: 1px solid #7f8c8d;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
    
    font-family: 'Consolas', 'Lucida Console', monospace; /* Fuente de estilo "digital" */
    font-size: 1.2em;
    font-weight: bold;
    letter-spacing: 1px;
    
    display: flex;
    align-items: center;
    gap: 10px; /* Espacio entre el reloj y el tiempo */
    
    z-index: 10001; /* Lo pone por encima de casi todo */
    transition: opacity 0.3s ease-out;
}

/* Estilo especial cuando queda poco tiempo */
.turn-timer-display.low-time {
    color: #f1c40f; /* Amarillo advertencia */
    animation: pulseWarning 1.5s infinite;
}

.turn-timer-display.critical-time {
    color: #e74c3c; /* Rojo cr√≠tico */
    animation: pulseCritical 1s infinite;
}

/* Animaciones de pulso */
@keyframes pulseWarning {
    0% { transform: scale(1); box-shadow: 0 0 5px rgba(241, 196, 15, 0.3); }
    50% { transform: scale(1.03); box-shadow: 0 0 15px rgba(241, 196, 15, 0.7); }
    100% { transform: scale(1); box-shadow: 0 0 5px rgba(241, 196, 15, 0.3); }
}

@keyframes pulseCritical {
    0% { transform: scale(1); box-shadow: 0 0 5px rgba(231, 76, 60, 0.3); }
    50% { transform: scale(1.05); box-shadow: 0 0 20px rgba(231, 76, 60, 0.8); }
    100% { transform: scale(1); box-shadow: 0 0 5px rgba(231, 76, 60, 0.3); }
}

/* ========================================================================== */
/* ==   DISE√ëO SETUP ESCARAMUZA      == */
/* ========================================================================== */

/* --- 1. Contenedor del Modal con fondo oscuro y sin bordes feos --- */
#setupScreen .modal-container {
    background-color: #2c3e50; /* Un azul-gris oscuro, como en un mapa de estrategia */
    border: 2px solid #95a5a6; /* Borde met√°lico */
    border-radius: 8px;
    box-shadow: 0 0 20px rgba(0,0,0,0.5), inset 0 0 10px rgba(0,0,0,0.3);
    max-width: 95vw;
    height: auto;
    color: #ecf0f1; /* Texto claro */
}

/* --- 2. Cabecera con m√°s estilo --- */
#setupScreen .modal-header {
    padding: 10px 15px; /* M√°s compacto */
    border-bottom: 1px solid #7f8c8d;
}
#setupScreen .modal-header h2 {
    font-size: 1.1em; /* T√≠tulo m√°s peque√±o */
    color: #f1c40f; /* Tono dorado */
    text-transform: uppercase;
    letter-spacing: 1px;
}
#setupScreen .modal-close-btn {
    color: #bdc3c7;
}


/* --- 3. Cuerpo principal sin padding vertical excesivo y sin scroll --- */
#setupScreen .modal-body.setup-screen-themed {
    display: flex;
    flex-direction: column;
    justify-content: center; /* Centra el contenido */
    gap: 15px;
    padding: 15px;
    overflow: hidden; /* ¬°Prohibido el scroll! */
}

/* --- 4. Rejilla 2x3 para las opciones superiores --- */
.options-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr); /* 3 columnas iguales */
    grid-template-rows: auto auto; /* 2 filas, altura autom√°tica */
    gap: 8px 12px; /* Espacio vertical y horizontal */
    align-items: center;
}
.options-grid label {
    font-size: 0.75em; /* Etiquetas mucho m√°s peque√±as */
    font-weight: 500;
    text-align: center;
    text-transform: uppercase;
    color: #bdc3c7;
}
.options-grid select {
    width: 100%;
    padding: 6px; /* Selectores m√°s compactos */
    font-size: 0.9em;
    background-color: #34495e; /* Fondo oscuro */
    color: #ecf0f1; /* Texto claro */
    border: 1px solid #7f8c8d;
    border-radius: 4px;
}

/* --- 5. Fila inferior del Slider --- */
.players-row {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
    margin-top: 5px; /* Un peque√±o margen superior */
}
.players-row label {
    font-size: 0.9em; /* Tama√±o equilibrado */
    font-weight: 500;
    color: #bdc3c7;
}
.players-row #num-players-display {
    color: #f1c40f; /* Dorado, para que destaque */
    font-weight: bold;
    font-size: 1.1em;
}
input[type="range"] {
    width: 90%; /* Ocupa casi todo el ancho */
    margin: 0;
}


/* --- 6. Pie de p√°gina m√°s integrado --- */
#setupScreen .modal-footer {
    background-color: #212f3d;
    border-top: 1px solid #7f8c8d;
    padding: 10px 15px;
}

/* ========================================================================== */
/* ==   DISE√ëO SETUP SCREEN 2 (TEM√ÅTICO, HEREDANDO ESTILO)                 == */
/* ========================================================================== */

/* --- 1. Aplicamos el mismo estilo base de contenedor a la pantalla 2 --- */
#setupScreen2 .modal-container {
    background-color: #2c3e50;
    border: 2px solid #95a5a6;
    border-radius: 8px;
    box-shadow: 0 0 20px rgba(0,0,0,0.5), inset 0 0 10px rgba(0,0,0,0.3);
    color: #ecf0f1;
}

/* --- 2. Unificamos el estilo de la cabecera --- */
#setupScreen2 .modal-header {
    padding: 10px 15px;
    border-bottom: 1px solid #7f8c8d;
}
#setupScreen2 .modal-header h2 {
    font-size: 1.1em;
    color: #f1c40f;
    text-transform: uppercase;
    letter-spacing: 1px;
}

/* --- 3. Cuerpo principal sin padding vertical excesivo y sin scroll --- */
#setupScreen2 .modal-body {
    padding: 15px;
    overflow: hidden; /* ¬°Prohibido el scroll aqu√≠ tambi√©n! */
}

/* --- 4. Hacemos las tarjetas de jugador mucho m√°s compactas --- */
#setupScreen2 .player-card {
    background-color: #34495e; /* Fondo oscuro para la tarjeta */
    border: 1px solid #7f8c8d;
}

#setupScreen2 .player-card .player-icon {
    box-shadow: 0 0 5px rgba(0,0,0,0.5); /* Sombra para que destaque */
}

#setupScreen2 .player-card select {
    background-color: #2c3e50; /* Un poco m√°s oscuro que la tarjeta */
    color: #ecf0f1;
    border-color: #95a5a6;
}

#setupScreen2 .player-card select:disabled {
    background-color: #212f3d;
    opacity: 0.6;
}


/* --- 5. Unificamos el estilo del pie de p√°gina --- */
#setupScreen2 .modal-footer {
    background-color: #212f3d;
    border-top: 1px solid #7f8c8d;
    padding: 10px 15px;
}

/* ========================================================== */
/* ==   Pantalla de Escaramuza      == */
/* ========================================================== */

/* --- Modal: Configuraci√≥n de Escaramuza y Campa√±a --- */
#setupScreen select { padding: 2px; border-radius: 2px; border: 1px solid #ccc; min-width: 80px; }

#worldMapScreen { background-color: #7da0c0; box-shadow: 0 0 15px rgba(0,0,0,0.3); border-radius: 8px; position: relative; }
#worldMapImage { border-radius: 6px; display: block; max-width: 100%; height: auto; }
#campaignMessages { border-top: 1px solid #ccc; color: #333; max-width: 300px; word-wrap: break-word; padding: 10px; margin-top: 10px; background-color: #f9f9f9; border-radius: 4px; }
.territory-on-map {
    position: absolute; width: auto; min-width: 30px; height: auto; padding: 5px 8px;
    background-color: rgba(220, 220, 220, 0.8); border: 1px solid #777; color: #333;
    border-radius: 20px; display: flex; justify-content: center; align-items: center;
    font-size: 0.75em; font-weight: bold; text-align: center; cursor: default; pointer-events: all;
    transform: translate(-50%, -50%); transition: background-color 0.2s, transform 0.2s, box-shadow 0.2s;
    box-shadow: 0 1px 2px rgba(0,0,0,0.2);
}
.territory-on-map.player-controlled { background-color: rgba(60, 179, 113, 0.85); border-color: #2e8b57; color: white; }
.territory-on-map.ai-controlled { background-color: rgba(220, 20, 60, 0.85); border-color: #b22222; color: white; }
.territory-on-map.neutral-territory { background-color: rgba(240, 230, 140, 0.85); border-color: #b8860b; color: #545454; }
.territory-on-map.selectable-territory { cursor: pointer; border-width: 2px; }
.territory-on-map.selectable-territory:hover { transform: translate(-50%, -50%) scale(1.1); box-shadow: 0 0 12px 4px gold; z-index: 10; }


/* ========================================================================== */
/* ==   SOLUCI√ìN M√ìVIL UNIFICADA PARA #setupScreen                         == */
/* ========================================================================== */

@media (max-width: 768px) {

    /* --- Contenedor Principal: Lo hacemos m√°s estrecho --- */
    #setupScreen .modal-container {
        /* Evita que el modal ocupe toda la pantalla, forzando a que el contenido se adapte */
        max-width: 360px; 
    }

    /* --- Cabecera: La hacemos s√∫per delgada --- */
    #setupScreen .modal-header {
        padding: 4px 10px;
    }
    #setupScreen .modal-header h2 {
        font-size: 1em;
    }

    /* --- Cuerpo: Reducimos todos los espacios --- */
    #setupScreen .modal-body.setup-screen-themed {
        padding: 8px;
        gap: 8px; /* Menos espacio entre el grid de columnas y el slider */
    }

    /* --- El Grid de Columnas: La clave del layout --- */
    #setupScreen .setup-grid {
        display: flex; /* Asegura que sea flex */
        flex-wrap: nowrap; /* Proh√≠be el salto de l√≠nea */
        gap: 4px; /* Espacio entre columnas */
    }

    /* --- Las Columnas Individuales --- */
    #setupScreen .setup-column {
        padding: 4px;
        width: 50%; /* Cada columna ocupa la mitad del espacio disponible */
        flex-shrink: 1; /* Permite que se encojan si es necesario */
        background-color: #34495e;
    }

    /* --- Contenido DENTRO de las columnas --- */
    #setupScreen .setup-column h4 {
        font-size: 0.8em;
        margin: 0 0 8px 0;
        padding-bottom: 4px;
    }
    #setupScreen .setup-option {
        margin-bottom: 4px;
        background-color: #2c3e50 !important; /* Fondo tem√°tico oscuro */
        color: #ecf0f1 !important;           /* Texto claro */
    }
    #setupScreen .setup-option label {
        font-size: 0.8em;
        margin-bottom: 4px;
    }
    
    /* --- Aqu√≠ integramos TU regla para los selectores, ligeramente adaptada --- */
    #setupScreen .setup-option select {
        width: 100%; /* Para que ocupe todo el ancho de su columna */
        padding: 4px; /* Un poco m√°s de padding para que sea usable en t√°ctil */
        font-size: 0.9em;
        border-radius: 2px;
        border: 1px solid #7f8c8d; /* Usamos un color del tema oscuro */
        background-color: #2c3e50 !important; /* Fondo tem√°tico oscuro */
        color: #ecf0f1 !important;           /* Texto claro */
    }

    /* --- Slider y Pie de p√°gina --- */
    #setupScreen .players-row {
        margin-top: 0;
        gap: 4px;
    }
    #setupScreen .modal-footer {
        padding: 4px 10px;
    }
    #setupScreen .modal-footer button {
        padding: 4px 12px;
        font-size: 0.9em;
    }

}

/* === ESTILO PARA LAS RUINAS === */

/* Crea un icono de ruina usando el pseudo-elemento ::after */
.hex.feature-ruins::after {
    content: 'üèõÔ∏è'; /* Puedes cambiar este emoji por cualquier otro que te guste */
    position: absolute;
    
    /* Lo posicionamos ligeramente distinto a los recursos para que se diferencien */
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);

    font-size: 24px;
    opacity: 0.65;
    z-index: 2; /* Importante: por debajo de estructuras (z-index: 5) y unidades (z-index: 10) */
    
    /* Sombra para que destaque sobre el terreno */
    text-shadow: 1px 1px 3px rgba(0,0,0,0.7);
    
    pointer-events: none; /* Para que no interfiera con el clic en el hex√°gono */
}

/* Estilo para las ruinas ya saqueadas, se ven m√°s tenues */
.hex.feature-ruins-looted::after {
    opacity: 0.3;
    filter: grayscale(100%);
}

/* ==================================================================== */
/* === ADAPTACI√ìN M√ìVIL PARA EL MODAL DE DETALLE DE TECNOLOG√çA      === */
/* ==================================================================== */


/* Bot√≥n principal de acci√≥n en los modales */
.button-primary {
    background-color: #007bff; /* Azul vibrante */
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.2s;
}
.button-primary:hover {
    background-color: #0056b3;
}
.button-primary:disabled {
    background-color: #6c757d;
    cursor: not-allowed;
    opacity: 0.6;
}

/* ============================================================== */
/* === MODAL DE TECNOLOG√çA (VERSI√ìN ULTRA COMPACTA PARA M√ìVIL) === */
/* ============================================================== */

#techDetailModal .modal-content {
    padding: 20px; /* Reducci√≥n brutal de los espacios de borde */
    width: 90vw;
    max-width: 90vw;
    font-size: 14px; /* Hacemos la fuente base un poco m√°s peque√±a */
}

#techDetailHeader {
    align-items: flex-start; /* Alinea los items arriba, ahorra espacio vertical */
    margin-bottom: 5px;   /* Menos espacio debajo */
    padding-bottom: 5px;
}
#techDetailModal .close-button {
    /* Hacemos la 'X' mucho m√°s peque√±a */
    font-size: 18px;
    padding: 0 5px;
}

#techDetailIcon {
    font-size: 1.5em; /* Reducimos a√∫n m√°s el emoji */
}

#techDetailName {
    font-size: 1em;   /* Reducimos a√∫n m√°s el t√≠tulo */
    line-height: 1.1; /* Hacemos que la altura de l√≠nea sea m√°s compacta */
}


#techDetailDescription {
    min-height: 0; /* Sin altura m√≠nima, ocupa lo que necesite */
    margin-bottom: 12px;
    font-size: 0.9em;
    margin: 5px 0;      /* Reducimos el espacio vertical que la rodea */
    line-height: 1.2;     /* Hacemos el texto m√°s denso, menos espacio entre l√≠neas */

}

#techDetailInfoGrid {
    font-size: 0.8em; /* Texto de Costo/Requiere m√°s peque√±o */
    gap: 4px 8px; /* Espacio m√≠nimo */
}

#researchTechBtn {
    padding: 8px 16px;  /* ¬°BOT√ìN M√ÅS PEQUE√ëO! Reduce altura y anchura */
    font-size: 0.8em;     /* ¬°BOT√ìN M√ÅS PEQUE√ëO! Texto del bot√≥n m√°s peque√±o */
}

#techDetailFooter {
    margin-top: 10px;
    padding-top: 8px;
}

/* ========================================================== */
/* == ESTILOS PARA PANTALLA DE FACCIONES (MOBILE-FIRST V2) == */
/* ========================================================== */

/* Contenedor principal del grid */
.player-grid-container {
    display: grid;
    /* En m√≥vil, una sola columna que ocupa todo el ancho */
    grid-template-columns: 1fr; 
    gap: 15px; /* Reducimos el espacio entre tarjetas */
    padding: 10px; /* Reducimos el padding general */
    max-height: 75vh; /* Un poco m√°s de altura para el scroll */
    overflow-y: auto;
}

/* Tarjeta de jugador individual */
.player-card {
    position: relative;
    border: 1px solid #777; /* Borde m√°s sutil */
    border-radius: 8px;
    overflow: hidden;
    height: 250px; /* ALTURA REDUCIDA DR√ÅSTICAMENTE */
    box-shadow: 0 2px 8px rgba(0,0,0,0.5);
    color: white;
    display: flex;
    flex-direction: column;
}

/* Imagen de fondo de la facci√≥n */
.faction-image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-size: cover;
    background-position: center;
    transition: opacity 0.3s ease-in-out;
    z-index: 1;
}

/* Capa semitransparente para el contenido */
.faction-overlay {
    position: relative;
    z-index: 2;
    width: 100%;
    height: 100%;
    padding: 10px; /* Padding reducido */
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    /* Gradiente m√°s pronunciado para asegurar legibilidad del texto inferior */
    background: linear-gradient(to top, rgba(0,0,0,0.95) 30%, rgba(0,0,0,0.5) 60%, transparent 100%);
}

/* Cabecera con icono P1 y selector de tipo */
.player-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.player-icon {
    font-size: 1.2em; /* Tama√±o de fuente reducido */
    font-weight: bold;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
}

/* Estilo para TODOS los <select> dentro de la tarjeta */
.player-card select {
    /* --- CORRECCI√ìN DE TRANSLUCIDEZ --- */
    background-color: rgba(0, 0, 0, 0.6); /* Fondo negro semitransparente */
    backdrop-filter: blur(2px); /* Efecto "cristal esmerilado" (opcional, muy moderno) */
    color: #f0f0f0;
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 5px;
    padding: 4px 6px; /* Padding reducido */
    font-size: 0.8em; /* Tama√±o de fuente reducido */
}

/* Estilos para el <select> de la civilizaci√≥n (m√°s grande) */
.faction-details select {
    width: 100%;
    font-size: 1.1em; /* Un poco m√°s grande para que destaque */
    font-weight: bold;
    margin-bottom: 8px;
}

/* Descripci√≥n de la facci√≥n */
.faction-description {
    font-size: 0.85em; /* Tama√±o de fuente reducido */
    min-height: 40px; /* Espacio reducido para 2-3 l√≠neas */
    color: #ddd;
    text-shadow: 2px 2px 3px black; /* Sombra m√°s fuerte para legibilidad */
    margin: 0;
}

/* Media Query para pantallas m√°s grandes (tablets, escritorio) */
@media (min-width: 600px) {
    .player-grid-container {
        /* A partir de 600px, muestra 2 columnas */
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (min-width: 900px) {
    .player-grid-container {
        /* A partir de 900px, muestra 3 columnas */
        grid-template-columns: repeat(3, 1fr);
    }
}

@media (min-width: 1200px) {
    .player-grid-container {
        /* En pantallas muy grandes, muestra hasta 4 columnas */
        grid-template-columns: repeat(4, 1fr);
    }
}


/* ========================================================== */
/* === ESTILOS MODAL BANCA (V3 - ULTRA COMPACTO Y CORREGIDO) === */
/* ========================================================== */

/* Estilo base para modales compactos */
.modal-content.compact-modal {
    padding: 4px;
    max-height: 80vh;
}

.compact-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 4px;
}
.compact-header h2 {
    margin: 0;
    font-size: 1.2em; /* T√≠tulo m√°s peque√±o */
}
.compact-header .close-button {
    position: static; /* Quita el posicionamiento absoluto */
    font-size: 1.2em;
}

/* Pesta√±as */
.inbox-tabs { margin-bottom: 5px; }
.bank-tab-btn { /* Nueva clase espec√≠fica */
    padding: 4px 6px;
    font-size: 1.0em;
    cursor: pointer;
    border: none;
    background-color: transparent;
    color: #888;
    border-bottom: 2px solid transparent;
}
.bank-tab-btn.active {
    color: #f1c40f;
    border-bottom: 2px solid #f1c40f;
}

.bank-trade-interface {
    display: flex;
    flex-direction: column; /* Apilado vertical siempre */
    gap: 5px;
    padding: 5px;
    background-color: rgba(0, 0, 0, 0.2);
    border-radius: 4px;
    margin-top: 4px;
}

.trade-column {
    display: flex;
    flex-direction: row; /* Elementos en fila */
    align-items: center;
    justify-content: space-between;
    width: 100%;
}
.trade-column h4 {
    margin: 0;
    font-size: 1em; /* T√≠tulos de secci√≥n m√°s peque√±os */
    color: #f1c40f;
    flex-basis: 25%; /* Ancho fijo para el t√≠tulo */
}
.trade-column select,
.trade-column input {
    flex-grow: 1; /* Ocupa el espacio restante */
    padding: 5px;
    font-size: 0.9em;
    background-color: #333;
    color: #eee;
    border: 1px solid #777;
    border-radius: 4px;
    text-align: center;
    margin: 0 5px;
}
.trade-column p {
    margin: 0;
    font-size: 0.8em;
    color: #ccc;
    flex-basis: 30%;
    text-align: right;
}
.trade-column .ratio-text {
    text-align: center;
}

.trade-arrow {
    font-size: 1.0em;
    color: #f1c40f;
    transform: rotate(90deg);
    margin: 0;
    padding: 0;
}

#bankConfirmTradeBtn {
    width: 100%;
    padding: 5px;
    margin-top: 5px;
    font-size: 1em;
}

/* ========================================================== */
/* == ESTILOS TRACKER DE PV (VERSI√ìN COMPACTA ESQUINA SUP-IZQ) == */
/* ========================================================== */

#victory-points-tracker {
    position: fixed; /* Fijo en la pantalla */
    top: 5px;        /* Peque√±o margen superior */
    left: 5px;       /* Peque√±o margen izquierdo */
    z-index: 2000;   /* Por encima de casi todo */
    
    display: flex;
    align-items: center;
    height: 15px;      /* ALTURA M√ÅXIMA */
    padding: 2px 6px;
    
    background-color: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(3px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 4px;
    
    font-size: 10px;   /* Tama√±o de fuente muy peque√±o */
    font-weight: bold;
    color: #f1c40f;
    cursor: default;
}

#victory-points-tracker .vp-icon {
    font-size: 11px; /* Icono un poco m√°s grande que el texto */
    margin-right: 4px;
}

/* El tooltip sigue igual, pero lo ajustamos para que no sea enorme */
#victory-points-tooltip {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    width: 250px; /* Ancho ajustado */
    background-color: #2c3e50;
    border: 1px solid #7f8c8d;
    border-radius: 5px;
    padding: 8px;
    z-index: 100;
    box-shadow: 0 4px 8px rgba(0,0,0,0.5);
    color: #ecf0f1;
    font-size: 11px; /* Fuente peque√±a tambi√©n para el tooltip */
}

#victory-points-tracker:hover > #victory-points-tooltip {
    display: block;
}

#victory-points-tooltip h4 {
    margin: 0 0 5px 0;
    padding-bottom: 4px;
    font-size: 12px;
    /* ... (resto de estilos de h4 sin cambios) */
}

#victory-points-tooltip ul {
    list-style: none; padding: 0; margin: 0;
}
#victory-points-tooltip li {
    display: flex; justify-content: space-between; padding: 3px 0;
}
#victory-points-tooltip li span:first-child {
    color: #bdc3c7;
}

.version-watermark {
    position: absolute;
    bottom: 10px;
    right: 15px;
    font-size: 14px;
    color: rgba(240, 230, 210, 0.4);
    pointer-events: none;
    z-index: 1000;
    display: none; /* Oculto por defecto (m√≥vil) */
}

.name-watermark {
    position: absolute;
    bottom: 10px;
    left: 15px;
    font-size: 14px;
    color: rgba(240, 230, 210, 0.4);
    pointer-events: none;
    z-index: 1000;
    display: none; /* Oculto por defecto (m√≥vil) */
}

/* Mostrar marca de agua solo en pantallas grandes */
@media (min-width: 1024px) {
    .version-watermark {
        display: block;
    }
    .name-watermark {
        display: block;
    }
}

/* Ajuste de legibilidad para la lista de construcci√≥n en tema oscuro */
#availableStructuresList li {
    color: #ecf0f1; /* Texto blanco gris√°ceo */
    border-bottom: 1px solid #7f8c8d; /* Separador sutil */
    padding: 12px;
}

#availableStructuresList li:hover {
    background-color: #34495e; /* Azul un poco m√°s claro al pasar el rat√≥n */
}

#availableStructuresList li.selected-structure {
    background-color: #2980b9; /* Azul vibrante para la selecci√≥n */
    color: #ffffff;
    font-weight: bold;
}

/* --- -------------------------------------------------------- --- */
/* --- Ajustes Especiales para el Inventario en M√≥vil (Paisaje) --- */
/* --- -------------------------------------------------------- --- */
/* --- CORRECCI√ìN FINAL: INVENTARIO ULTRA-COMPACTO --- */
@media (max-width: 768px) {
    #inventoryModal .modal-content {
        width: 84vw !important;  /* Ajuste de tama√±o general */
        height: 82vh !important;
        padding: 5px !important;
    }

    #inventoryModal .gacha-main-layout {
        display: grid !important;
        /* Columna 1 (Filtros): Estrecha / Columna 2 (Grid): Flexible / Columna 3 (Detalle): Media */
        grid-template-columns: 60px 1fr 130px !important; 
        gap: 6px !important;
        height: calc(100% - 25px);
        align-items: start;
    }

    /* --- CATEGOR√çAS: Muy juntas en vertical --- */
    #inventoryModal .gacha-column:first-child {
        display: flex !important;
        flex-direction: column !important;
        gap: 2px !important; /* M√≠nima separaci√≥n vertical */
        padding: 0 !important;
    }
    #inventoryModal .gacha-button {
        margin: 0 !important;
        padding: 6px 2px !important; /* M√°s bajas */
        font-size: 0.85em !important;
        width: 100%;
        line-height: 1;
    }

    /* --- GRID DE OBJETOS: 4 por fila exactos --- */
    #inventoryGrid {
        display: grid !important;
        grid-template-columns: repeat(4, 1fr) !important; 
        gap: 4px !important;
        padding: 4px !important;
        align-content: start; /* Empieza arriba */
    }

    /* --- TARJETA DE OBJETO: Corregir solapamiento de la imagen --- */
    #inventoryModal .hero-card {
        min-width: 0 !important;
        width: 100% !important;
        height: 65px !important; 
        margin: 0 !important;
        padding: 3px !important;
        display: flex !important;
        flex-direction: column !important;
        align-items: center;
        justify-content: center;
        box-sizing: border-box; /* Evita que el borde la ensanche */
        overflow: hidden;
    }

    /* Icono e indicador de cantidad xXXX */
    #inventoryModal .hero-card div {
        font-size: 1.1em !important;
        line-height: 1;
    }
    #inventoryModal .hero-card small {
        font-size: 0.75em !important;
        white-space: nowrap;
        margin: 2px 0;
    }
    #inventoryModal .hero-card div:last-child {
        font-size: 0.85em !important; /* El color dorado del x500 */
    }
}

/* --- -------------------------------------------------------- --- */
/* --- MINIATURIZAR DIVISI√ìN (M√≥vil) --- */
/* --- -------------------------------------------------------- --- */
#advancedSplitUnitModal .modal-content {
    width: 95vw !important;
    max-height: 85vh;
    transform: scale(0.9); /* Encogemos todo el modal un 10% */
}
.split-regiment-container {
    gap: 5px;
    padding: 2px;
}
#advancedSplitUnitModal .regiments-list li {
    font-size: 1.1em !important; /* Iconos m√°s peque√±os para que no se amontonen */
}

/* --- SOLUCI√ìN PARA TABLETS / PANTALLAS GRANDES --- */
@media (min-width: 1024px) {
    .hero-collection-grid {
        /* En tablet forzamos a que las casillas no se estiren al infinito */
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)) !important;
        max-width: 1000px;
        margin: 0 auto;
    }
}

/* --- -------------------------------------------------------- --- */
/* --- TEMA OSCURO PARA FORJA Y EQUIPO --- */
/* --- -------------------------------------------------------- --- */


#forgeModal .modal-content, 
#equipmentSelectorModal .modal-content {
    background-color: #2c3e50 !important;
    color: #ecf0f1 !important;
    border: 2px solid #7f8c8d;
}

#blueprintList, .blueprint-detail, .equipment-list {
    background-color: #34495e !important;
    border-color: #4a5568 !important;
    color: #ecf0f1 !important;
}

.blueprint-item:hover, .equipment-item:hover {
    background-color: #1a2531 !important;
}

.blueprint-item.selected, .equipment-item.selected {
    background-color: #1a2531 !important;
    border-left: 4px solid #f1c40f !important;
}

/* nuevo set */

/* --- MEJORA DE VISIBILIDAD: PANEL IZQUIERDO DE LA FORJA --- */

/* 1. Fondo del contenedor de la lista (m√°s oscuro para resaltar los items) */
#blueprintList {
    background-color: #0d141b !important; /* Casi negro azulado */
    padding: 5px !important;
    border: 1px solid #4a5568 !important;
}

/* 2. El Item Individual (El recuadro del objeto) */
.blueprint-item {
    background-color: #243447 !important; /* Azul acero claro/medio */
    border: 1px solid #4a5568 !important;
    margin-bottom: 5px !important;
    border-radius: 4px !important;
    transition: all 0.2s ease !important;
}

/* 3. El texto dentro de la lista (Color Crema/Oro para que salte a la vista) */
.blueprint-item .item-name {
    color: #f1c40f !important; /* Dorado brillante */
    text-shadow: 1px 1px 1px black !important;
    font-weight: bold !important;
}

.blueprint-item .item-progress {
    color: #bdc3c7 !important; /* Gris claro para los n√∫meros de fragmentos */
}

/* 4. Efecto de pasar el dedo/rat√≥n (Color Brasas) */
.blueprint-item:hover {
    background-color: #3d4d5e !important;
    border-color: #e67e22 !important; /* Naranja fuego */
}

/* 5. ITEM SELECCIONADO (Efecto resplandor naranja) */
.blueprint-item.selected {
    background-color: #2c3e50 !important;
    border-left: 5px solid #e67e22 !important;
    box-shadow: inset 0 0 10px rgba(230, 126, 34, 0.4) !important;
}

/* 6. Indicador de "Puede Forjarse" (Verde brillante) */
.blueprint-item.can-forge {
    border-right: 4px solid #2ecc71 !important;
}

/* --- MEJORA CONTRASTE: COLUMNA DERECHA DE DETALLES (FORJA) --- */

/* 1. Panel de detalle: Fondo m√°s denso para resaltar el texto */
.blueprint-detail, #blueprintDetailContent {
    background-color: #121c26 !important; /* Azul petr√≥leo muy oscuro */
    color: #f0e6d2 !important; /* Color crema/pergamino (contraste m√°ximo) */
    padding: 10px !important;
}

/* 2. T√≠tulo del objeto a la derecha */
#blueprintItemName {
    color: #f1c40f !important; /* Dorado */
    font-size: 1.2em !important;
    text-transform: uppercase;
    margin-bottom: 5px !important;
}

/* 3. DESCRIPCI√ìN Y ESTAD√çSTICAS: La clave del problema */
#blueprintItemStats {
    color: #ffffff !important; /* Blanco puro para m√°xima visibilidad */
    font-size: 0.9em !important;
    font-style: italic !important;
    line-height: 1.3;
    background: rgba(255, 255, 255, 0.05); /* Sutil caja para separar el texto */
    padding: 8px !important;
    border-radius: 4px;
}

/* 4. Cabeceras de secci√≥n dentro del detalle (ej: 'Requisitos', 'Efectos') */
.blueprint-detail h4, .blueprint-detail strong {
    color: #e67e22 !important; /* Naranja fuego para t√≠tulos de secci√≥n */
    font-size: 0.85em !important;
}

/* 5. BARRA DE PROGRESO DE FRAGMENTOS (Columna Derecha) */
.forge-progress-item {
    background: #0d141b !important;
    padding: 10px !important;
    border: 1px solid #4a5568 !important;
    margin: 5px 0 !important;
}

#blueprintFragmentText {
    color: #2ecc71 !important; /* Verde ne√≥n para el conteo de fragmentos */
    font-weight: bold !important;
    display: block;
    margin-top: 5px;
    font-size: 0.9em !important;
}

/* 6. Miniaturizar la descripci√≥n para que quepa en 320px de alto */
@media (max-width: 768px) {
    #blueprintItemStats {
        font-size: 0.8em !important;
        margin: 2px 0 !important;
    }
}

/* --- 1. Soluci√≥n Wiki X (Moverla para que el contador no la tape) --- */
#wikiModal .close-button {
    top: 50px !important; /* Baja la X para esquivar el reloj de arriba a la derecha */
    right: 20px !important;
    background: #c0392b;
    border-radius: 50%;
    width: 35px;
    height: 35px;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10001;
}

/* --- 2. Fondo Negro para el Buz√≥n de Mensajes --- */
#inboxModal .modal-content, 
#inboxListContainer, 
#inboxDetailContainer {
    background-color: #0a0e12 !important;
    color: #ecf0f1 !important;
}
.inbox-list-item {
    background-color: #1a1e22 !important;
    border-bottom: 1px solid #333 !important;
    color: #ccc !important;
}
.inbox-list-item strong { color: #f1c40f; }

/* --- 3. Tablet Fix: Panel de H√©roes (Visualizar m√°s casillas) --- */
@media (min-width: 769px) {
    .hero-collection-grid {
        display: grid !important;
        grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)) !important;
        gap: 20px !important;
        max-width: 95vw;
    }
}

/* --- WIKI V2.0: Soporte para m√∫ltiples pesta√±as en m√≥vil --- */
.wiki-tabs {
    display: flex;
    overflow-x: auto; /* Permite scroll horizontal */
    overflow-y: hidden;
    -webkit-overflow-scrolling: touch;
    white-space: nowrap; /* Impide que las letras salten de l√≠nea */
    border-bottom: 2px solid #7f8c8d;
    padding-bottom: 2px;
}

.wiki-tab-btn {
    flex: 0 0 auto; /* Los botones no se encogen, mantienen su tama√±o de texto */
    font-size: 0.9em;
    padding: 8px 12px;
}

@media (max-width: 620px) {
    .wiki-tab-btn {
        font-size: 0.8em;
        padding: 6px 10px;
    }
}

/* --- CORRECCI√ìN PANEL H√âROES: ADAPTACI√ìN FLUIDA (M√≥vil, Tablet y PC) --- */

/* Reemplazamos la configuraci√≥n r√≠gida por una fluida con minmax */
.hero-collection-grid {
    display: grid !important;
    /* Ajusta el ancho de las casillas: m√≠nimo 115px, m√°ximo 1fr (repartir sobra) */
    grid-template-columns: repeat(auto-fill, minmax(115px, 1fr)) !important;
    gap: 12px !important;
    padding: 10px !important;
    max-height: 70vh; /* Controlamos el alto para que no se pierda el scroll */
    overflow-y: auto;
}

/* Ajuste espec√≠fico para evitar que las cartas sean gigantes en pantallas grandes */
@media (min-width: 768px) {
    .hero-collection-grid {
        grid-template-columns: repeat(auto-fill, minmax(125px, 1fr)) !important;
        gap: 15px !important;
        /* Limitamos el ancho total en tablets/PC para que no se desparrame */
        max-width: 950px; 
        margin-left: auto;
        margin-right: auto;
    }
}

/* Aseguramos que las im√°genes de los h√©roes se mantengan proporcionales en el grid */
.hero-card-image {
    width: 70px !important;
    height: 70px !important;
    object-fit: cover;
    margin: 0 auto 5px auto;
}

.hero-card .hero-name {
    font-size: 0.85em !important;
    line-height: 1.1;
    min-height: 2.2em; /* Mantiene alineados los nombres de 1 o 2 l√≠neas */
}

/* ========================================================== */
/* ==   CENTRO DE MENSAJER√çA HOLOGR√ÅFICO (RES. 320px)      == */
/* ========================================================== */

/* 1. Contenedor Base */
#inboxModal .modal-content {
    width: 94vw !important;
    height: 88vh !important;
    max-width: 800px;
    background: #050a0f !important; /* Fondo casi negro */
    border: 1px solid #00f3ff !important; /* Borde Cian Ne√≥n */
    box-shadow: 0 0 20px rgba(0, 243, 255, 0.15) !important;
    padding: 0 !important;
    font-family: 'Segoe UI', sans-serif;
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

/* 2. Pesta√±as de Navegaci√≥n (Altura cr√≠tica: 22px) */
.inbox-tabs {
    height: 22px !important;
    background: #0a141d;
    display: flex;
    gap: 15px;
    padding-left: 10px;
    border-bottom: 1px solid #1a2a33;
    flex-shrink: 0;
}

.inbox-tab-btn {
    height: 100%;
    background: transparent !important;
    border: none !important;
    color: #4b6b7a !important;
    font-size: 10px !important;
    font-weight: bold;
    text-transform: uppercase;
    cursor: pointer;
    padding: 0 5px !important;
}

.inbox-tab-btn.active {
    color: #00f3ff !important;
    border-bottom: 2px solid #00f3ff !important;
}

/* 3. Distribuci√≥n Lateral (Sidebar vs Detalle) */
.inbox-main-layout {
    display: flex;
    flex-grow: 1;
    height: calc(100% - 22px);
}

/* --- Lista de Mensajes (Izquierda) --- */
#inboxListContainer {
    width: 32%;
    background: rgba(0, 0, 0, 0.4);
    border-right: 1px solid #1a2a33;
    overflow-y: auto;
    scrollbar-width: thin;
}

.inbox-list-item {
    height: 38px !important; /* Altura fija peque√±a */
    border-bottom: 1px solid #1a2a33;
    padding: 4px 8px !important;
    display: flex;
    align-items: center;
    cursor: pointer;
    transition: background 0.2s;
}

.inbox-list-item:hover { background: rgba(0, 243, 255, 0.05); }
.inbox-list-item.selected { background: rgba(0, 243, 255, 0.1); }

.inbox-status-bar {
    width: 2px; height: 70%;
    background: #00f3ff;
    box-shadow: 0 0 5px #00f3ff;
    margin-right: 6px;
}

.inbox-list-item.read .inbox-status-bar { opacity: 0; }

.inbox-list-item strong {
    font-size: 9px;
    color: #fff;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* --- DETALLES DEL MENSAJE (Derecha - El fallo de las columnas estaba aqu√≠) --- */
#inboxDetailContainer {
    width: 68%;
    background: rgba(10, 15, 25, 0.5);
    display: flex !important;
    flex-direction: column !important; /* Forzamos FILAS */
    padding: 8px !important;
    overflow: hidden; /* El scroll lo tiene el Body */
}

/* Fila 1: T√≠tulo */
#inboxDetailTitle {
    font-size: 10px;
    color: #00f3ff;
    font-weight: bold;
    text-transform: uppercase;
    margin-bottom: 4px;
    border-bottom: 1px solid rgba(0, 243, 255, 0.2);
    padding-bottom: 2px;
    flex-shrink: 0;
}

/* Fila 2: Imagen Opcional (Comprimida) */
#inboxDetailHeaderImage {
    height: 60px !important;
    background-size: cover;
    background-position: center;
    border-radius: 4px;
    margin-bottom: 6px;
    flex-shrink: 0;
}

/* Fila 3: El cuerpo del mensaje (Con scroll interno) */
#inboxDetailBody {
    flex-grow: 1; /* Ocupa el espacio central */
    font-size: 11px;
    line-height: 1.3;
    color: #cbd5e0;
    overflow-y: auto;
    padding-right: 4px;
    scrollbar-width: thin;
}

/* Fila 4: Footer con Bot√≥n y Premios */
#inboxFooter {
    margin-top: 8px;
    border-top: 1px solid rgba(255, 255, 255, 0.05);
    padding-top: 6px;
    flex-shrink: 0;
}

#inboxRewardSection {
    display: flex;
    gap: 4px;
    margin-bottom: 6px;
}

.reward-slot {
    width: 32px; height: 32px;
    background: rgba(0, 243, 255, 0.05);
    border: 1px solid rgba(0, 243, 255, 0.3);
    display: flex; flex-direction: column;
    align-items: center; justify-content: center;
    border-radius: 4px;
}

#inboxClaimBtn {
    width: 100%;
    height: 28px !important;
    background: rgba(0, 243, 255, 0.1) !important;
    border: 1px solid #00f3ff !important;
    color: #00f3ff !important;
    font-size: 9px !important;
    font-weight: bold;
    text-transform: uppercase;
    cursor: pointer;
}

#inboxClaimBtn:hover:not(:disabled) { background: rgba(0, 243, 255, 0.2) !important; }
#inboxClaimBtn:disabled { opacity: 0.3; border-color: #4b6b7a; color: #4b6b7a; }

/* 4. Bot√≥n X de cerrar (Flotando afuera) */
#closeInboxBtn {
    position: absolute;
    top: 5px; right: 5px;
    width: 20px; height: 20px;
    background: transparent;
    border: 1px solid #00f3ff;
    color: #00f3ff;
    border-radius: 50%;
    font-size: 12px;
    line-height: 18px;
    text-align: center;
    z-index: 10005;
}

#closeInboxBtn:hover { background: #c0392b; border-color: #fff; color: #fff; }

/* --- CORRECCI√ìN FINAL: CUERPO DE MENSAJER√çA VERTICAL --- */

#inboxDetailContent {
    display: flex !important;
    flex-direction: column !important; /* Forza el apilamiento hacia abajo */
    height: 100% !important;
    width: 100%;
    color: #cbd5e0; /* Asegura que el texto NO sea negro */
}

#inboxDetailTitle {
    flex: 0 0 auto; /* No se estira */
    font-size: 10px;
    padding: 4px 0;
    color: #00f3ff;
    border-bottom: 1px solid rgba(0, 243, 255, 0.2);
    margin-bottom: 5px;
}

#inboxDetailHeaderImage {
    flex: 0 0 60px; /* Altura fija para la imagen */
    margin-bottom: 8px;
    background-size: cover;
    border-radius: 2px;
}

#inboxDetailBody {
    flex: 1 1 auto; /* El texto se expande para llenar el centro */
    overflow-y: auto;
    font-size: 11px;
    line-height: 1.4;
    padding: 5px 0;
}

#inboxFooter {
    flex: 0 0 auto; /* El pie se queda anclado abajo */
    padding-top: 10px;
    border-top: 1px solid rgba(255,255,255,0.05);
}

/* Soluci√≥n definitiva a la caja cian gigante */
#inboxClaimBtn {
    display: block !important;
    width: 100% !important;
    height: 30px !important; /* Limitamos la altura */
    min-height: 30px !important;
    margin: 5px 0 !important;
    background: rgba(0, 243, 255, 0.1) !important;
    border: 1px solid #00f3ff !important;
    color: #00f3ff !important;
    font-size: 9px !important;
    cursor: pointer;
    border-radius: 4px;
}

/*-------------------------------------------------*/
/* --- WIKI V2.1: AJUSTE DE CONTRASTE Y LECTURA --- */

.wiki-tab-content {
    height: calc(100% - 28px); /* Un pel√≠n m√°s para la barra superior */
    overflow-y: auto;
    padding: 10px;
    background-color: #080c10; /* Negro profundo mate */
}

/* Tipograf√≠a Legible */
.wiki-page p, 
.wiki-page li, 
.wiki-page td {
    font-size: 11.5px !important; /* M√°s grande para no forzar la vista */
    color: #cbd5e0 !important; /* Gris claro/Blanco hueso */
    line-height: 1.4;
}

/* Encabezados suaves */
.wiki-page h3, 
.wiki-page h4 {
    font-size: 13px !important;
    color: #f1c40f !important; /* Oro suave */
    border-bottom: 1px solid #1a2a33;
    margin-top: 10px;
    margin-bottom: 5px;
}

/* TABLAS NE√ìN DESCANSADAS (Arreglo del Negro/Blanco) */
.wiki-content table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 15px;
    background: rgba(0, 0, 0, 0.2);
}

.wiki-content th {
    background: #16242f !important; /* Azul gris√°ceo muy oscuro */
    color: #00f3ff !important; /* Cyan suave */
    font-size: 10px;
    padding: 6px;
    border: 1px solid #1a2a33;
    text-transform: uppercase;
}

.wiki-content td {
    padding: 6px;
    border: 1px solid #1a2a33;
    text-align: left;
}

/* Alternancia de filas sin da√±ar la vista (Sin Blancos) */
.wiki-content tr:nth-child(even) {
    background: rgba(255, 255, 255, 0.03) !important;
}

.wiki-content tr:hover {
    background: rgba(0, 243, 255, 0.05) !important;
}

/* --- BOT√ìN CERRAR (Eliminamos el rojo feo, ponemos ne√≥n) --- */
#closeWikiModalBtn {
    position: absolute;
    top: 5px;
    right: 5px;
    width: 24px;
    height: 24px;
    background: transparent;
    border: 1px solid #00f3ff;
    color: #00f3ff;
    border-radius: 50%;
    font-size: 14px;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    box-shadow: 0 0 5px rgba(0, 243, 255, 0.5);
    z-index: 10005;
}

#closeWikiModalBtn:hover {
    background: rgba(0, 243, 255, 0.2);
    box-shadow: 0 0 10px #00f3ff;
}

/* --- OPTIMIZACI√ìN DE ESPACIO VERTICAL (Eliminar h2) --- */
.wiki-content h2 {
    display: none; /* Ganamos 40px de altura ocultando "Wiki del Juego" */
}

/* --- TABLAS SIN FILAS BLANCAS --- */
.wiki-content table {
    background: rgba(255, 255, 255, 0.02) !important;
}

.wiki-content tr:nth-child(even) {
    background: rgba(255, 255, 255, 0.04) !important; /* Un gris casi imperceptible */
}

.wiki-content tr:hover {
    background: rgba(0, 243, 255, 0.08) !important;
}

.wiki-content td, .wiki-content th {
    color: #cbd5e0 !important;
    border-color: #1a2a33 !important;
    font-size: 12px !important; /* Fuente aumentada para comodidad */
}

/* Pantalla del perfil del jugador */ 
/* Cajas de estad√≠sticas estilo tarjeta de juego */
.stat-box {
    background: linear-gradient(145deg, #3e2723, #212121) !important;
    border: 2px solid #8d6e63 !important;
    box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
    transition: transform 0.2s;
}

.stat-box:hover {
    transform: scale(1.05);
    border-color: #ffd700 !important;
}

/* Efecto de barra de navegaci√≥n inferior */
.profile-nav-item {
    filter: grayscale(0.5);
    transition: 0.3s;
}

.profile-nav-item:hover {
    filter: grayscale(0);
    color: #ffd700;
}

/* Animaci√≥n de entrada para el C√≥dice */
#battleCodexList div {
    animation: slideIn 0.3s ease-out;
}

@keyframes slideIn {
    from { opacity: 0; transform: translateX(-10px); }
    to { opacity: 1; transform: translateX(0); }
}


/******************************************************************
/* 1. Bloquear recarga por deslizamiento y selecci√≥n de texto   */
/******************************************************************/
html, body {
    overscroll-behavior: none; /* BLOQUEA PULL-TO-REFRESH */
    touch-action: none;        /* BLOQUEA GESTOS NATIVOS DEL NAVEGADOR (Zoom, Pan) */
    user-select: none;         /* BLOQUEA SELECCI√ìN DE TEXTO ACCIDENTAL */
    -webkit-user-select: none;
    overflow: hidden;          /* Evita scroll de la p√°gina entera */
}

/* 2. Soluci√≥n para la barra del navegador que ocupa espacio */
body {
    margin: 0;
    width: 100vw;
    /* Usar dvh se adapta a si la barra est√° visible o no */
    height: 100dvh; 
    min-height: 100dvh;
    
    /* Imagen de fondo fija */
    background-image: url('images/IIBERION.png');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
}

/* 3. Asegurar que el contenedor del juego respete el √°rea segura (Notch/Isla din√°mica) */
#game-wrapper, .game-container {
    width: 100%;
    height: 100%;
    padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
}

/* 4. Forzar que los botones de acci√≥n siempre est√©n encima y clicables */
#tactical-ui-container {
    z-index: 9999;
    pointer-events: none; /* El contenedor es transparente a clics... */
}
#tactical-ui-container button, 
.floating-btn {
    pointer-events: auto !important; /* ...pero los botones SIEMPRE atrapan el clic */
    touch-action: manipulation;      /* Optimiza para toques */
}

/*tutorial*/
/* style.css - Asegurar que el panel se ve bien en horizontal */
@media (max-height: 400px) { 
    .tutorial-panel {
        bottom: auto !important;
        top: 10px !important; /* Mover arriba en apaisado para evitar teclados/barras */
        transform: translateX(-50%);
    }
}

#loginScreen {
    /* z-index management now handled by showScreen() function - DO NOT override here */
}
#loginScreen button {
    pointer-events: all !important; /* Forzar interactividad */
    cursor: pointer !important;
}

/*configuraci√≥n*/

/* --- ESTILO DE INTERRUPTOR (SWITCH) --- */
.switch {
  position: relative;
  display: inline-block;
  width: 50px;
  height: 24px;
}

.switch input { 
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  -webkit-transition: .4s;
  transition: .4s;
}

.slider:before {
  position: absolute;
  content: "";
  height: 16px;
  width: 16px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  -webkit-transition: .4s;
  transition: .4s;
}

input:checked + .slider {
  background-color: #2196F3;
}

input:focus + .slider {
  box-shadow: 0 0 1px #2196F3;
}

input:checked + .slider:before {
  -webkit-transform: translateX(26px);
  -ms-transform: translateX(26px);
  transform: translateX(26px);
}

/* Rounded sliders */
.slider.round {
  border-radius: 34px;
}

.slider.round:before {
  border-radius: 50%;
}

/* --- ESTILOS DE RANKING pantlla de clasificaci√≥n --- */
.ranking-tabs {
    display: flex;
    background-color: #212f3d;
    border-bottom: 1px solid #7f8c8d;
}

.ranking-tab-btn {
    flex: 1;
    padding: 10px;
    background: transparent;
    border: none;
    color: #95a5a6;
    font-weight: bold;
    cursor: pointer;
    border-bottom: 3px solid transparent;
}
.ranking-tab-btn.active {
    color: #f1c40f;
    border-bottom-color: #f1c40f;
    background-color: rgba(241, 196, 15, 0.05);
}

.ranking-header-row, .ranking-row, .ranking-footer-row {
    display: flex;
    align-items: center;
    padding: 10px;
    font-size: 0.9em;
}

.ranking-header-row {
    background-color: #2c3e50;
    border-bottom: 1px solid #7f8c8d;
    color: #f1c40f;
    font-weight: bold;
}

.ranking-row {
    border-bottom: 1px solid rgba(255,255,255,0.05);
}
.ranking-row:nth-child(odd) { background-color: rgba(255,255,255,0.02); }

/* Columnas */
.rnk-num { width: 40px; text-align: center; font-weight: bold; font-size: 1.1em; }
.rnk-name { flex-grow: 1; padding: 0 10px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.rnk-val { width: 80px; text-align: right; color: #2ecc71; font-weight: bold; }

/* Top 3 colores */
.rank-1 .rnk-num { color: #f1c40f; text-shadow: 0 0 5px gold; font-size: 1.3em; } /* Oro */
.rank-2 .rnk-num { color: #c0c0c0; text-shadow: 0 0 5px silver; font-size: 1.2em; } /* Plata */
.rank-3 .rnk-num { color: #cd7f32; text-shadow: 0 0 5px orange; font-size: 1.2em; } /* Bronce */

/* Fila de mi usuario (anclada abajo) */
.ranking-footer-row {
    background-color: #1a252f;
    border-top: 1px solid #f1c40f;
    color: #fff;
    box-shadow: 0 -2px 10px rgba(0,0,0,0.3);
}

/*---------------*/
/*PASE DE BATALLA*/
/*---------------*/

/* --- ESTILOS DEL PASE DE BATALLA (Final & Bonito) --- */

/* 1. Contenedor Principal */
.bp-main-container {
    background: radial-gradient(circle at center, #2e1a47 0%, #1a0b2e 100%);
    border: 2px solid #ffd700;
    max-width: 900px;
    height: 90vh !important;
    padding: 0 !important;
    display: flex;
    flex-direction: column;
    color: white;
    overflow: hidden;
}

/* 2. Cabecera (Compacta y Funcional) */
.bp-header-hero {
    height: 75px;
    background: rgba(0,0,0,0.6);
    border-bottom: 1px solid #5a4a75;
    display: grid;
    grid-template-columns: 140px 1fr 150px;
    align-items: center;
    padding: 0 15px;
    flex-shrink: 0;
}

.bp-header-col.info h2 {
    font-size: 11px; margin: 0; color: #e2caff; text-transform: uppercase;
}
.bp-header-col.progress {
    display: flex; flex-direction: column; align-items: center;
}
.bp-xp-track-header {
    width: 80%; height: 8px; background: #000; border: 1px solid #555;
    border-radius: 4px; overflow: hidden; margin-top: 4px;
}
#bpHeaderProgressBar {
    height: 100%; width: 0%; background: linear-gradient(90deg, #9b59b6, #e056fd);
}
.bp-header-col.actions {
    display: flex; justify-content: flex-end; gap: 10px; align-items: center;
}
.bp-gold-cta {
    background: linear-gradient(180deg, #f1c40f, #ff8c00);
    border: 1px solid white; border-radius: 6px;
    color: #3e2723; padding: 5px 10px; font-weight: bold; font-size: 10px;
    cursor: pointer;
}
.premium-active .bp-gold-cta {
    background: #2ecc71; color: white; border-color: #27ae60; cursor: default;
}
.bp-close-x {
    background: #c0392b; border: 1px solid white; color: white;
    width: 24px; height: 24px; border-radius: 50%; font-size: 16px;
    cursor: pointer;
}


/* 3. PARTE INFERIOR: DISE√ëO DE CAMINO (Restaurado) */
.bp-scroll-wrapper {
    flex-grow: 1;
    position: relative;
    overflow: hidden;
    background: #111; /* Fondo oscuro s√≥lido */
    background-image: 
        radial-gradient(white, rgba(255,255,255,.2) 2px, transparent 3px),
        radial-gradient(white, rgba(255,255,255,.15) 1px, transparent 2px),
        radial-gradient(white, rgba(255,255,255,.1) 2px, transparent 3px);
    background-size: 550px 550px, 350px 350px, 250px 250px;
    background-position: 0 0, 40px 60px, 130px 270px;
}

/* Etiquetas flotantes fijas a la izquierda */
.bp-track-labels {
    position: absolute; top: 0; left: 0; bottom: 0; width: 70px;
    z-index: 5; background: linear-gradient(90deg, rgba(0,0,0,0.8), transparent);
    pointer-events: none;
}
.label-track {
    position: absolute; left: 10px; font-size: 10px; font-weight: bold; text-transform: uppercase;
}
.label-track.gold { top: 25%; color: #ffd700; text-shadow: 0 0 5px orange; }
.label-track.free { bottom: 25%; color: #a0d3e8; text-shadow: 0 0 5px cyan; }


/* El Carril Scrollable */
.bp-items-track {
    display: flex;
    overflow-x: auto;
    overflow-y: hidden;
    height: 100%;
    padding-left: 80px; /* Espacio para etiquetas */
    padding-right: 50px;
    align-items: center;
}

/* --- ELEMENTOS DEL CARRIL (La parte que se ve√≠a mal antes) --- */

.bp-col {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    margin-right: 0px;
    position: relative;
    min-width: 90px; /* Anchura de columna */
}

/* L√≠nea conectora Horizontal */
.bp-connector {
    width: 90px; height: 4px;
    background: #444;
    position: absolute;
    top: 50%; left: 50%;
    transform: translateY(-50%);
    z-index: 1;
}
.bp-col.reached .bp-connector {
    background: #f1c40f;
    box-shadow: 0 0 8px #f1c40f;
}
.bp-col:last-child .bp-connector { display: none; }

/* Nodo Central Circular */
.bp-ball {
    width: 24px; height: 24px;
    background: #222; border: 2px solid #555; border-radius: 50%;
    color: #777; font-size: 11px; font-weight: bold;
    display: flex; align-items: center; justify-content: center;
    z-index: 2; margin: 10px 0;
}
.bp-col.reached .bp-ball {
    background: linear-gradient(180deg, #f1c40f, #e67e22);
    color: #1a0b2e; border-color: white; box-shadow: 0 0 10px gold;
}

/* CAJAS DE RECOMPENSA (Estilo "Card") */
.bp-box {
    width: 60px; height: 60px;
    background: rgba(30, 30, 40, 0.9);
    border-radius: 8px;
    position: relative;
    z-index: 2;
    display: flex; flex-direction: column; 
    align-items: center; justify-content: center;
    box-shadow: 0 4px 5px rgba(0,0,0,0.5);
    transition: transform 0.2s;
}
.bp-box:hover { transform: scale(1.05); }

/* Colores espec√≠ficos */
.bp-box.prem { border: 2px solid #5d4037; margin-bottom: 5px; } /* Premium inactivo */
.bp-box.free { border: 2px solid #3498db; margin-top: 5px; background: radial-gradient(rgba(52, 152, 219, 0.1), rgba(0,0,0,0));} 

/* Premium ACTIVO */
.premium-active .bp-box.prem {
    border-color: #ffd700;
    background: radial-gradient(rgba(255, 215, 0, 0.15), rgba(0,0,0,0.8));
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.2);
}

/* Estado: Reclamable */
.bp-claimable {
    border-color: white !important;
    cursor: pointer;
    animation: pulse-border 1.5s infinite;
}
@keyframes pulse-border { 0% { box-shadow:0 0 0 white;} 50% {box-shadow:0 0 10px white;} 100% {box-shadow:0 0 0 white;} }

/* Estado: Candado y Check */
.bp-lock {
    position: absolute; font-size: 18px; top: -5px; right: -5px;
    background: #222; border-radius: 50%; padding: 2px; border:1px solid #555;
}
/* EFECTO DE LUZ DORADA EN EL CONECTOR */
.bp-col.reached .bp-connector {
    background: linear-gradient(90deg, #f1c40f, #ffeb3b, #f1c40f);
    background-size: 200% 100%;
    box-shadow: 0 0 10px #f1c40f, 0 0 20px #b78a06;
    animation: flow-gold 2s linear infinite;
    height: 6px; /* Un poco m√°s grueso para que se vea la luz */
}

@keyframes flow-gold {
    0% { background-position: 100% 0; }
    100% { background-position: -100% 0; }
}

/* CAJA DORADA CUANDO EST√Å ACTIVA (PREMIUM) */
.premium-active .bp-box.prem {
    /* Eliminamos el borde simple y ponemos un resplandor interno */
    border: 2px solid #ffd700;
    box-shadow: inset 0 0 15px rgba(255, 215, 0, 0.2), 0 0 10px rgba(255, 215, 0, 0.4);
    transition: all 0.3s ease;
}

/* Cuando pasas el mouse por una caja dorada activa */
.premium-active .bp-box.prem:hover {
    transform: translateY(-5px) scale(1.1);
    box-shadow: 0 0 20px #ffd700;
    z-index: 10;
}

/*------------------------------*/
/* --- ALIANZAS (ESTILO DASHBOARD) --- */
/*------------------------------*/

/* Ventana Principal */
.ali-hub-window {
    width: 95vw !important; height: 90vh !important; max-width: 900px;
    background: #0f172a; border: 2px solid #3b82f6; 
    border-radius: 8px; display: flex; flex-direction: column;
    padding: 0 !important; color: #e2e8f0; overflow: hidden;
}

/* Header Rico en Datos */
.ali-hub-header {
    height: 60px; background: linear-gradient(to bottom, #1e293b, #0f172a);
    border-bottom: 1px solid #334155; display: flex; align-items: center;
    padding: 0 10px; justify-content: space-between; flex-shrink: 0;
}
.ali-identity { display: flex; align-items: center; gap: 10px; overflow: hidden; }
.ali-flag-small { font-size: 32px; background: #1e293b; border-radius: 6px; padding: 2px 6px; border: 1px solid #475569; }
.ali-titles h2 { margin: 0; font-size: 16px; color: #f1c40f; white-space: nowrap; }
.ali-meta-row { display: flex; gap: 8px; font-size: 11px; margin-top: 2px; }
.badge-lvl { color: #f1c40f; font-weight: bold; }
.badge-power { color: #e53e3e; }
.badge-members { color: #68d391; }

/* Grid del Buscador (Tarjetas) */
.ali-list-grid {
    padding: 10px; overflow-y: auto; display: grid; gap: 8px;
    /* En m√≥vil 1 columna, en escritorio 2 */
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    background: #0f172a;
}
.ali-card {
    background: #1e293b; border: 1px solid #334155; border-radius: 6px;
    padding: 10px; display: flex; align-items: center; gap: 10px;
    transition: transform 0.1s;
}
.ali-card:hover { border-color: #f1c40f; background: #2d3748; }
.ali-card-icon { font-size: 28px; width: 40px; text-align: center; }
.ali-card-info { flex-grow: 1; min-width: 0; }
.ali-card-name { font-weight: bold; color: white; display: block; font-size: 14px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.ali-card-meta { font-size: 10px; color: #94a3b8; display: flex; gap: 8px; }
.ali-card-btn {
    background: #2563eb; color: white; border: none; padding: 6px 12px;
    border-radius: 4px; font-weight: bold; font-size: 11px; cursor: pointer;
}

/* Grid del Cuartel General (HQ) */
.ali-hq-grid {
    display: flex; flex-grow: 1; overflow: hidden;
}
@media (max-width: 768px) {
    .ali-hq-grid { flex-direction: column; } /* En m√≥vil se apila */
}

/* Columna Izquierda (Operaciones) */
.hq-col-left {
    width: 35%; border-right: 1px solid #334155; display: flex; flex-direction: column;
    background: #111827; padding: 10px; gap: 10px; overflow-y: auto;
}
@media (max-width: 768px) { .hq-col-left { width: 100%; height: 50%; border-right: none; border-bottom: 1px solid #334155; } }

/* Tarjeta de Guerra */
.war-status-card {
    background: linear-gradient(135deg, #450a0a, #1a0505); border: 1px solid #ef4444;
    border-radius: 6px; padding: 10px; position: relative; overflow: hidden;
}
.war-header { color: #fecaca; font-weight: bold; font-size: 10px; letter-spacing: 1px; margin-bottom: 5px; }
.war-content { display: flex; align-items: center; gap: 10px; }
.raid-target-icon { font-size: 30px; }
.raid-info { flex-grow: 1; }
.hp-bar-container { height: 6px; background: #000; border-radius: 3px; margin: 3px 0; overflow: hidden; }
.hp-bar { height: 100%; background: #ef4444; }
.btn-attack { background: #dc2626; color: white; border: 1px solid #f87171; font-weight: bold; cursor: pointer; padding: 5px 10px; border-radius: 4px; font-size: 11px; }

/* Lista de Miembros Compacta */
.members-card { flex-grow: 1; display: flex; flex-direction: column; min-height: 0; }
.members-scroll-area { overflow-y: auto; flex-grow: 1; border: 1px solid #334155; background: #0f172a; border-radius: 4px; }
.member-item {
    display: flex; justify-content: space-between; padding: 6px 8px;
    border-bottom: 1px solid #1e293b; font-size: 11px; align-items: center;
}
.member-item:nth-child(even) { background: #162032; }
.role-badge { padding: 1px 4px; border-radius: 3px; font-size: 9px; }
.role-Leader { background: #f1c40f; color: black; }
.role-Member { background: #475569; color: white; }

/* ================================================================= */
/* === CHAT LIMPIO Y MINIMALISTA (Correcci√≥n Final) === */
/* ================================================================= */

/* 1. EL CONTENEDOR (Invisible, solo posiciona) */
.chat-widget-container {
    position: fixed;
    /* Ubicaci√≥n: Arriba Izquierda, justo debajo de los recursos */
    top: 55px !important;
    left: 5px !important;
    bottom: auto !important;
    
    z-index: 20000 !important;
    pointer-events: auto !important;
    
    /* Reseteo total de estilos heredados */
    background: none !important;
    border: none !important;
    box-shadow: none !important;
    width: auto !important;
    height: auto !important;
    padding: 0 !important;
}

/* 2. EL BOT√ìN BURBUJA (Lo √∫nico visible al inicio) */
/* Solo se muestra si el contenedor tiene la clase .minimized */
.chat-widget-container.minimized #chatBubbleIcon {
    display: flex !important;
    width: 32px !important;
    height: 32px !important;
    
    /* Estilo bot√≥n oscuro y discreto */
    background-color: rgba(20, 20, 30, 0.9) !important;
    border: 1px solid #444 !important;
    border-radius: 50% !important;
    color: #f1c40f !important; /* Icono dorado */
    
    align-items: center;
    justify-content: center;
    font-size: 16px !important;
    cursor: pointer;
    box-shadow: 0 2px 5px rgba(0,0,0,0.5) !important;
}

/* Ocultar el contenido si est√° minimizado */
.chat-widget-container.minimized #chatWindowContent {
    display: none !important;
}

/* 3. LA VENTANA ABIERTA */
/* Solo se muestra si NO tiene la clase .minimized */
.chat-widget-container:not(.minimized) #chatWindowContent {
    display: flex !important;
    flex-direction: column !important;
    
    /* Dimensiones para m√≥vil peque√±o */
    width: 200px !important;
    height: 180px !important;
    
    background-color: rgba(15, 20, 25, 0.98) !important;
    border: 1px solid #f1c40f !important; /* Borde dorado fino */
    border-radius: 6px !important;
    overflow: hidden !important;
    box-shadow: 0 5px 15px rgba(0,0,0,0.8) !important;
}

/* Ocultar el bot√≥n burbuja si la ventana est√° abierta */
.chat-widget-container:not(.minimized) #chatBubbleIcon {
    display: none !important;
}

/* 4. ELEMENTOS INTERNOS DEL CHAT */
.chat-header-mini {
    height: 25px !important;
    background: #2c2219 !important; /* Tono marr√≥n oscuro */
    border-bottom: 1px solid #444 !important;
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    padding: 0 8px !important;
}

.chat-header-mini span {
    font-size: 10px !important;
    color: #f1c40f !important;
    font-weight: bold;
    text-transform: uppercase;
}

#minimizeChatBtn {
    background: none !important;
    border: none !important;
    color: #ccc !important;
    font-size: 10px !important;
    padding: 5px !important;
    cursor: pointer;
}

#miniChatMessages {
    flex-grow: 1 !important;
    overflow-y: auto !important;
    padding: 5px !important;
    background: #111 !important;
}

/* Mensajes individuales (Limpieza de azules gigantes) */
.chat-msg {
    margin-bottom: 4px !important;
    padding: 3px 6px !important;
    font-size: 10px !important;
    line-height: 1.2 !important;
    border-radius: 3px !important;
    max-width: 90% !important;
}

.chat-msg.mine {
    background-color: #3e4a59 !important; /* Azul gris√°ceo oscuro */
    color: white !important;
    align-self: flex-end !important;
    margin-left: auto !important; /* Forza alineaci√≥n derecha */
    text-align: right !important;
    border: 1px solid #555 !important;
}

.chat-msg:not(.mine) {
    background-color: #222 !important;
    color: #ccc !important;
    align-self: flex-start !important;
    border: 1px solid #333 !important;
}

/* Input Area */
.mini-chat-input-area {
    height: 28px !important;
    display: flex !important;
    border-top: 1px solid #444 !important;
    background: #1a1a1a !important;
}

#miniChatInput {
    flex-grow: 1 !important;
    background: transparent !important;
    border: none !important;
    color: white !important;
    font-size: 10px !important;
    padding: 0 5px !important;
}

#miniChatSendBtn {
    width: 30px !important;
    background: #f1c40f !important; /* Bot√≥n dorado */
    color: #000 !important;
    border: none !important;
    font-weight: bold !important;
    cursor: pointer;
    font-size: 12px !important;
}

/* ========================================================== */
/* ==   ESTILOS DE LA LANDING PAGE (WEB DEL JUEGO)         == */
/* ========================================================== */

#landingPageModal .landing-content {
    width: 100%;
    height: 100%;
    overflow-y: auto; /* Scroll vertical */
    background: radial-gradient(circle at top, #1a253a 0%, #05080c 100%);
    color: #ecf0f1;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
    box-sizing: border-box;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

/* Bot√≥n cerrar especial */
.close-button-landing {
    position: absolute;
    top: 20px;
    right: 20px;
    font-size: 2rem;
    color: #666;
    background: none;
    border: none;
    cursor: pointer;
    display: none; /* Se activa por JS */
}
.close-button-landing:hover { color: #fff; }

/* HERO SECTION */
.landing-hero {
    text-align: center;
    margin-bottom: 40px;
    margin-top: 40px;
    animation: fadeIn 1s ease-out;
}

.landing-title {
    font-size: 4rem;
    margin: 0;
    letter-spacing: 5px;
    color: #f1c40f;
    text-shadow: 0 0 20px rgba(241, 196, 15, 0.5);
}

.landing-subtitle {
    font-size: 1.5rem;
    color: #bdc3c7;
    margin: 0;
    letter-spacing: 3px;
    text-transform: uppercase;
}

.landing-separator {
    width: 100px;
    height: 3px;
    background: #f1c40f;
    margin: 20px auto;
}

.landing-slogan {
    font-size: 1.2rem;
    font-style: italic;
    color: #aab7b8;
    margin-bottom: 30px;
}

.landing-cta-btn {
    padding: 15px 40px;
    font-size: 1.2rem;
    font-weight: bold;
    color: #05080c;
    background: linear-gradient(to bottom, #f1c40f, #d4ac0d);
    border: 2px solid #fff;
    border-radius: 5px;
    cursor: pointer;
    box-shadow: 0 0 15px rgba(241, 196, 15, 0.4);
    transition: transform 0.2s, box-shadow 0.2s;
}

.landing-cta-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 0 25px rgba(241, 196, 15, 0.6);
}

/* FEATURES GRID */
.landing-features {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    max-width: 1000px;
    width: 100%;
    margin-bottom: 40px;
}

.feature-card {
    background: rgba(255, 255, 255, 0.05);
    padding: 20px;
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    text-align: center;
    transition: transform 0.3s;
}

.feature-card:hover {
    transform: translateY(-5px);
    background: rgba(255, 255, 255, 0.08);
    border-color: #f1c40f;
}

.feat-icon {
    font-size: 3rem;
    margin-bottom: 10px;
}

.feature-card h3 {
    color: #f1c40f;
    margin: 10px 0;
}

.feature-card p {
    color: #bdc3c7;
    font-size: 0.95rem;
    line-height: 1.5;
}

@media (max-width: 680px) {
    .landing-features {
        grid-template-columns: 1fr;
        gap: 12px;
    }

    .feature-card {
        padding: 12px;
    }

    .feat-icon {
        font-size: 2.2rem;
        margin-bottom: 6px;
    }

    .feature-card h3 {
        font-size: 1rem;
    }

    .feature-card p {
        font-size: 0.85rem;
        line-height: 1.35;
    }
}

/* FOOTER */
.landing-footer {
    margin-top: auto;
    text-align: center;
    color: #555;
    font-size: 0.8rem;
    padding-bottom: 20px;
}
.social-links span {
    color: #3498db;
    cursor: pointer;
    margin: 0 5px;
}

/* ESTILOS DEL carga de partidas */
/* ESTILOS DEL carga de partidas */
/* ESTILOS DEL carga de partidas */

/* Contenedor de lista m√°s denso */
/* --- CABECERA Y PESTA√ëAS (Adelgazamiento extremo) --- */
#myGamesModal .modal-header {
    min-height: 25px !important;
    padding: 4px 10px !important;
    background: #0f151f; /* Fondo muy oscuro para contraste */
}
#myGamesModal h2 {
    font-size: 11px !important; /* T√≠tulo min√∫sculo */
    letter-spacing: 1px;
}
#myGamesModal .ranking-tabs {
    height: 25px !important;
    border-bottom: 1px solid #333;
}
#myGamesModal .ranking-tab-btn {
    padding: 2px 10px !important;
    font-size: 10px !important;
    height: 100%;
    line-height: 20px;
}

/* --- TARJETA DE PARTIDA (UNA SOLA L√çNEA) --- */
.save-slot-card {
    display: grid !important;
    /* Grid: Icono | Nombre(Flexible) | Estado | Turno | Fecha | Men√∫ */
    grid-template-columns: 20px 1fr auto auto auto 20px !important;
    align-items: center !important;
    gap: 8px !important;
    
    height: 35px !important; /* Altura fija muy baja */
    min-height: 0 !important;
    
    background: #1a252f;
    border-bottom: 1px solid #333; /* Solo l√≠nea abajo, no caja completa */
    border-radius: 0 !important; /* Rectangular para apilar mejor */
    padding: 0 5px !important;
    margin: 0 !important;
}

/* Ajustes de Texto Interno */
.save-slot-card h4 {
    font-size: 11px !important;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis; /* Cortar si es largo */
}
.save-details span { font-size: 10px !important; color: #aaa; }
.match-status { 
    font-size: 9px !important; 
    padding: 1px 4px; 
    border-radius: 2px;
}
.match-date {
    position: static !important; /* Ya no es absoluta, es parte del grid */
    font-size: 9px !important;
    color: #555;
    text-align: right;
}
.options-btn {
    font-size: 14px !important;
    padding: 0 !important;
    text-align: center;
}

/* TARJETA OPTIMIZADA (M√°s ancha, m√°s datos) */
.save-slot-card {
    display: grid !important;
    /* Icono | Nombre | Rival | Estado | Turno | Fecha | Accion (Menu o Boton) */
    grid-template-columns: 20px 1.5fr 30px auto 30px auto 40px !important;
    align-items: center !important;
    gap: 4px !important;
    padding: 0 5px !important;
    height: 40px !important;
}

/* Ajustes de texto para que quepan */
.match-vs-info {
    font-size: 10px !important;
    color: #ccc;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
/* --- ESTILOS DE LA TESORER√çA (STORE) --- */
/* --- ESTILOS DE LA TESORER√çA (STORE) --- */
/* --- ESTILOS DE LA TESORER√çA (STORE) --- */

#storeModal .modal-content {
    background: #1a1a2e; /* P√∫rpura oscuro */
    border: 2px solid #ffd700;
    width: 90vw; max-width: 800px;
    color: white;
}

.store-header {
    display: flex; justify-content: space-between; align-items: center;
    padding: 15px; background: rgba(0,0,0,0.3); border-bottom: 1px solid #ffd700;
}
.currency-display { display: flex; gap: 20px; font-size: 1.2em; font-weight: bold; }
.curr-item { display: flex; align-items: center; gap: 5px; }

#storeGrid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 15px; padding: 20px;
    overflow-y: auto; max-height: 60vh;
}

.store-card {
    background: #2e2e42; border: 1px solid #4a4a6a;
    border-radius: 8px; padding: 15px; text-align: center;
    display: flex; flex-direction: column; align-items: center;
    transition: transform 0.2s;
}
.store-card:hover { transform: translateY(-5px); border-color: #ffd700; }

/* Tarjetas Premium (Dinero Real) */
.store-card.premium {
    background: linear-gradient(135deg, #2c3e50, #000000);
    border: 1px solid #ffd700;
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.2);
}

/* Tarjeta de Anuncio */
.store-card.special {
    background: linear-gradient(135deg, #16a085, #1abc9c);
    border-color: white;
}

.card-icon { font-size: 3em; margin-bottom: 10px; }
.store-card h4 { margin: 5px 0; color: #fff; }
.store-card p { color: #aaa; margin: 0 0 10px 0; font-size: 0.9em; }

.btn-buy {
    width: 100%; padding: 8px; border: none; border-radius: 4px;
    font-weight: bold; cursor: pointer; margin-top: auto;
}
.btn-buy.real { background: #ffd700; color: #000; }
.btn-buy.gems { background: #3498db; color: white; }
.btn-buy.free { background: #e74c3c; color: white; }
.btn-buy:hover { opacity: 0.9; transform: scale(1.05); }

/* Estilo para el bot√≥n de compra con Oro */
.btn-buy.gold {
    background-color: #f1c40f; /* Dorado intenso */
    color: #3e2723; /* Texto marr√≥n oscuro para contraste */
    border: 1px solid #d4ac0d;
}
.btn-buy.gold:hover {
    background-color: #d4ac0d;
    transform: scale(1.05);
}

/* Bot√≥n peque√±o para comprar XP en el Pase */
/* Bot√≥n peque√±o para comprar XP en el Pase */
/* Bot√≥n peque√±o para comprar XP en el Pase */

.bp-buy-xp-btn {
    background-color: #2ecc71;
    color: white;
    border: 1px solid #27ae60;
    border-radius: 4px;
    width: 20px;
    height: 20px;
    font-size: 14px;
    font-weight: bold;
    cursor: pointer;
    line-height: 1;
    margin-left: 8px;
    vertical-align: middle;
    padding: 0;
    display: inline-flex;
    justify-content: center;
    align-items: center;
    box-shadow: 0 2px 4px rgba(0,0,0,0.3);
}

.bp-buy-xp-btn:hover {
    background-color: #27ae60;
    transform: scale(1.1);
}

/* Ajuste para el Modal de Alianza a pantalla completa */
/* Ajuste para el Modal de Alianza a pantalla completa */
/* Ajuste para el Modal de Alianza a pantalla completa */
.ali-hq-grid {
    display: flex; 
    flex-direction: column; 
    height: 100%; 
    overflow: hidden;
    background-color: #0f172a; /* Fondo oscuro consistente */
}

/* Ajuste de la tarjeta de guerra para que se vea bien ancha */
.war-status-card {
    background: linear-gradient(135deg, #450a0a, #1a0505); 
    border: 1px solid #ef4444;
    border-radius: 6px; 
    padding: 15px; 
    box-shadow: 0 4px 6px rgba(0,0,0,0.3);
}

/* Ajuste de la lista de miembros */
.members-scroll-area { 
    background: #1e293b; 
    border: 1px solid #334155; 
    border-radius: 4px; 
}

/* --- Estilos para los B√°rbaros (Jugador 9) --- */
/* --- Estilos para los B√°rbaros (Jugador 9) --- */
/* --- Estilos para los B√°rbaros (Jugador 9) --- */

/* Territorio: Un marr√≥n oscuro/√≥xido */
.hex.player9-owner:not(.capital-city)::before {
    content: '';
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
    z-index: -1;
    opacity: 0.4;
    background-color: #5d4037; /* Marr√≥n √≥xido */
}

/* Borde de propiedad */
.hex.player9-owner {
    box-shadow: inset 0 0 0 3px rgba(93, 64, 55, 0.8);
    --owner-color: rgba(93, 64, 55, 0.8);
}

/* Unidades B√°rbaras */
.unit.player9 {
    background-color: #8d6e63; /* Marr√≥n claro */
    border-color: #3e2723;     /* Marr√≥n muy oscuro */
}

/* --- ALERTAS VISUALES --- */
/* --- ALERTAS VISUALES --- */
/* --- ALERTAS VISUALES --- */

/* Casilla peligrosa (Sin suministro) durante el movimiento */
.hex.highlight-danger {
    background-color: rgba(255, 0, 0, 0.3) !important;
    box-shadow: inset 0 0 10px #ff0000;
    border: 1px solid red;
}

/* Iconos de estado sobre la unidad */
.unit-status-icon {
    position: absolute;
    top: -10px;
    right: -10px;
    width: 16px;
    height: 16px;
    background-color: #222;
    border-radius: 50%;
    border: 1px solid white;
    font-size: 10px;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 20;
    animation: bounce 1s infinite;
}

/* Animaci√≥n de rebote para llamar la atenci√≥n */
@keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-3px); }
}

/* Colores de estado */
.status-no-supply { background-color: #e74c3c; border-color: #c0392b; color: white; } /* Rojo */
.status-low-morale { background-color: #f1c40f; border-color: #d35400; color: black; } /* Amarillo */

/* Estado: CONDENADA (Ambos problemas) */
.status-doomed {
    background-color: #000;    /* Fondo negro luto */
    border-color: #ff0000;     /* Borde rojo sangre */
    color: #ff0000;            /* Icono rojo */
    box-shadow: 0 0 6px #ff0000; /* Resplandor rojo */
    font-size: 11px;           /* Un pel√≠n m√°s grande */
    animation: panicPulse 0.5s infinite alternate; /* Late r√°pido */
    z-index: 25;               /* Por encima de todo */
}

@keyframes panicPulse {
    from { transform: scale(1); }
    to { transform: scale(1.2); }
}

/* --- DEBUG VISUAL (BORRAR AL FINALIZAR) --- */
#org-display {
    border: 2px solid red !important; /* Borde rojo para verlo */
    min-width: 100px !important;      /* Anchura m√≠nima obligatoria */
    min-height: 20px !important;      /* Altura m√≠nima obligatoria */
    background-color: yellow !important; /* Fondo amarillo chill√≥n */
    display: flex !important;
    z-index: 9999 !important;
}

#org-name {
    color: black !important;
    font-size: 14px !important;
    display: block !important;
}


/* --- MEN√ö RADIAL T√ÅCTICO --- */
/* --- MEN√ö RADIAL T√ÅCTICO (DEFINITIVO) --- */
#radialMenuContainer {
    position: fixed; /* Fijo a la pantalla, no al mapa */
    z-index: 20000; /* Por encima de unidades (z=10) y UI est√°ndar */
    display: none;   /* Oculto por defecto, JavaScript lo mostrar√° */
    pointer-events: none; /* Bloqueado por defecto, los botones usan auto !important */
    /* NO width/height aqu√≠ - lo hacemos en JavaScript */
}

.radial-btn {
    position: absolute;
    /* width y height se aplican din√°micamente desde JS */
    border-radius: 50%;
    
    /* Dise√±o visual */
    background: #ff4444;
    border: 3px solid #ffff00;
    color: white;
    
    /* Centrado de contenido */
    display: flex; 
    justify-content: center; 
    align-items: center;
    
    cursor: pointer;
    pointer-events: auto !important; /* IMPORTANTE: Habilita clic en el bot√≥n */
    box-shadow: 0 0 15px rgba(255, 0, 0, 0.9);
    transition: all 0.2s ease;
}

.radial-btn:hover {
    background: #444;
}

.radial-btn:active {
    border-color: white;
}

@keyframes popOut {
    to { transform: translate(-50%, -50%) scale(1); }
}

/* ========================================================================== */
/* ESTILOS DEL EDITOR DE ESCENARIOS Y CAMPA√ëAS (MOBILE-FIRST)
/* ========================================================================== */

/* Contenedores principales del editor */
#scenarioEditorContainer,
#campaignEditorContainer {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    pointer-events: none;
    z-index: 10502;
}

/* Los paneles del editor s√≠ deben capturar eventos */
#scenarioEditorContainer > *,
#campaignEditorContainer > * {
    pointer-events: auto;
}

/* Asegurar que el gameBoard sea visible en el editor */
#scenarioEditorContainer .game-container,
#scenarioEditorContainer #gameBoard {
    pointer-events: auto;
    z-index: 1 !important;
}

/* === BARRA SUPERIOR M√ìVIL === */
.editor-top-bar-mobile {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    display: flex;
    align-items: center;
    gap: 5px;
    padding: 8px 10px;
    background: rgba(10, 25, 41, 0.95);
    border-bottom: 2px solid #00f3ff;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
    z-index: 10503;
    height: 44px;
    pointer-events: auto;
}

.editor-top-bar-mobile button {
    padding: 8px 12px;
    background: rgba(0, 243, 255, 0.2);
    border: 1px solid #00f3ff;
    border-radius: 5px;
    color: #00f3ff;
    cursor: pointer;
    font-size: 1.2em;
    transition: all 0.2s;
    min-width: 40px;
    pointer-events: auto;
}

.editor-top-bar-mobile button:hover,
.editor-top-bar-mobile button:active {
    background: #00f3ff;
    color: #000;
}

/* === PANEL FLOTANTE INFERIOR: HERRAMIENTAS === */
.editor-tools-panel {
    position: fixed;
    bottom: 60px; /* Por encima de la barra de configuraci√≥n */
    left: 0;
    right: 0;
    background: rgba(10, 25, 41, 0.98);
    border-top: 2px solid #00f3ff;
    box-shadow: 0 -2px 20px rgba(0, 0, 0, 0.7);
    z-index: 10503;
    padding: 15px 10px 20px 10px;
    max-height: 50vh;
    overflow-y: auto;
    transition: transform 0.3s ease-in-out;
    pointer-events: auto;
}

.editor-tools-panel.hidden {
    transform: translateY(100%);
}

/* Selector de Herramienta M√≥vil */
.tool-selector-mobile {
    display: flex;
    gap: 8px;
    margin-bottom: 15px;
    overflow-x: auto;
    padding-bottom: 5px;
}

.tool-btn-mobile {
    flex: 1;
    min-width: 65px;
    padding: 12px 8px;
    background: rgba(0, 243, 255, 0.1);
    border: 1px solid #00f3ff;
    border-radius: 8px;
    color: #00f3ff;
    cursor: pointer;
    font-size: 1.5em;
    text-align: center;
    transition: all 0.2s;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    pointer-events: auto;
}

.tool-btn-mobile span {
    font-size: 0.4em;
    margin-top: 4px;
    display: block;
}

.tool-btn-mobile:active,
.tool-btn-mobile.editor-tool-active {
    background: #00f3ff;
    color: #000;
    transform: scale(0.95);
}

/* Paneles de Configuraci√≥n M√≥vil */
.tool-panel-mobile {
    display: flex;
    flex-direction: column;
    gap: 8px;
    padding: 10px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 8px;
}

.tool-panel-mobile select {
    width: 100%;
    padding: 10px;
    background: rgba(0, 243, 255, 0.1);
    border: 1px solid #00f3ff;
    border-radius: 5px;
    color: #00f3ff;
    font-size: 1em;
    pointer-events: auto;
}

.tool-panel-mobile select option {
    background: #0a1929;
    color: #00f3ff;
}

/* === BARRA DE CONFIGURACI√ìN (Siempre visible) === */
.editor-config-bar {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    display: flex;
    gap: 8px;
    padding: 10px;
    background: rgba(10, 25, 41, 0.98);
    border-top: 2px solid #00f3ff;
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.5);
    z-index: 10502;
    pointer-events: auto;
}

.editor-config-bar button {
    flex: 1;
    padding: 12px 8px;
    background: rgba(0, 243, 255, 0.2);
    border: 1px solid #00f3ff;
    border-radius: 5px;
    color: #00f3ff;
    cursor: pointer;
    font-size: 0.85em;
    transition: all 0.2s;
    pointer-events: auto;
}

.editor-config-bar button:active {
    background: #00f3ff;
    color: #000;
    transform: scale(0.95);
}

/* Cursor personalizado para herramientas */
#scenarioEditorContainer .hex {
    cursor: crosshair;
}

/* Scrollbar personalizado para paneles del editor */
.editor-tools-panel::-webkit-scrollbar,
#campaignScenarioList::-webkit-scrollbar {
    width: 8px;
}

.editor-sidebar::-webkit-scrollbar-track,
#campaignScenarioList::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.3);
}

.editor-sidebar::-webkit-scrollbar-thumb,
#campaignScenarioList::-webkit-scrollbar-thumb {
    background: #00f3ff;
    border-radius: 4px;
}

.editor-sidebar::-webkit-scrollbar-thumb:hover,
#campaignScenarioList::-webkit-scrollbar-thumb:hover {
    background: #00bfff;
}
